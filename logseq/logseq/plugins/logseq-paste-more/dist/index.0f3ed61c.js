var e,t,n={exports:{}},r=n.exports;function o(e,t){return Array(t+1).join(e)}e=self,t=()=>(()=>{var e={227:(e,t,n)=>{var r=n(155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(447)(t);const{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},447:(e,t,n)=>{e.exports=function(e){function t(e){let n,o,i,a=null;function s(...e){if(!s.enabled)return;const r=s,o=Number(new Date),i=o-(n||o);r.diff=i,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";a++;const i=t.formatters[o];if("function"==typeof i){const t=e[a];n=i.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},856:function(e){e.exports=function(){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,n){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,n)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r(e,o,i){return(r=n()?Reflect.construct:function(e,n,r){var o=[null];o.push.apply(o,n);var i=new(Function.bind.apply(e,o));return r&&t(i,r.prototype),i}).apply(null,arguments)}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=Object.hasOwnProperty,s=Object.setPrototypeOf,l=Object.isFrozen,c=Object.getPrototypeOf,u=Object.getOwnPropertyDescriptor,f=Object.freeze,d=Object.seal,p=Object.create,h="undefined"!=typeof Reflect&&Reflect,g=h.apply,m=h.construct;g||(g=function(e,t,n){return e.apply(t,n)}),f||(f=function(e){return e}),d||(d=function(e){return e}),m||(m=function(e,t){return r(e,o(t))});var v=E(Array.prototype.forEach),y=E(Array.prototype.pop),b=E(Array.prototype.push),_=E(String.prototype.toLowerCase),w=E(String.prototype.match),C=E(String.prototype.replace),x=E(String.prototype.indexOf),A=E(String.prototype.trim),S=E(RegExp.prototype.test),k=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return m(e,n)}}(TypeError);function E(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return g(e,t,r)}}function O(e,t){s&&s(e,null);for(var n=t.length;n--;){var r=t[n];if("string"==typeof r){var o=_(r);o!==r&&(l(t)||(t[n]=o),r=o)}e[r]=!0}return e}function T(e){var t,n=p(null);for(t in e)g(a,e,[t])&&(n[t]=e[t]);return n}function N(e,t){for(;null!==e;){var n=u(e,t);if(n){if(n.get)return E(n.get);if("function"==typeof n.value)return E(n.value)}e=c(e)}return function(e){return console.warn("fallback value for",e),null}}var j=f(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),I=f(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),L=f(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),M=f(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),F=f(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),R=f(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),D=f(["#text"]),P=f(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),U=f(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),$=f(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),z=f(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),B=d(/\{\{[\w\W]*|[\w\W]*\}\}/gm),H=d(/<%[\w\W]*|[\w\W]*%>/gm),q=d(/^data-[\-\w.\u00B7-\uFFFF]/),W=d(/^aria-[\-\w]+$/),G=d(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),V=d(/^(?:\w+script|data):/i),J=d(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Y=d(/^html$/i),Z=function(){return"undefined"==typeof window?null:window},K=function(t,n){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var r=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(r=n.currentScript.getAttribute(o));var i="dompurify"+(r?"#"+r:"");try{return t.createPolicy(i,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};return function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z(),r=function(e){return t(e)};if(r.version="2.3.8",r.removed=[],!n||!n.document||9!==n.document.nodeType)return r.isSupported=!1,r;var i=n.document,a=n.document,s=n.DocumentFragment,l=n.HTMLTemplateElement,c=n.Node,u=n.Element,d=n.NodeFilter,p=n.NamedNodeMap,h=void 0===p?n.NamedNodeMap||n.MozNamedAttrMap:p,g=n.HTMLFormElement,m=n.DOMParser,E=n.trustedTypes,Q=u.prototype,X=N(Q,"cloneNode"),ee=N(Q,"nextSibling"),te=N(Q,"childNodes"),ne=N(Q,"parentNode");if("function"==typeof l){var re=a.createElement("template");re.content&&re.content.ownerDocument&&(a=re.content.ownerDocument)}var oe=K(E,i),ie=oe?oe.createHTML(""):"",ae=a,se=ae.implementation,le=ae.createNodeIterator,ce=ae.createDocumentFragment,ue=ae.getElementsByTagName,fe=i.importNode,de={};try{de=T(a).documentMode?a.documentMode:{}}catch(e){}var pe={};r.isSupported="function"==typeof ne&&se&&void 0!==se.createHTMLDocument&&9!==de;var he,ge,me=B,ve=H,ye=q,be=W,_e=V,we=J,Ce=G,xe=null,Ae=O({},[].concat(o(j),o(I),o(L),o(F),o(D))),Se=null,ke=O({},[].concat(o(P),o(U),o($),o(z))),Ee=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Oe=null,Te=null,Ne=!0,je=!0,Ie=!1,Le=!1,Me=!1,Fe=!1,Re=!1,De=!1,Pe=!1,Ue=!1,$e=!0,ze=!0,Be=!1,He={},qe=null,We=O({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ge=null,Ve=O({},["audio","video","img","source","image","track"]),Je=null,Ye=O({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ze="http://www.w3.org/1998/Math/MathML",Ke="http://www.w3.org/2000/svg",Qe="http://www.w3.org/1999/xhtml",Xe=Qe,et=!1,tt=["application/xhtml+xml","text/html"],nt="text/html",rt=null,ot=a.createElement("form"),it=function(e){return e instanceof RegExp||e instanceof Function},at=function(t){rt&&rt===t||(t&&"object"===e(t)||(t={}),t=T(t),xe="ALLOWED_TAGS"in t?O({},t.ALLOWED_TAGS):Ae,Se="ALLOWED_ATTR"in t?O({},t.ALLOWED_ATTR):ke,Je="ADD_URI_SAFE_ATTR"in t?O(T(Ye),t.ADD_URI_SAFE_ATTR):Ye,Ge="ADD_DATA_URI_TAGS"in t?O(T(Ve),t.ADD_DATA_URI_TAGS):Ve,qe="FORBID_CONTENTS"in t?O({},t.FORBID_CONTENTS):We,Oe="FORBID_TAGS"in t?O({},t.FORBID_TAGS):{},Te="FORBID_ATTR"in t?O({},t.FORBID_ATTR):{},He="USE_PROFILES"in t&&t.USE_PROFILES,Ne=!1!==t.ALLOW_ARIA_ATTR,je=!1!==t.ALLOW_DATA_ATTR,Ie=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Le=t.SAFE_FOR_TEMPLATES||!1,Me=t.WHOLE_DOCUMENT||!1,De=t.RETURN_DOM||!1,Pe=t.RETURN_DOM_FRAGMENT||!1,Ue=t.RETURN_TRUSTED_TYPE||!1,Re=t.FORCE_BODY||!1,$e=!1!==t.SANITIZE_DOM,ze=!1!==t.KEEP_CONTENT,Be=t.IN_PLACE||!1,Ce=t.ALLOWED_URI_REGEXP||Ce,Xe=t.NAMESPACE||Qe,t.CUSTOM_ELEMENT_HANDLING&&it(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ee.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&it(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ee.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ee.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),he=he=-1===tt.indexOf(t.PARSER_MEDIA_TYPE)?nt:t.PARSER_MEDIA_TYPE,ge="application/xhtml+xml"===he?function(e){return e}:_,Le&&(je=!1),Pe&&(De=!0),He&&(xe=O({},o(D)),Se=[],!0===He.html&&(O(xe,j),O(Se,P)),!0===He.svg&&(O(xe,I),O(Se,U),O(Se,z)),!0===He.svgFilters&&(O(xe,L),O(Se,U),O(Se,z)),!0===He.mathMl&&(O(xe,F),O(Se,$),O(Se,z))),t.ADD_TAGS&&(xe===Ae&&(xe=T(xe)),O(xe,t.ADD_TAGS)),t.ADD_ATTR&&(Se===ke&&(Se=T(Se)),O(Se,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&O(Je,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&(qe===We&&(qe=T(qe)),O(qe,t.FORBID_CONTENTS)),ze&&(xe["#text"]=!0),Me&&O(xe,["html","head","body"]),xe.table&&(O(xe,["tbody"]),delete Oe.tbody),f&&f(t),rt=t)},st=O({},["mi","mo","mn","ms","mtext"]),lt=O({},["foreignobject","desc","title","annotation-xml"]),ct=O({},["title","style","font","a","script"]),ut=O({},I);O(ut,L),O(ut,M);var ft=O({},F);O(ft,R);var dt=function(e){var t=ne(e);t&&t.tagName||(t={namespaceURI:Qe,tagName:"template"});var n=_(e.tagName),r=_(t.tagName);return e.namespaceURI===Ke?t.namespaceURI===Qe?"svg"===n:t.namespaceURI===Ze?"svg"===n&&("annotation-xml"===r||st[r]):Boolean(ut[n]):e.namespaceURI===Ze?t.namespaceURI===Qe?"math"===n:t.namespaceURI===Ke?"math"===n&&lt[r]:Boolean(ft[n]):e.namespaceURI===Qe&&!(t.namespaceURI===Ke&&!lt[r])&&!(t.namespaceURI===Ze&&!st[r])&&!ft[n]&&(ct[n]||!ut[n])},pt=function(e){b(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(n){try{e.outerHTML=ie}catch(n){e.remove()}}},ht=function(e,t){try{b(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){b(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Se[e])if(De||Pe)try{pt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},gt=function(e){var t,n;if(Re)e="<remove></remove>"+e;else{var r=w(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===he&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var o=oe?oe.createHTML(e):e;if(Xe===Qe)try{t=(new m).parseFromString(o,he)}catch(e){}if(!t||!t.documentElement){t=se.createDocument(Xe,"template",null);try{t.documentElement.innerHTML=et?"":o}catch(e){}}var i=t.body||t.documentElement;return e&&n&&i.insertBefore(a.createTextNode(n),i.childNodes[0]||null),Xe===Qe?ue.call(t,Me?"html":"body")[0]:Me?t.documentElement:i},mt=function(e){return le.call(e.ownerDocument||e,e,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},vt=function(e){return e instanceof g&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof h)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)},yt=function(t){return"object"===e(c)?t instanceof c:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},bt=function(e,t,n){pe[e]&&v(pe[e],(function(e){e.call(r,t,n,rt)}))},_t=function(e){var t;if(bt("beforeSanitizeElements",e,null),vt(e))return pt(e),!0;if(S(/[\u0080-\uFFFF]/,e.nodeName))return pt(e),!0;var n=ge(e.nodeName);if(bt("uponSanitizeElement",e,{tagName:n,allowedTags:xe}),e.hasChildNodes()&&!yt(e.firstElementChild)&&(!yt(e.content)||!yt(e.content.firstElementChild))&&S(/<[/\w]/g,e.innerHTML)&&S(/<[/\w]/g,e.textContent))return pt(e),!0;if("select"===n&&S(/<template/i,e.innerHTML))return pt(e),!0;if(!xe[n]||Oe[n]){if(!Oe[n]&&Ct(n)){if(Ee.tagNameCheck instanceof RegExp&&S(Ee.tagNameCheck,n))return!1;if(Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(n))return!1}if(ze&&!qe[n]){var o=ne(e)||e.parentNode,i=te(e)||e.childNodes;if(i&&o)for(var a=i.length-1;a>=0;--a)o.insertBefore(X(i[a],!0),ee(e))}return pt(e),!0}return e instanceof u&&!dt(e)?(pt(e),!0):"noscript"!==n&&"noembed"!==n||!S(/<\/no(script|embed)/i,e.innerHTML)?(Le&&3===e.nodeType&&(t=e.textContent,t=C(t,me," "),t=C(t,ve," "),e.textContent!==t&&(b(r.removed,{element:e.cloneNode()}),e.textContent=t)),bt("afterSanitizeElements",e,null),!1):(pt(e),!0)},wt=function(e,t,n){if($e&&("id"===t||"name"===t)&&(n in a||n in ot))return!1;if(je&&!Te[t]&&S(ye,t));else if(Ne&&S(be,t));else if(!Se[t]||Te[t]){if(!(Ct(e)&&(Ee.tagNameCheck instanceof RegExp&&S(Ee.tagNameCheck,e)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(e))&&(Ee.attributeNameCheck instanceof RegExp&&S(Ee.attributeNameCheck,t)||Ee.attributeNameCheck instanceof Function&&Ee.attributeNameCheck(t))||"is"===t&&Ee.allowCustomizedBuiltInElements&&(Ee.tagNameCheck instanceof RegExp&&S(Ee.tagNameCheck,n)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(n))))return!1}else if(Je[t]);else if(S(Ce,C(n,we,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==x(n,"data:")||!Ge[e])if(Ie&&!S(_e,C(n,we,"")));else if(n)return!1;return!0},Ct=function(e){return e.indexOf("-")>0},xt=function(e){var t,n,o,i;bt("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Se};for(i=a.length;i--;){var l=t=a[i],c=l.name,u=l.namespaceURI;if(n="value"===c?t.value:A(t.value),o=ge(c),s.attrName=o,s.attrValue=n,s.keepAttr=!0,s.forceKeepAttr=void 0,bt("uponSanitizeAttribute",e,s),n=s.attrValue,!s.forceKeepAttr&&(ht(c,e),s.keepAttr))if(S(/\/>/i,n))ht(c,e);else{Le&&(n=C(n,me," "),n=C(n,ve," "));var f=ge(e.nodeName);if(wt(f,o,n))try{u?e.setAttributeNS(u,c,n):e.setAttribute(c,n),y(r.removed)}catch(e){}}}bt("afterSanitizeAttributes",e,null)}},At=function e(t){var n,r=mt(t);for(bt("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)bt("uponSanitizeShadowNode",n,null),_t(n)||(n.content instanceof s&&e(n.content),xt(n));bt("afterSanitizeShadowDOM",t,null)};return r.sanitize=function(t,o){var a,l,u,f,d;if((et=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!yt(t)){if("function"!=typeof t.toString)throw k("toString is not a function");if("string"!=typeof(t=t.toString()))throw k("dirty is not a string, aborting")}if(!r.isSupported){if("object"===e(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof t)return n.toStaticHTML(t);if(yt(t))return n.toStaticHTML(t.outerHTML)}return t}if(Fe||at(o),r.removed=[],"string"==typeof t&&(Be=!1),Be){if(t.nodeName){var p=ge(t.nodeName);if(!xe[p]||Oe[p])throw k("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof c)1===(l=(a=gt("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===l.nodeName||"HTML"===l.nodeName?a=l:a.appendChild(l);else{if(!De&&!Le&&!Me&&-1===t.indexOf("<"))return oe&&Ue?oe.createHTML(t):t;if(!(a=gt(t)))return De?null:Ue?ie:""}a&&Re&&pt(a.firstChild);for(var h=mt(Be?t:a);u=h.nextNode();)3===u.nodeType&&u===f||_t(u)||(u.content instanceof s&&At(u.content),xt(u),f=u);if(f=null,Be)return t;if(De){if(Pe)for(d=ce.call(a.ownerDocument);a.firstChild;)d.appendChild(a.firstChild);else d=a;return Se.shadowroot&&(d=fe.call(i,d,!0)),d}var g=Me?a.outerHTML:a.innerHTML;return Me&&xe["!doctype"]&&a.ownerDocument&&a.ownerDocument.doctype&&a.ownerDocument.doctype.name&&S(Y,a.ownerDocument.doctype.name)&&(g="<!DOCTYPE "+a.ownerDocument.doctype.name+">\n"+g),Le&&(g=C(g,me," "),g=C(g,ve," ")),oe&&Ue?oe.createHTML(g):g},r.setConfig=function(e){at(e),Fe=!0},r.clearConfig=function(){rt=null,Fe=!1},r.isValidAttribute=function(e,t,n){rt||at({});var r=ge(e),o=ge(t);return wt(r,o,n)},r.addHook=function(e,t){"function"==typeof t&&(pe[e]=pe[e]||[],b(pe[e],t))},r.removeHook=function(e){if(pe[e])return y(pe[e])},r.removeHooks=function(e){pe[e]&&(pe[e]=[])},r.removeAllHooks=function(){pe={}},r}()}()},729:e=>{var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new o(r,i||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,a=new Array(i);o<i;o++)a[o]=r[o].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,o,i,a){var s=n?n+e:e;if(!this._events[s])return!1;var l,c,u=this._events[s],f=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),f){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,o),!0;case 5:return u.fn.call(u.context,t,r,o,i),!0;case 6:return u.fn.call(u.context,t,r,o,i,a),!0}for(c=1,l=new Array(f-1);c<f;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var d,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),f){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,r);break;case 4:u[c].fn.call(u[c].context,t,r,o);break;default:if(!l)for(d=1,l=new Array(f-1);d<f;d++)l[d-1]=arguments[d];u[c].fn.apply(u[c].context,l)}}return!0},s.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return a(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||o&&!s.once||r&&s.context!==r||a(this,i);else{for(var l=0,c=[],u=s.length;l<u;l++)(s[l].fn!==t||o&&!s[l].once||r&&s[l].context!==r)&&c.push(s[l]);c.length?this._events[i]=1===c.length?c[0]:c:a(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},717:e=>{"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},824:e=>{var t=1e3,n=60*t,r=60*n,o=24*r;function i(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,a){a=a||{};var s=typeof e;if("string"===s&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(i){var a=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return 6048e5*a;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===s&&isFinite(e))return a.long?function(e){var a=Math.abs(e);return a>=o?i(e,a,o,"day"):a>=r?i(e,a,r,"hour"):a>=n?i(e,a,n,"minute"):a>=t?i(e,a,t,"second"):e+" ms"}(e):function(e){var i=Math.abs(e);return i>=o?Math.round(e/o)+"d":i>=r?Math.round(e/r)+"h":i>=n?Math.round(e/n)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},520:(e,t,n)=>{var r=n(155),o="win32"===r.platform,i=n(539);function a(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];o&&"."!==o&&(".."===o?n.length&&".."!==n[n.length-1]?n.pop():t&&n.push(".."):n.push(o))}return n}function s(e){for(var t=e.length-1,n=0;n<=t&&!e[n];n++);for(var r=t;r>=0&&!e[r];r--);return 0===n&&r===t?e:n>r?[]:e.slice(n,r+1)}var l=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,c=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,u={};function f(e){var t=l.exec(e),n=(t[1]||"")+(t[2]||""),r=t[3]||"",o=c.exec(r);return[n,o[1],o[2],o[3]]}function d(e){var t=l.exec(e),n=t[1]||"",r=!!n&&":"!==n[1];return{device:n,isUnc:r,isAbsolute:r||!!t[2],tail:t[3]}}function p(e){return"\\\\"+e.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}u.resolve=function(){for(var e="",t="",n=!1,o=arguments.length-1;o>=-1;o--){var s;if(o>=0?s=arguments[o]:e?(s=r.env["="+e])&&s.substr(0,3).toLowerCase()===e.toLowerCase()+"\\"||(s=e+"\\"):s=r.cwd(),!i.isString(s))throw new TypeError("Arguments to path.resolve must be strings");if(s){var l=d(s),c=l.device,u=l.isUnc,f=l.isAbsolute,h=l.tail;if((!c||!e||c.toLowerCase()===e.toLowerCase())&&(e||(e=c),n||(t=h+"\\"+t,n=f),e&&n))break}}return u&&(e=p(e)),e+(n?"\\":"")+(t=a(t.split(/[\\\/]+/),!n).join("\\"))||"."},u.normalize=function(e){var t=d(e),n=t.device,r=t.isUnc,o=t.isAbsolute,i=t.tail,s=/[\\\/]$/.test(i);return(i=a(i.split(/[\\\/]+/),!o).join("\\"))||o||(i="."),i&&s&&(i+="\\"),r&&(n=p(n)),n+(o?"\\":"")+i},u.isAbsolute=function(e){return d(e).isAbsolute},u.join=function(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(!i.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&e.push(n)}var r=e.join("\\");return/^[\\\/]{2}[^\\\/]/.test(e[0])||(r=r.replace(/^[\\\/]{2,}/,"\\")),u.normalize(r)},u.relative=function(e,t){e=u.resolve(e),t=u.resolve(t);for(var n=e.toLowerCase(),r=t.toLowerCase(),o=s(t.split("\\")),i=s(n.split("\\")),a=s(r.split("\\")),l=Math.min(i.length,a.length),c=l,f=0;f<l;f++)if(i[f]!==a[f]){c=f;break}if(0==c)return t;var d=[];for(f=c;f<i.length;f++)d.push("..");return(d=d.concat(o.slice(c))).join("\\")},u._makeLong=function(e){if(!i.isString(e))return e;if(!e)return"";var t=u.resolve(e);return/^[a-zA-Z]\:\\/.test(t)?"\\\\?\\"+t:/^\\\\[^?.]/.test(t)?"\\\\?\\UNC\\"+t.substring(2):e},u.dirname=function(e){var t=f(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},u.basename=function(e,t){var n=f(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},u.extname=function(e){return f(e)[3]},u.format=function(e){if(!i.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!i.isString(t))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);var n=e.dir,r=e.base||"";return n?n[n.length-1]===u.sep?n+r:n+u.sep+r:r},u.parse=function(e){if(!i.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=f(e);if(!t||4!==t.length)throw new TypeError("Invalid path '"+e+"'");return{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},u.sep="\\",u.delimiter=";";var h=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,g={};function m(e){return h.exec(e).slice(1)}g.resolve=function(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var o=n>=0?arguments[n]:r.cwd();if(!i.isString(o))throw new TypeError("Arguments to path.resolve must be strings");o&&(e=o+"/"+e,t="/"===o[0])}return(t?"/":"")+(e=a(e.split("/"),!t).join("/"))||"."},g.normalize=function(e){var t=g.isAbsolute(e),n=e&&"/"===e[e.length-1];return(e=a(e.split("/"),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},g.isAbsolute=function(e){return"/"===e.charAt(0)},g.join=function(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];if(!i.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&(e+=e?"/"+n:n)}return g.normalize(e)},g.relative=function(e,t){e=g.resolve(e).substr(1),t=g.resolve(t).substr(1);for(var n=s(e.split("/")),r=s(t.split("/")),o=Math.min(n.length,r.length),i=o,a=0;a<o;a++)if(n[a]!==r[a]){i=a;break}var l=[];for(a=i;a<n.length;a++)l.push("..");return(l=l.concat(r.slice(i))).join("/")},g._makeLong=function(e){return e},g.dirname=function(e){var t=m(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},g.basename=function(e,t){var n=m(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},g.extname=function(e){return m(e)[3]},g.format=function(e){if(!i.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!i.isString(t))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);return(e.dir?e.dir+g.sep:"")+(e.base||"")},g.parse=function(e){if(!i.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=m(e);if(!t||4!==t.length)throw new TypeError("Invalid path '"+e+"'");return t[1]=t[1]||"",t[2]=t[2]||"",t[3]=t[3]||"",{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},g.sep="/",g.delimiter=":",e.exports=o?u:g,e.exports.posix=g,e.exports.win32=u},155:e=>{var t,n,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var s,l=[],c=!1,u=-1;function f(){c&&s&&(c=!1,s.length?l=s.concat(l):u=-1,l.length&&d())}function d(){if(!c){var e=a(f);c=!0;for(var t=l.length;t;){for(s=l,l=[];++u<t;)s&&s[u].run();u=-1,t=l.length}s=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=h,r.addListener=h,r.once=h,r.off=h,r.removeListener=h,r.removeAllListeners=h,r.emit=h,r.prependListener=h,r.prependOnceListener=h,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},539:(e,t,n)=>{var r=n(155),o=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,a=String(e).replace(o,(function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),l=r[n];n<i;l=r[++n])g(l)||!_(l)?a+=" "+l:a+=" "+s(l);return a},t.deprecate=function(e,o){if(y(n.g.process))return function(){return t.deprecate(e,o).apply(this,arguments)};if(!0===r.noDeprecation)return e;var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),i=!0}return e.apply(this,arguments)}};var i,a={};function s(e,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),h(n)?r.showHidden=n:n&&t._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=l),u(r,e,r.depth)}function l(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function c(e,t){return e}function u(e,n,r){if(e.customInspect&&n&&x(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return v(o)||(o=u(e,o,r)),o}var i=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(v(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return m(t)?e.stylize(""+t,"number"):h(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}(e,n);if(i)return i;var a=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),C(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(n);if(0===a.length){if(x(n)){var l=n.name?": "+n.name:"";return e.stylize("[Function"+l+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return e.stylize(Date.prototype.toString.call(n),"date");if(C(n))return f(n)}var c,_="",A=!1,S=["{","}"];return p(n)&&(A=!0,S=["[","]"]),x(n)&&(_=" [Function"+(n.name?": "+n.name:"")+"]"),b(n)&&(_=" "+RegExp.prototype.toString.call(n)),w(n)&&(_=" "+Date.prototype.toUTCString.call(n)),C(n)&&(_=" "+f(n)),0!==a.length||A&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=A?function(e,t,n,r,o){for(var i=[],a=0,s=t.length;a<s;++a)O(t,String(a))?i.push(d(e,t,n,r,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(d(e,t,n,r,o,!0))})),i}(e,n,r,s,a):a.map((function(t){return d(e,n,r,s,t,A)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(c,_,S)):S[0]+_+S[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,o,i){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),O(r,o)||(a="["+o+"]"),s||(e.seen.indexOf(l.value)<0?(s=g(n)?u(e,l.value,null):u(e,l.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),y(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function p(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function g(e){return null===e}function m(e){return"number"==typeof e}function v(e){return"string"==typeof e}function y(e){return void 0===e}function b(e){return _(e)&&"[object RegExp]"===A(e)}function _(e){return"object"==typeof e&&null!==e}function w(e){return _(e)&&"[object Date]"===A(e)}function C(e){return _(e)&&("[object Error]"===A(e)||e instanceof Error)}function x(e){return"function"==typeof e}function A(e){return Object.prototype.toString.call(e)}function S(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(y(i)&&(i=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(i)){var n=r.pid;a[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else a[e]=function(){};return a[e]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=h,t.isNull=g,t.isNullOrUndefined=function(e){return null==e},t.isNumber=m,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=b,t.isObject=_,t.isDate=w,t.isError=C,t.isFunction=x,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(384);var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(){var e=new Date,t=[S(e.getHours()),S(e.getMinutes()),S(e.getSeconds())].join(":");return[e.getDate(),k[e.getMonth()],t].join(" ")}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",E(),t.format.apply(t,arguments))},t.inherits=n(717),t._extend=function(e,t){if(!t||!_(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{o.r(i),o.d(i,{LSPluginUser:()=>br,setupPluginUserInstance:()=>_r});var e=o(520);o(856);const t=function(e,t){return e===t||e!=e&&t!=t},a=function(e,n){for(var r=e.length;r--;)if(t(e[r][0],n))return r;return-1};var s=Array.prototype.splice;function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=function(){this.__data__=[],this.size=0},l.prototype.delete=function(e){var t=this.__data__,n=a(t,e);return!(n<0||(n==t.length-1?t.pop():s.call(t,n,1),--this.size,0))},l.prototype.get=function(e){var t=this.__data__,n=a(t,e);return n<0?void 0:t[n][1]},l.prototype.has=function(e){return a(this.__data__,e)>-1},l.prototype.set=function(e,t){var n=this.__data__,r=a(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};const c=l,u="object"==typeof global&&global&&global.Object===Object&&global;var f="object"==typeof self&&self&&self.Object===Object&&self;const d=u||f||Function("return this")(),p=d.Symbol;var h=Object.prototype,g=h.hasOwnProperty,m=h.toString,v=p?p.toStringTag:void 0,y=Object.prototype.toString,b=p?p.toStringTag:void 0;const _=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":b&&b in Object(e)?function(e){var t=g.call(e,v),n=e[v];try{e[v]=void 0;var r=!0}catch(e){}var o=m.call(e);return r&&(t?e[v]=n:delete e[v]),o}(e):function(e){return y.call(e)}(e)},w=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},C=function(e){if(!w(e))return!1;var t=_(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},x=d["__core-js_shared__"];var A,S=(A=/[^.]+$/.exec(x&&x.keys&&x.keys.IE_PROTO||""))?"Symbol(src)_1."+A:"",k=Function.prototype.toString;const E=function(e){if(null!=e){try{return k.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var O=/^\[object .+?Constructor\]$/,T=Function.prototype,N=Object.prototype,j=T.toString,I=N.hasOwnProperty,L=RegExp("^"+j.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const M=function(e){return!(!w(e)||function(e){return!!S&&S in e}(e))&&(C(e)?L:O).test(E(e))},F=function(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return M(n)?n:void 0},R=F(d,"Map"),D=F(Object,"create");var P=Object.prototype.hasOwnProperty,U=Object.prototype.hasOwnProperty;function $(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}$.prototype.clear=function(){this.__data__=D?D(null):{},this.size=0},$.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},$.prototype.get=function(e){var t=this.__data__;if(D){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return P.call(t,e)?t[e]:void 0},$.prototype.has=function(e){var t=this.__data__;return D?void 0!==t[e]:U.call(t,e)},$.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=D&&void 0===t?"__lodash_hash_undefined__":t,this};const z=$,B=function(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map};function H(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}H.prototype.clear=function(){this.size=0,this.__data__={hash:new z,map:new(R||c),string:new z}},H.prototype.delete=function(e){var t=B(this,e).delete(e);return this.size-=t?1:0,t},H.prototype.get=function(e){return B(this,e).get(e)},H.prototype.has=function(e){return B(this,e).has(e)},H.prototype.set=function(e,t){var n=B(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};const q=H;function W(e){var t=this.__data__=new c(e);this.size=t.size}W.prototype.clear=function(){this.__data__=new c,this.size=0},W.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},W.prototype.get=function(e){return this.__data__.get(e)},W.prototype.has=function(e){return this.__data__.has(e)},W.prototype.set=function(e,t){var n=this.__data__;if(n instanceof c){var r=n.__data__;if(!R||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new q(r)}return n.set(e,t),this.size=n.size,this};const G=W,V=function(){try{var e=F(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),J=function(e,t,n){"__proto__"==t&&V?V(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Y=function(e,n,r){(void 0!==r&&!t(e[n],r)||void 0===r&&!(n in e))&&J(e,n,r)},Z=function(e,t,n){for(var r=-1,o=Object(e),i=n(e),a=i.length;a--;){var s=i[++r];if(!1===t(o[s],s,o))break}return e};var K="object"==typeof r&&r&&!r.nodeType&&r,Q=K&&"object"==typeof n&&n&&!n.nodeType&&n,X=Q&&Q.exports===K?d.Buffer:void 0,ee=X?X.allocUnsafe:void 0;const te=d.Uint8Array,ne=function(e,t){var n=t?function(e){var t=new e.constructor(e.byteLength);return new te(t).set(new te(e)),t}(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var re=Object.create;const oe=function(){function e(){}return function(t){if(!w(t))return{};if(re)return re(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),ie=function(e,t){return function(n){return e(t(n))}},ae=ie(Object.getPrototypeOf,Object);var se=Object.prototype;const le=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||se)},ce=function(e){return null!=e&&"object"==typeof e},ue=function(e){return ce(e)&&"[object Arguments]"==_(e)};var fe=Object.prototype,de=fe.hasOwnProperty,pe=fe.propertyIsEnumerable;const he=ue(function(){return arguments}())?ue:function(e){return ce(e)&&de.call(e,"callee")&&!pe.call(e,"callee")},ge=Array.isArray,me=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},ve=function(e){return null!=e&&me(e.length)&&!C(e)};var ye="object"==typeof r&&r&&!r.nodeType&&r,be=ye&&"object"==typeof n&&n&&!n.nodeType&&n,_e=be&&be.exports===ye?d.Buffer:void 0;const we=(_e?_e.isBuffer:void 0)||function(){return!1};var Ce=Function.prototype,xe=Object.prototype,Ae=Ce.toString,Se=xe.hasOwnProperty,ke=Ae.call(Object),Ee={};Ee["[object Float32Array]"]=Ee["[object Float64Array]"]=Ee["[object Int8Array]"]=Ee["[object Int16Array]"]=Ee["[object Int32Array]"]=Ee["[object Uint8Array]"]=Ee["[object Uint8ClampedArray]"]=Ee["[object Uint16Array]"]=Ee["[object Uint32Array]"]=!0,Ee["[object Arguments]"]=Ee["[object Array]"]=Ee["[object ArrayBuffer]"]=Ee["[object Boolean]"]=Ee["[object DataView]"]=Ee["[object Date]"]=Ee["[object Error]"]=Ee["[object Function]"]=Ee["[object Map]"]=Ee["[object Number]"]=Ee["[object Object]"]=Ee["[object RegExp]"]=Ee["[object Set]"]=Ee["[object String]"]=Ee["[object WeakMap]"]=!1;var Oe="object"==typeof r&&r&&!r.nodeType&&r,Te=Oe&&"object"==typeof n&&n&&!n.nodeType&&n,Ne=Te&&Te.exports===Oe&&u.process,je=function(){try{return Te&&Te.require&&Te.require("util").types||Ne&&Ne.binding&&Ne.binding("util")}catch(e){}}(),Ie=je&&je.isTypedArray;const Le=Ie?function(e){return function(t){return e(t)}}(Ie):function(e){return ce(e)&&me(e.length)&&!!Ee[_(e)]},Me=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]};var Fe=Object.prototype.hasOwnProperty;const Re=function(e,n,r){var o=e[n];Fe.call(e,n)&&t(o,r)&&(void 0!==r||n in e)||J(e,n,r)};var De=/^(?:0|[1-9]\d*)$/;const Pe=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&De.test(e))&&e>-1&&e%1==0&&e<t};var Ue=Object.prototype.hasOwnProperty;const $e=function(e,t){var n=ge(e),r=!n&&he(e),o=!n&&!r&&we(e),i=!n&&!r&&!o&&Le(e),a=n||r||o||i,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=s.length;for(var c in e)!t&&!Ue.call(e,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Pe(c,l))||s.push(c);return s};var ze=Object.prototype.hasOwnProperty;const Be=function(e){if(!w(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=le(e),n=[];for(var r in e)("constructor"!=r||!t&&ze.call(e,r))&&n.push(r);return n},He=function(e){return ve(e)?$e(e,!0):Be(e)},qe=function(e){return function(e,t,n,r){var o=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var s=t[i],l=r?r(n[s],e[s],s,n,e):void 0;void 0===l&&(l=e[s]),o?J(n,s,l):Re(n,s,l)}return n}(e,He(e))},We=function(e,t,n,r,o,i,a){var s=Me(e,n),l=Me(t,n),c=a.get(l);if(c)Y(e,n,c);else{var u=i?i(s,l,n+"",e,t,a):void 0,f=void 0===u;if(f){var d=ge(l),p=!d&&we(l),h=!d&&!p&&Le(l);u=l,d||p||h?ge(s)?u=s:function(e){return ce(e)&&ve(e)}(s)?u=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}(s):p?(f=!1,u=function(e,t){if(t)return e.slice();var n=e.length,r=ee?ee(n):new e.constructor(n);return e.copy(r),r}(l,!0)):h?(f=!1,u=ne(l,!0)):u=[]:function(e){if(!ce(e)||"[object Object]"!=_(e))return!1;var t=ae(e);if(null===t)return!0;var n=Se.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ae.call(n)==ke}(l)||he(l)?(u=s,he(s)?u=qe(s):w(s)&&!C(s)||(u=function(e){return"function"!=typeof e.constructor||le(e)?{}:oe(ae(e))}(l))):f=!1}f&&(a.set(l,u),o(u,l,r,i,a),a.delete(l)),Y(e,n,u)}},Ge=function e(t,n,r,o,i){t!==n&&Z(n,(function(a,s){if(i||(i=new G),w(a))We(t,n,s,r,e,o,i);else{var l=o?o(Me(t,s),a,s+"",t,n,i):void 0;void 0===l&&(l=a),Y(t,s,l)}}),He)},Ve=function(e){return e},Je=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)};var Ye=Math.max;const Ze=function(e){return function(){return e}},Ke=V?function(e,t){return V(e,"toString",{configurable:!0,enumerable:!1,value:Ze(t),writable:!0})}:Ve;var Qe=Date.now;const Xe=function(e){var t=0,n=0;return function(){var r=Qe(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Ke),et=function(e,t){return Xe(function(e,t,n){return t=Ye(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=Ye(r.length-t,0),a=Array(i);++o<i;)a[o]=r[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=r[o];return s[t]=n(a),Je(e,this,s)}}(e,t,Ve),e+"")},tt=function(e,n,r){if(!w(r))return!1;var o=typeof n;return!!("number"==o?ve(r)&&Pe(n,r.length):"string"==o&&n in r)&&t(r[n],e)},nt=function(e){return et((function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&tt(n[0],n[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++r<o;){var s=n[r];s&&e(t,s,r)}return t}))}((function(e,t,n){Ge(e,t,n)}));var rt=function(){return(rt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function ot(e){return e.toLowerCase()}var it=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],at=/[^A-Z0-9]+/gi;function st(e,t,n){return t instanceof RegExp?e.replace(t,n):t.reduce((function(e,t){return e.replace(t,n)}),e)}var lt=o(729),ct=o.n(lt);function ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ft="win32"===navigator.platform.toLowerCase()?e.win32:e.posix,dt=function(e,t){return void 0===t&&(t={}),function(e,t){return void 0===t&&(t={}),function(e,t){void 0===t&&(t={});for(var n=t.splitRegexp,r=void 0===n?it:n,o=t.stripRegexp,i=void 0===o?at:o,a=t.transform,s=void 0===a?ot:a,l=t.delimiter,c=void 0===l?" ":l,u=st(st(e,r,"$1\0$2"),i,"\0"),f=0,d=u.length;"\0"===u.charAt(f);)f++;for(;"\0"===u.charAt(d-1);)d--;return u.slice(f,d).split("\0").map(s).join(c)}(e,rt({delimiter:"."},t))}(e,rt({delimiter:"_"},t))},pt=nt;class ht extends(ct()){constructor(e,t){super(),ut(this,"_tag",void 0),ut(this,"_opts",void 0),ut(this,"_logs",[]),this._tag=e,this._opts=t}write(e,t,n){var r;null!=t&&t.length&&!0===t[t.length-1]&&(n=!0,t.pop());const o=t.reduce(((e,t)=>(t&&t instanceof Error?e+=`${t.message} ${t.stack}`:e+=t.toString(),e)),`[${this._tag}][${(new Date).toLocaleTimeString()}] `);var i;this._logs.push([e,o]),(n||null!==(r=this._opts)&&void 0!==r&&r.console)&&(null===(i=console)||void 0===i||i["ERROR"===e?"error":"debug"](`${e}: ${o}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...e){this.write("INFO",e)}error(...e){this.write("ERROR",e)}warn(...e){this.write("WARN",e)}setTag(e){this._tag=e}toJSON(){return this._logs}}function gt(e,t){let n,r,o=!1;const i=t=>n=>{e&&clearTimeout(e),t(n),o=!0},a=new Promise(((o,a)=>{n=i(o),r=i(a),e&&(e=setTimeout((()=>r(new Error(`[deferred timeout] ${t}`))),e))}));return{created:Date.now(),setTag:e=>t=e,resolve:n,reject:r,promise:a,get settled(){return o}}}const mt=new Map;window.__injectedUIEffects=mt;var vt=o(227),yt=o.n(vt);function bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const _t="application/x-postmate-v1+json";let wt=0;const Ct={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},xt=(e,t)=>!("string"==typeof t&&e.origin!==t||!e.data||"object"==typeof e.data&&!("postmate"in e.data)||e.data.type!==_t||!Ct[e.data.postmate]);class At{constructor(e){bt(this,"parent",void 0),bt(this,"frame",void 0),bt(this,"child",void 0),bt(this,"events",{}),bt(this,"childOrigin",void 0),bt(this,"listener",void 0),this.parent=e.parent,this.frame=e.frame,this.child=e.child,this.childOrigin=e.childOrigin,this.listener=e=>{if(!xt(e,this.childOrigin))return!1;const{data:t,name:n}=((e||{}).data||{}).value||{};"emit"===e.data.postmate&&n in this.events&&this.events[n].forEach((e=>{e.call(this,t)}))},this.parent.addEventListener("message",this.listener,!1)}get(e,...t){return new Promise((n=>{const r=++wt,o=e=>{e.data.uid===r&&"reply"===e.data.postmate&&(this.parent.removeEventListener("message",o,!1),n(e.data.value))};this.parent.addEventListener("message",o,!1),this.child.postMessage({postmate:"request",type:_t,property:e,args:t,uid:r},this.childOrigin)}))}call(e,t){this.child.postMessage({postmate:"call",type:_t,property:e,data:t},this.childOrigin)}on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class St{constructor(e){bt(this,"model",void 0),bt(this,"parent",void 0),bt(this,"parentOrigin",void 0),bt(this,"child",void 0),this.model=e.model,this.parent=e.parent,this.parentOrigin=e.parentOrigin,this.child=e.child,this.child.addEventListener("message",(e=>{if(!xt(e,this.parentOrigin))return;const{property:t,uid:n,data:r,args:o}=e.data;"call"!==e.data.postmate?((e,t,n)=>{const r="function"==typeof e[t]?e[t].apply(null,n):e[t];return Promise.resolve(r)})(this.model,t,o).then((r=>{e.source.postMessage({property:t,postmate:"reply",type:_t,uid:n,value:r},e.origin)})):t in this.model&&"function"==typeof this.model[t]&&this.model[t](r)}))}emit(e,t){this.parent.postMessage({postmate:"emit",type:_t,value:{name:e,data:t}},this.parentOrigin)}}class kt{constructor(e){bt(this,"container",void 0),bt(this,"parent",void 0),bt(this,"frame",void 0),bt(this,"child",void 0),bt(this,"childOrigin",void 0),bt(this,"url",void 0),bt(this,"model",void 0),this.container=e.container,this.url=e.url,this.parent=window,this.frame=document.createElement("iframe"),e.id&&(this.frame.id=e.id),e.name&&(this.frame.name=e.name),this.frame.classList.add.apply(this.frame.classList,e.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=e.model||{}}sendHandshake(e){const t=(e=>{const t=document.createElement("a");t.href=e;const n=t.protocol.length>4?t.protocol:window.location.protocol,r=t.host.length?"80"===t.port||"443"===t.port?t.hostname:t.host:window.location.host;return t.origin||`${n}//${r}`})(e=e||this.url);let n,r=0;return new Promise(((o,i)=>{const a=e=>!!xt(e,t)&&("handshake-reply"===e.data.postmate?(clearInterval(n),this.parent.removeEventListener("message",a,!1),this.childOrigin=e.origin,o(new At(this))):i("Failed handshake"));this.parent.addEventListener("message",a,!1);const s=()=>{r++,this.child.postMessage({postmate:"handshake",type:_t,model:this.model},t),5===r&&clearInterval(n)};this.frame.addEventListener("load",(()=>{s(),n=setInterval(s,500)})),this.frame.src=e}))}destroy(){this.frame.parentNode.removeChild(this.frame)}}bt(kt,"debug",!1),bt(kt,"Model",void 0);class Et{constructor(e){bt(this,"child",void 0),bt(this,"model",void 0),bt(this,"parent",void 0),bt(this,"parentOrigin",void 0),this.child=window,this.model=e,this.parent=this.child.parent}sendHandshakeReply(){return new Promise(((e,t)=>{const n=r=>{if(r.data.postmate){if("handshake"===r.data.postmate){this.child.removeEventListener("message",n,!1),r.source.postMessage({postmate:"handshake-reply",type:_t},r.origin),this.parentOrigin=r.origin;const t=r.data.model;return t&&Object.keys(t).forEach((e=>{this.model[e]=t[e]})),e(new St(this))}return t("Handshake Reply Failed")}};this.child.addEventListener("message",n,!1)}))}}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const{importHTML:Tt,createSandboxContainer:Nt}=window.QSandbox||{};function jt(e,t){return e.startsWith("http")?fetch(e,t):(e=e.replace("file://",""),new Promise((async(t,n)=>{try{const n=await window.apis.doAction(["readFile",e]);t({text:()=>n})}catch(e){console.error(e),n(e)}})))}class It extends(ct()){constructor(e){super(),Ot(this,"_pluginLocal",void 0),Ot(this,"_frame",void 0),Ot(this,"_root",void 0),Ot(this,"_loaded",!1),Ot(this,"_unmountFns",[]),this._pluginLocal=e,e._dispose((()=>{this._unmount()}))}async load(){const{name:e,entry:t}=this._pluginLocal.options;if(this.loaded||!t)return;const{template:n,execScripts:r}=await Tt(t,{fetch:jt});this._mount(n,document.body);const o=Nt(e,{elementGetter:()=>{var e;return null===(e=this._root)||void 0===e?void 0:e.firstChild}}).instance.proxy;o.__shadow_mode__=!0,o.LSPluginLocal=this._pluginLocal,o.LSPluginShadow=this,o.LSPluginUser=o.logseq=new br(this._pluginLocal.toJSON(),this._pluginLocal.caller);const i=await r(o,!0);this._unmountFns.push(i.unmount),this._loaded=!0}_mount(e,t){const n=this._frame=document.createElement("div");n.classList.add("lsp-shadow-sandbox"),n.id=this._pluginLocal.id,this._root=n.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${e}</div>`,t.appendChild(n),this.emit("mounted")}_unmount(){for(const e of this._unmountFns)e&&e.call(null)}destroy(){var e,t;null===(e=this.frame)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var e;return null===(e=this._root)||void 0===e?void 0:e.firstChild}get frame(){return this._frame}}function Lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Mt=yt()("LSPlugin:caller"),Ft="#await#response#",Rt="#lspmsg#error#",Dt=e=>`#lspmsg#${e}`;class Pt extends(ct()){constructor(e){super(),Lt(this,"_pluginLocal",void 0),Lt(this,"_connected",!1),Lt(this,"_parent",void 0),Lt(this,"_child",void 0),Lt(this,"_shadow",void 0),Lt(this,"_status",void 0),Lt(this,"_userModel",{}),Lt(this,"_call",void 0),Lt(this,"_callUserModel",void 0),Lt(this,"_debugTag",""),this._pluginLocal=e,e&&(this._debugTag=e.debugTag)}async connectToChild(){if(this._connected)return;const{shadow:e}=this._pluginLocal;e?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(e={}){if(this._connected)return;const t=this,n=null!=this._pluginLocal;let r=0;const o=new Map,i=gt(6e4),a=this._extendUserModel({"#lspmsg#ready#":async e=>{a[Dt(null==e?void 0:e.pid)]=({type:e,payload:n})=>{Mt(`[host (_call) -> *user] ${this._debugTag}`,e,n),t.emit(e,n)},await i.resolve()},"#lspmsg#beforeunload#":async e=>{const n=gt(1e4);t.emit("beforeunload",Object.assign({actor:n},e)),await n.promise},"#lspmsg#settings#":async({type:e,payload:n})=>{t.emit("settings:changed",n)},"#lspmsg#":async({ns:e,type:n,payload:r})=>{Mt(`[host (async) -> *user] ${this._debugTag} ns=${e} type=${n}`,r),e&&e.startsWith("hook")?t.emit(`${e}:${n}`,r):t.emit(n,r)},"#lspmsg#reply#":({_sync:e,result:t})=>{if(Mt(`[sync host -> *user] #${e}`,t),o.has(e)){const n=o.get(e);n&&(null!=t&&t.hasOwnProperty(Rt)?n.reject(t[Rt]):n.resolve(t),o.delete(e))}},...e});var s;if(n)return await i.promise,JSON.parse(JSON.stringify(null===(s=this._pluginLocal)||void 0===s?void 0:s.toJSON()));const l=new Et(a).sendHandshakeReply();return this._status="pending",await l.then((e=>{this._child=e,this._connected=!0,this._call=async(t,n={},i)=>{if(i){const e=++r;o.set(e,i),n._sync=e,i.setTag(`async call #${e}`),Mt(`async call #${e}`)}return e.emit(Dt(a.baseInfo.id),{type:t,payload:n}),null==i?void 0:i.promise},this._callUserModel=async(e,t)=>{try{a[e](t)}catch(t){Mt(`[model method] #${e} not existed`)}},setInterval((()=>{if(o.size>100)for(const[e,t]of o)t.settled&&o.delete(e)}),18e5)})).finally((()=>{this._status=void 0})),await i.promise,a.baseInfo}async call(e,t={}){var n;return null===(n=this._call)||void 0===n?void 0:n.call(this,e,t)}async callAsync(e,t={}){var n;const r=gt(1e4);return null===(n=this._call)||void 0===n?void 0:n.call(this,e,t,r)}async callUserModel(e,...t){var n;return null===(n=this._callUserModel)||void 0===n?void 0:n.apply(this,[e,...t])}async callUserModelAsync(e,...t){var n;return e=`${Ft}${e}`,null===(n=this._callUserModel)||void 0===n?void 0:n.apply(this,[e,...t])}async _setupIframeSandbox(){const e=this._pluginLocal,t=e.id,n=`${t}_lsp_main`,r=new URL(e.options.entry);r.searchParams.set("__v__",e.options.version);const o=document.querySelector(`#${n}`);o&&o.parentElement.removeChild(o);const i=document.createElement("div");i.classList.add("lsp-iframe-sandbox-container"),i.id=n,i.dataset.pid=t;try{var a;const e=null===(a=await this._pluginLocal._loadLayoutsData())||void 0===a?void 0:a.$$0;if(e){i.dataset.inited_layout="true";let{width:t,height:n,left:r,top:o,vw:a,vh:s}=e;r=Math.max(r,0),r="number"==typeof a?`${Math.min(100*r/a,99)}%`:`${r}px`,o=Math.max(o,45),o="number"==typeof s?`${Math.min(100*o/s,99)}%`:`${o}px`,Object.assign(i.style,{width:t+"px",height:n+"px",left:r,top:o})}}catch(e){console.error("[Restore Layout Error]",e)}document.body.appendChild(i);const s=new kt({id:t+"_iframe",container:i,url:r.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(e.toJSON()))}});let l,c=s.sendHandshake();return this._status="pending",new Promise(((t,n)=>{l=setTimeout((()=>{n(new Error("handshake Timeout")),s.destroy()}),4e3),c.then((n=>{this._parent=n,this._connected=!0,this.emit("connected"),n.on(Dt(e.id),(({type:e,payload:t})=>{var n,r;Mt("[user -> *host] ",e,t),null===(n=this._pluginLocal)||void 0===n||n.emit(e,t||{}),null===(r=this._pluginLocal)||void 0===r||r.caller.emit(e,t||{})})),this._call=async(...t)=>{await n.call(Dt(e.id),{type:t[0],payload:Object.assign(t[1]||{},{$$pid:e.id})})},this._callUserModel=async(e,...t)=>{if(e.startsWith(Ft))return await n.get(e.replace(Ft,""),...t);n.call(e,null==t?void 0:t[0])},t(null)})).catch((e=>{n(e)})).finally((()=>{clearTimeout(l)}))})).catch((e=>{throw Mt("[iframe sandbox] error",e),e})).finally((()=>{this._status=void 0}))}async _setupShadowSandbox(){const e=this._pluginLocal,t=this._shadow=new It(e);try{this._status="pending",await t.load(),this._connected=!0,this.emit("connected"),this._call=async(t,n={},r)=>{var o;return r&&(n.actor=r),null===(o=this._pluginLocal)||void 0===o||o.emit(t,Object.assign(n,{$$pid:e.id})),null==r?void 0:r.promise},this._callUserModel=async(...e)=>{var t;let n=e[0];null!==(t=n)&&void 0!==t&&t.startsWith(Ft)&&(n=n.replace(Ft,""));const r=e[1]||{},o=this._userModel[n];"function"==typeof o&&await o.call(null,r)}}catch(e){throw Mt("[shadow sandbox] error",e),e}finally{this._status=void 0}}_extendUserModel(e){return Object.assign(this._userModel,e)}_getSandboxIframeContainer(){var e;return null===(e=this._parent)||void 0===e?void 0:e.frame.parentNode}_getSandboxShadowContainer(){var e;return null===(e=this._shadow)||void 0===e?void 0:e.frame.parentNode}_getSandboxIframeRoot(){var e;return null===(e=this._parent)||void 0===e?void 0:e.frame}_getSandboxShadowRoot(){var e;return null===(e=this._shadow)||void 0===e?void 0:e.frame}set debugTag(e){this._debugTag=e}async destroy(){var e;let t=null;this._parent&&(t=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(t=this._getSandboxShadowContainer(),this._shadow.destroy()),null===(e=t)||void 0===e||e.parentNode.removeChild(t)}}function Ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class $t{constructor(e,t){Ut(this,"ctx",void 0),Ut(this,"opts",void 0),this.ctx=e,this.opts=t}get ctxId(){return this.ctx.baseInfo.id}setItem(e,t){var n;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,e,t,null===(n=this.opts)||void 0===n?void 0:n.assets]})}getItem(e){var t;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,e,null===(t=this.opts)||void 0===t?void 0:t.assets]})}removeItem(e){var t;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,e,null===(t=this.opts)||void 0===t?void 0:t.assets]})}allKeys(){var e;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,null===(e=this.opts)||void 0===e?void 0:e.assets]})}clear(){var e;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,null===(e=this.opts)||void 0===e?void 0:e.assets]})}hasItem(e){var t;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,e,null===(t=this.opts)||void 0===t?void 0:t.assets]})}}class zt{constructor(e){var t;t=void 0,"ctx"in this?Object.defineProperty(this,"ctx",{value:t,enumerable:!0,configurable:!0,writable:!0}):this.ctx=t,this.ctx=e}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(e,...t){var n,r;const o=this.ensureHostScope();return e=null===(n=dt(e))||void 0===n?void 0:n.toLowerCase(),null===(r=o.logseq.api["exper_"+e])||void 0===r?void 0:r.apply(o,t)}async loadScripts(...e){(e=e.map((e=>null!=e&&e.startsWith("http")?e:this.ctx.resolveResourceFullUrl(e)))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...e)}registerFencedCodeRenderer(e,t){return this.ensureHostScope().logseq.api.exper_register_fenced_code_renderer(this.ctx.baseInfo.id,e,t)}registerExtensionsEnhancer(e,t){const n=this.ensureHostScope();return"katex"===e&&n.katex&&t(n.katex).catch(console.error),n.logseq.api.exper_register_extensions_enhancer(this.ctx.baseInfo.id,e,t)}ensureHostScope(){if(window===top)throw new Error("Can not access host scope!");return top}}function Bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ht=e=>`task_callback_${e}`;class qt{constructor(e,t,n={}){Bt(this,"_client",void 0),Bt(this,"_requestId",void 0),Bt(this,"_requestOptions",void 0),Bt(this,"_promise",void 0),Bt(this,"_aborted",!1),this._client=e,this._requestId=t,this._requestOptions=n,this._promise=new Promise(((e,t)=>{if(!this._requestId)return t(null);this._client.once(Ht(this._requestId),(n=>{n&&n instanceof Error?t(n):e(n)}))}));const{success:r,fail:o,final:i}=this._requestOptions;this._promise.then((e=>{null==r||r(e)})).catch((e=>{null==o||o(e)})).finally((()=>{null==i||i()}))}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class Wt extends lt.EventEmitter{constructor(e){super(),Bt(this,"_ctx",void 0),this._ctx=e,this.ctx.caller.on("#lsp#request#callback",(e=>{const t=null==e?void 0:e.requestId;t&&this.emit(Ht(t),null==e?void 0:e.payload)}))}static createRequestTask(e,t,n){return new qt(e,t,n)}async _request(e){const t=this.ctx.baseInfo.id,{success:n,fail:r,final:o,...i}=e,a=this.ctx.Experiments.invokeExperMethod("request",t,i),s=Wt.createRequestTask(this.ctx.Request,a,e);return i.abortable?s:s.promise}get ctx(){return this._ctx}}const Gt=ie(Object.keys,Object);var Vt=Object.prototype.hasOwnProperty;const Jt=function(e){return ve(e)?$e(e):function(e){if(!le(e))return Gt(e);var t=[];for(var n in Object(e))Vt.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)};function Yt(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new q;++t<n;)this.add(e[t])}Yt.prototype.add=Yt.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Yt.prototype.has=function(e){return this.__data__.has(e)};const Zt=Yt,Kt=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},Qt=function(e,t){return e.has(t)},Xt=function(e,t,n,r,o,i){var a=1&n,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=i.get(e),u=i.get(t);if(c&&u)return c==t&&u==e;var f=-1,d=!0,p=2&n?new Zt:void 0;for(i.set(e,t),i.set(t,e);++f<s;){var h=e[f],g=t[f];if(r)var m=a?r(g,h,f,t,e,i):r(h,g,f,e,t,i);if(void 0!==m){if(m)continue;d=!1;break}if(p){if(!Kt(t,(function(e,t){if(!Qt(p,t)&&(h===e||o(h,e,n,r,i)))return p.push(t)}))){d=!1;break}}else if(h!==g&&!o(h,g,n,r,i)){d=!1;break}}return i.delete(e),i.delete(t),d},en=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n},tn=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n};var nn=p?p.prototype:void 0,rn=nn?nn.valueOf:void 0;const on=function(e,n,r,o,i,a,s){switch(r){case"[object DataView]":if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=n.byteLength||!a(new te(e),new te(n)));case"[object Boolean]":case"[object Date]":case"[object Number]":return t(+e,+n);case"[object Error]":return e.name==n.name&&e.message==n.message;case"[object RegExp]":case"[object String]":return e==n+"";case"[object Map]":var l=en;case"[object Set]":var c=1&o;if(l||(l=tn),e.size!=n.size&&!c)return!1;var u=s.get(e);if(u)return u==n;o|=2,s.set(e,n);var f=Xt(l(e),l(n),o,i,a,s);return s.delete(e),f;case"[object Symbol]":if(rn)return rn.call(e)==rn.call(n)}return!1};var an=Object.prototype.propertyIsEnumerable,sn=Object.getOwnPropertySymbols;const ln=sn?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i}(sn(e),(function(t){return an.call(e,t)})))}:function(){return[]},cn=function(e){return function(e,t,n){var r=t(e);return ge(e)?r:function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}(r,n(e))}(e,Jt,ln)};var un=Object.prototype.hasOwnProperty;const fn=F(d,"DataView"),dn=F(d,"Promise"),pn=F(d,"Set"),hn=F(d,"WeakMap");var gn="[object Map]",mn="[object Promise]",vn="[object Set]",yn="[object WeakMap]",bn="[object DataView]",_n=E(fn),wn=E(R),Cn=E(dn),xn=E(pn),An=E(hn),Sn=_;(fn&&Sn(new fn(new ArrayBuffer(1)))!=bn||R&&Sn(new R)!=gn||dn&&Sn(dn.resolve())!=mn||pn&&Sn(new pn)!=vn||hn&&Sn(new hn)!=yn)&&(Sn=function(e){var t=_(e),n="[object Object]"==t?e.constructor:void 0,r=n?E(n):"";if(r)switch(r){case _n:return bn;case wn:return gn;case Cn:return mn;case xn:return vn;case An:return yn}return t});const kn=Sn;var En="[object Arguments]",On="[object Array]",Tn="[object Object]",Nn=Object.prototype.hasOwnProperty;const jn=function(e,t,n,r,o,i){var a=ge(e),s=ge(t),l=a?On:kn(e),c=s?On:kn(t),u=(l=l==En?Tn:l)==Tn,f=(c=c==En?Tn:c)==Tn,d=l==c;if(d&&we(e)){if(!we(t))return!1;a=!0,u=!1}if(d&&!u)return i||(i=new G),a||Le(e)?Xt(e,t,n,r,o,i):on(e,t,l,n,r,o,i);if(!(1&n)){var p=u&&Nn.call(e,"__wrapped__"),h=f&&Nn.call(t,"__wrapped__");if(p||h){var g=p?e.value():e,m=h?t.value():t;return i||(i=new G),o(g,m,n,r,i)}}return!!d&&(i||(i=new G),function(e,t,n,r,o,i){var a=1&n,s=cn(e),l=s.length;if(l!=cn(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:un.call(t,u)))return!1}var f=i.get(e),d=i.get(t);if(f&&d)return f==t&&d==e;var p=!0;i.set(e,t),i.set(t,e);for(var h=a;++c<l;){var g=e[u=s[c]],m=t[u];if(r)var v=a?r(m,g,u,t,e,i):r(g,m,u,e,t,i);if(!(void 0===v?g===m||o(g,m,n,r,i):v)){p=!1;break}h||(h="constructor"==u)}if(p&&!h){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(p=!1)}return i.delete(e),i.delete(t),p}(e,t,n,r,o,i))},In=function e(t,n,r,o,i){return t===n||(null==t||null==n||!ce(t)&&!ce(n)?t!=t&&n!=n:jn(t,n,r,o,e,i))},Ln=function(e){return e==e&&!w(e)},Mn=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}},Fn=function(e){var t=function(e){for(var t=Jt(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,Ln(o)]}return t}(e);return 1==t.length&&t[0][2]?Mn(t[0][0],t[0][1]):function(n){return n===e||function(e,t,n,r){var o=n.length,i=o,a=!r;if(null==e)return!i;for(e=Object(e);o--;){var s=n[o];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<i;){var l=(s=n[o])[0],c=e[l],u=s[1];if(a&&s[2]){if(void 0===c&&!(l in e))return!1}else{var f=new G;if(r)var d=r(c,u,l,e,t,f);if(!(void 0===d?In(u,c,3,r,f):d))return!1}}return!0}(n,e,t)}},Rn=function(e){return"symbol"==typeof e||ce(e)&&"[object Symbol]"==_(e)};var Dn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pn=/^\w*$/;const Un=function(e,t){if(ge(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Rn(e))||Pn.test(e)||!Dn.test(e)||null!=t&&e in Object(t)};function $n(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=e.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new($n.Cache||q),n}$n.Cache=q;const zn=$n;var Bn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Hn=/\\(\\)?/g;const qn=function(e){var t=zn((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Bn,(function(e,n,r,o){t.push(r?o.replace(Hn,"$1"):n||e)})),t}),(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}();var Wn=p?p.prototype:void 0,Gn=Wn?Wn.toString:void 0;const Vn=function e(t){if("string"==typeof t)return t;if(ge(t))return function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}(t,e)+"";if(Rn(t))return Gn?Gn.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n},Jn=function(e,t){return ge(e)?e:Un(e,t)?[e]:qn(function(e){return null==e?"":Vn(e)}(e))},Yn=function(e){if("string"==typeof e||Rn(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},Zn=function(e,t){for(var n=0,r=(t=Jn(t,e)).length;null!=e&&n<r;)e=e[Yn(t[n++])];return n&&n==r?e:void 0},Kn=function(e,t){return null!=e&&t in Object(e)},Qn=function(e,t){return null!=e&&function(e,t,n){for(var r=-1,o=(t=Jn(t,e)).length,i=!1;++r<o;){var a=Yn(t[r]);if(!(i=null!=e&&n(e,a)))break;e=e[a]}return i||++r!=o?i:!!(o=null==e?0:e.length)&&me(o)&&Pe(a,o)&&(ge(e)||he(e))}(e,t,Kn)},Xn=function(e,t){return Un(e)&&Ln(t)?Mn(Yn(e),t):function(n){var r=function(e,t,n){var r=null==e?void 0:Zn(e,t);return void 0===r?n:r}(n,e);return void 0===r&&r===t?Qn(n,e):In(t,r,3)}},er=function(e){return Un(e)?function(e){return function(t){return null==t?void 0:t[e]}}(Yn(e)):function(e){return function(t){return Zn(t,e)}}(e)},tr=function(e,t){var n={};return t=function(e){return"function"==typeof e?e:null==e?Ve:"object"==typeof e?ge(e)?Xn(e[0],e[1]):Fn(e):er(e)}(t),function(e,t){e&&Z(e,t,Jt)}(e,(function(e,r,o){J(n,t(e,r,o),e)})),n};function nr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class rr{constructor(e,t){nr(this,"ctx",void 0),nr(this,"serviceHooks",void 0),this.ctx=e,this.serviceHooks=t,e._execCallableAPI("register-search-service",e.baseInfo.id,t.name,t.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:e=>(ge(null==e?void 0:e.blocks)&&(e.blocks=e.blocks.map((e=>e&&tr(e,((e,t)=>`block/${t}`))))),e)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach((([n,r])=>{const o=(e=>`service:search:${e}:${t.name}`)(n);e.caller.on(o,(async n=>{if(C(null==t?void 0:t[r.f])){let i=null;try{i=await t[r.f].apply(t,(r.args||[]).map((e=>{if(n){if(!0===e)return n;if(n.hasOwnProperty(e)){const t=n[e];return delete n[e],t}}}))),r.transformOutput&&(i=r.transformOutput(i))}catch(e){console.error("[SearchService] ",e),i=e}finally{r.reply&&e.caller.call(`${o}:reply`,i)}}}))}))}}function or(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ir=Symbol.for("proxy-continue"),ar=yt()("LSPlugin:user"),sr=new ht("",{console:!0});function lr(e,t,n){var r;if("function"!=typeof n)return!1;const{key:o,label:i,desc:a,palette:s,keybinding:l,extras:c}=t,u=`SimpleCommandHook${o}${++pr}`;this.Editor["on"+u](n),null===(r=this.caller)||void 0===r||r.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:o,label:i,type:e,desc:a,keybinding:l,extras:c},["editor/hook",u]],s]})}function cr(e){return!("string"!=typeof(t=e)||36!==t.length||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(t))||(sr.error(`#${e} is not a valid UUID string.`),!1);var t}let ur=null,fr=new Map;const dr={async getInfo(e){return ur||(ur=await this._execCallableAPIAsync("get-app-info")),"string"==typeof e?ur[e]:ur},registerCommand:lr,registerSearchService(e){if(fr.has(e.name))throw new Error(`SearchService: #${e.name} has registered!`);fr.set(e.name,new rr(this,e))},registerCommandPalette(e,t){const{key:n,label:r,keybinding:o}=e;return lr.call(this,"$palette$",{key:n,label:r,palette:!0,keybinding:o},t)},registerCommandShortcut(e,t){const{binding:n}=e,r="$shortcut$",o=r+dt(n);return lr.call(this,r,{key:o,palette:!1,keybinding:e},t)},registerUIItem(e,t){var n;const r=this.baseInfo.id;null===(n=this.caller)||void 0===n||n.call("api:call",{method:"register-plugin-ui-item",args:[r,e,t]})},registerPageMenuItem(e,t){if("function"!=typeof t)return!1;const n=e+"_"+this.baseInfo.id,r=e;lr.call(this,"page-menu-item",{key:n,label:r},t)},onBlockRendererSlotted(e,t){if(!cr(e))return;const n=this.baseInfo.id,r=`hook:editor:${dt(`slot:${e}`)}`;return this.caller.on(r,t),this.App._installPluginHook(n,r),()=>{this.caller.off(r,t),this.App._uninstallPluginHook(n,r)}},invokeExternalPlugin(e,...t){var n;if(!(e=null===(n=e)||void 0===n?void 0:n.trim()))return;let[r,o]=e.split(".");if(!["models","commands"].includes(null==o?void 0:o.toLowerCase()))throw new Error("Type only support '.models' or '.commands' currently.");const i=e.replace(`${r}.${o}.`,"");if(!r||!o||!i)throw new Error(`Illegal type of #${e} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",r,o.toLowerCase(),i,t)},setFullScreen(e){const t=(...e)=>this._callWin("setFullScreen",...e);"toggle"===e?this._callWin("isFullScreen").then((e=>{e?t():t(!0)})):e?t(!0):t()}};let pr=0;const hr={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(e,t){var n;ar("Register slash command #",this.baseInfo.id,e,t),"function"==typeof t&&(t=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",t]]),t=t.map((e=>{const[t,...n]=e;if("editor/hook"===t){let r=n[0],o=()=>{var e;null===(e=this.caller)||void 0===e||e.callUserModel(r)};"function"==typeof r&&(o=r);const i=`SlashCommandHook${t}${++pr}`;e[1]=i,this.Editor["on"+i](o)}return e})),null===(n=this.caller)||void 0===n||n.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[e,t]]})},registerBlockContextMenuItem(e,t){if("function"!=typeof t)return!1;const n=e+"_"+this.baseInfo.id;lr.call(this,"block-context-menu-item",{key:n,label:e},t)},registerHighlightContextMenuItem(e,t,n){if("function"!=typeof t)return!1;const r=e+"_"+this.baseInfo.id;lr.call(this,"highlight-context-menu-item",{key:r,label:e,extras:n},t)},scrollToBlockInPage(e,t,n){const r="block-content-"+t;null!=n&&n.replaceState?this.App.replaceState("page",{name:e},{anchor:r}):this.App.pushState("page",{name:e},{anchor:r})}},gr={onBlockChanged(e,t){if(!cr(e))return;const n=this.baseInfo.id,r=`hook:db:${dt(`block:${e}`)}`,o=({block:n,txData:r,txMeta:o})=>{n.uuid===e&&t(n,r,o)};return this.caller.on(r,o),this.App._installPluginHook(n,r),()=>{this.caller.off(r,o),this.App._uninstallPluginHook(n,r)}},datascriptQuery(e,...t){return t.pop(),null!=t&&t.some((e=>"function"==typeof e))?this.Experiments.ensureHostScope().logseq.api.datascript_query(e,...t):this._execCallableAPIAsync("datascript_query",e,...t)}},mr={},vr={},yr={makeSandboxStorage(){return new $t(this,{assets:!0})}};class br extends(ct()){constructor(e,t){super(),or(this,"_baseInfo",void 0),or(this,"_caller",void 0),or(this,"_version","0.0.14"),or(this,"_debugTag",""),or(this,"_settingsSchema",void 0),or(this,"_connected",!1),or(this,"_ui",new Map),or(this,"_mFileStorage",void 0),or(this,"_mRequest",void 0),or(this,"_mExperiments",void 0),or(this,"_beforeunloadCallback",void 0),this._baseInfo=e,this._caller=t,t.on("sys:ui:visible",(e=>{null!=e&&e.toggle&&this.toggleMainUI()})),t.on("settings:changed",(e=>{const t=Object.assign({},this.settings),n=Object.assign(this._baseInfo.settings,e);this.emit("settings:changed",{...n},t)})),t.on("beforeunload",(async e=>{const{actor:n,...r}=e,o=this._beforeunloadCallback;try{o&&await o(r),null==n||n.resolve(null)}catch(e){console.debug(`${t.debugTag} [beforeunload] `,e),null==n||n.reject(e)}}))}async ready(e,t){if(!this._connected)try{var n;"function"==typeof e&&(t=e,e={});let r=await this._caller.connectToParent(e);this._connected=!0,r=pt(this._baseInfo,r),null!==(n=r)&&void 0!==n&&n.id&&(this._debugTag=this._caller.debugTag=`#${r.id} [${r.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(r.settings=function(e,t){const n=(t||[]).reduce(((e,t)=>("default"in t&&(e[t.key]=t.default),e)),{});return Object.assign(n,e)}(r.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(e){console.warn(e)}t&&t.call(this,r)}catch(e){console.error(`${this._debugTag} [Ready Error]`,e)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(e){"function"==typeof e&&(this._beforeunloadCallback=e)}provideModel(e){return this.caller._extendUserModel(e),this}provideTheme(e){return this.caller.call("provider:theme",e),this}provideStyle(e){return this.caller.call("provider:style",e),this}provideUI(e){return this.caller.call("provider:ui",e),this}useSettingsSchema(e){return this.connected&&this.caller.call("settings:schema",{schema:e,isSync:!0}),this._settingsSchema=e,this}updateSettings(e){this.caller.call("settings:update",e)}onSettingsChanged(e){const t="settings:changed";return this.on(t,e),()=>this.off(t,e)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(e){this.caller.call("main-ui:attrs",e)}setMainUIInlineStyle(e){this.caller.call("main-ui:style",e)}hideMainUI(e){const t={key:0,visible:!1,cursor:null==e?void 0:e.restoreEditingCursor};this.caller.call("main-ui:visible",t),this.emit("ui:visible:changed",t),this._ui.set(t.key,t)}showMainUI(e){const t={key:0,visible:!0,autoFocus:null==e?void 0:e.autoFocus};this.caller.call("main-ui:visible",t),this.emit("ui:visible:changed",t),this._ui.set(t.key,t)}toggleMainUI(){const e=this._ui.get(0);e&&e.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){const e=this._ui.get(0);return Boolean(e&&e.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){return this&&((null===(e=this.baseInfo)||void 0===e?void 0:e.effect)||!(null!==(t=this.baseInfo)&&void 0!==t&&t.iir));var e,t}get logger(){return sr}get settings(){var e;return null===(e=this.baseInfo)||void 0===e?void 0:e.settings}get caller(){return this._caller}resolveResourceFullUrl(e){if(this.ensureConnected(),e)return e=e.replace(/^[.\\/]+/,""),function(e,...t){try{const n=new URL(e);if(!n.origin)throw new Error(null);const r=ft.join(e.substr(n.origin.length),...t);return n.origin+r}catch(o){return ft.join(e,...t)}}(this._baseInfo.lsr,e)}_makeUserProxy(e,t){const n=this,r=this.caller;return new Proxy(e,{get(e,o,i){const a=e[o];return function(...e){if(a){const r=a.apply(n,e.concat(t));if(r!==ir)return r}if(t){const i=o.toString().match(/^(once|off|on)/i);if(null!=i){const o=i[0].toLowerCase(),a=i.input.slice(o.length),s="off"===o,l=n.baseInfo.id,c=`hook:${t}:${dt(a)}`,u=e[0];r[o](c,u);const f=()=>{r.off(c,u),r.listenerCount(c)||n.App._uninstallPluginHook(l,c)};return s?void f():(n.App._installPluginHook(l,c),f)}}let i=o;return["git","ui","assets"].includes(t)&&(i=t+"_"+i),r.callAsync("api:call",{tag:t,method:i,args:e})}}})}_execCallableAPIAsync(e,...t){return this._caller.callAsync("api:call",{method:e,args:t})}_execCallableAPI(e,...t){this._caller.call("api:call",{method:e,args:t})}_callWin(...e){return this._execCallableAPIAsync("_callMainWin",...e)}get App(){return this._makeUserProxy(dr,"app")}get Editor(){return this._makeUserProxy(hr,"editor")}get DB(){return this._makeUserProxy(gr,"db")}get Git(){return this._makeUserProxy(mr,"git")}get UI(){return this._makeUserProxy(vr,"ui")}get Assets(){return this._makeUserProxy(yr,"assets")}get FileStorage(){let e=this._mFileStorage;return e||(e=this._mFileStorage=new $t(this)),e}get Request(){let e=this._mRequest;return e||(e=this._mRequest=new Wt(this)),e}get Experiments(){let e=this._mExperiments;return e||(e=this._mExperiments=new zt(this)),e}}function _r(e,t){return new br(e,t)}if(null==window.__LSP__HOST__){const e=new Pt(null);window.logseq=_r({},e)}})(),i})(),"object"==typeof r&&"object"==typeof n?n.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof r?r.LSPluginEntry=t():e.LSPluginEntry=t(),n.exports;var i=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function a(e){return u(e,i)}var s=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function l(e){return u(e,s)}var c=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function u(e,t){return t.indexOf(e.nodeName)>=0}function f(e,t){return e.getElementsByTagName&&t.some((function(t){return e.getElementsByTagName(t).length}))}var d={};function p(e){return e?e.replace(/(\n+\s*)+/g,"\n"):""}function h(e){for(var t in this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[],e.rules)this.array.push(e.rules[t])}function g(e,t,n){for(var r=0;r<e.length;r++){var o=e[r];if(m(o,t,n))return o}}function m(e,t,n){var r=e.filter;if("string"==typeof r){if(r===t.nodeName.toLowerCase())return!0}else if(Array.isArray(r)){if(r.indexOf(t.nodeName.toLowerCase())>-1)return!0}else{if("function"!=typeof r)throw new TypeError("`filter` needs to be a string, array, or function");if(r.call(e,t,n))return!0}}function v(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function y(e,t,n){return e&&e.parentNode===t||n(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}d.paragraph={filter:"p",replacement:function(e){return"\n\n"+e+"\n\n"}},d.lineBreak={filter:"br",replacement:function(e,t,n){return n.br+"\n"}},d.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t,n){var r=Number(t.nodeName.charAt(1));return"setext"===n.headingStyle&&r<3?"\n\n"+e+"\n"+o(1===r?"=":"-",e.length)+"\n\n":"\n\n"+o("#",r)+" "+e+"\n\n"}},d.blockquote={filter:"blockquote",replacement:function(e){return"\n\n"+(e=(e=e.replace(/^\n+|\n+$/g,"")).replace(/^/gm,"> "))+"\n\n"}},d.list={filter:["ul","ol"],replacement:function(e,t){if(/ul\d+/.test(t.className)){let t=e.split("\n");return t.forEach((function(e,n){t[n]=" "+e})),"\n"+t.join("\n")+"\n"}var n=t.parentNode;return"LI"===n.nodeName&&n.lastElementChild===t?"\n"+e:"\n\n"+e+"\n\n"}},d.listItem={filter:"li",replacement:function(e,t,n){e=e.replace(/^\n+/,"").replace(/\n+$/,"\n").replace(/\n/gm,"\n    ");let r=" ";t.hasAttribute("aria-level")&&(r=o("  ",Number(t.getAttribute("aria-level"))));var i=n.bulletListMarker+r,a=t.parentNode;if("OL"===a.nodeName){var s=a.getAttribute("start"),l=Array.prototype.indexOf.call(a.children,t);i=r+(s?Number(s)+l:l+1)+".  "}return i+e+(t.nextSibling&&!/\n$/.test(e)?"\n":"")}},d.indentedCodeBlock={filter:function(e,t){return"indented"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(e,t,n){return"\n\n    "+t.firstChild.textContent.replace(/\n/g,"\n    ")+"\n\n"}},d.fencedCodeBlock={filter:function(e,t){return"fenced"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(e,t,n){for(var r,i=((t.firstChild.getAttribute("class")||"").match(/language-(\S+)/)||[null,""])[1],a=t.firstChild.textContent,s=n.fence.charAt(0),l=3,c=new RegExp("^"+s+"{3,}","gm");r=c.exec(a);)r[0].length>=l&&(l=r[0].length+1);var u=o(s,l);return"\n\n"+u+i+"\n"+a.replace(/\n$/,"")+"\n"+u+"\n\n"}},d.horizontalRule={filter:"hr",replacement:function(e,t,n){return"\n\n"+n.hr+"\n\n"}},d.inlineLink={filter:function(e,t){return"inlined"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href")&&(!e.firstChild||"IMG"!==e.firstChild.nodeName)},replacement:function(e,t){var n=t.getAttribute("href"),r=p(t.getAttribute("title"));return r&&(r=' "'+r+'"'),"["+e+"]("+n+r+")"}},d.referenceLink={filter:function(e,t){return"referenced"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href")},replacement:function(e,t,n){var r,o,i=t.getAttribute("href"),a=p(t.getAttribute("title"));switch(a&&(a=' "'+a+'"'),n.linkReferenceStyle){case"collapsed":r="["+e+"][]",o="["+e+"]: "+i+a;break;case"shortcut":r="["+e+"]",o="["+e+"]: "+i+a;break;default:var s=this.references.length+1;r="["+e+"]["+s+"]",o="["+s+"]: "+i+a}return this.references.push(o),r},references:[],append:function(e){var t="";return this.references.length&&(t="\n\n"+this.references.join("\n")+"\n\n",this.references=[]),t}},d.emphasis={filter:["em","i"],replacement:function(e,t,n){return e.trim()?n.emDelimiter+e+n.emDelimiter:""}},d.strong={filter:["strong","b"],replacement:function(e,t,n){return e.trim()?n.strongDelimiter+e+n.strongDelimiter:""}},d.code={filter:function(e){var t=e.previousSibling||e.nextSibling,n="PRE"===e.parentNode.nodeName&&!t;return"CODE"===e.nodeName&&!n},replacement:function(e){if(!e)return"";e=e.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(e)?" ":"",n="`",r=e.match(/`+/gm)||[];-1!==r.indexOf(n);)n+="`";return n+t+e+t+n}},d.image={filter:"img",replacement:function(e,t){var n=p(t.getAttribute("alt")),r=t.getAttribute("src")||"",o=p(t.getAttribute("title"));return r?"!["+n+"]("+r+(o?' "'+o+'"':"")+")":""}},h.prototype={add:function(e,t){this.array.unshift(t)},keep:function(e){this._keep.unshift({filter:e,replacement:this.keepReplacement})},remove:function(e){this._remove.unshift({filter:e,replacement:function(){return""}})},forNode:function(e){return e.isBlank?this.blankRule:(t=g(this.array,e,this.options))||(t=g(this._keep,e,this.options))||(t=g(this._remove,e,this.options))?t:this.defaultRule;var t},forEach:function(e){for(var t=0;t<this.array.length;t++)e(this.array[t],t)}};var b="undefined"!=typeof window?window:{};var _,w,C,x=function(){var e=b.DOMParser,n=!1;try{(new e).parseFromString("","text/html")&&(n=!0)}catch(t){}return n}()?b.DOMParser:(_=function(){},w=require("domino"),_.prototype.parseFromString=function(e){return w.createDocument(e)},_);function A(e,t){var n;"string"==typeof e?n=(C=C||new x).parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html").getElementById("turndown-root"):n=e.cloneNode(!0);return function(e){var t=e.element,n=e.isBlock,r=e.isVoid,o=e.isPre||function(e){return"PRE"===e.nodeName};if(t.firstChild&&!o(t)){var i=null,a=!1,s=null,l=y(s,t,o);for(console.log("node:"+l);l!==t;){if(3===l.nodeType||4===l.nodeType){var c=l.data.replace(/[ \r\n\t]+/g," ");if(i&&!/ $/.test(i.data)||a||" "!==c[0]||(c=c.substr(1)),!c){l=v(l);continue}l.data=c,i=l}else{if(1!==l.nodeType){l=v(l);continue}n(l)||"BR"===l.nodeName?(i&&(i.data=i.data.replace(/ $/,"")),i=null,a=!1):r(l)||o(l)?(i=null,a=!0):i&&(a=!1)}var u=y(s,l,o);s=l,l=u}i&&(i.data=i.data.replace(/ $/,""),i.data||v(i))}}({element:n,isBlock:a,isVoid:l,isPre:t.preformattedCode?S:null}),n}function S(e){return"PRE"===e.nodeName||"CODE"===e.nodeName}function k(e,t){return e.isBlock=a(e),e.isCode="CODE"===e.nodeName||e.parentNode.isCode,e.isBlank=function(e){return!l(e)&&!function(e){return u(e,c)}(e)&&/^\s*$/i.test(e.textContent)&&!function(e){return f(e,s)}(e)&&!function(e){return f(e,c)}(e)}(e),e.flankingWhitespace=function(e,t){if(e.isBlock||t.preformattedCode&&e.isCode)return{leading:"",trailing:""};var n=(r=e.textContent,o=r.match(/^(([ \t\r\n]*)(\s*))[\s\S]*?((\s*?)([ \t\r\n]*))$/),{leading:o[1],leadingAscii:o[2],leadingNonAscii:o[3],trailing:o[4],trailingNonAscii:o[5],trailingAscii:o[6]});var r,o;n.leadingAscii&&E("left",e,t)&&(n.leading=n.leadingNonAscii);n.trailingAscii&&E("right",e,t)&&(n.trailing=n.trailingNonAscii);return{leading:n.leading,trailing:n.trailing}}(e,t),e}function E(e,t,n){var r,o,i;return"left"===e?(r=t.previousSibling,o=/ $/):(r=t.nextSibling,o=/^ /),r&&(3===r.nodeType?i=o.test(r.nodeValue):n.preformattedCode&&"CODE"===r.nodeName?i=!1:1!==r.nodeType||a(r)||(i=o.test(r.textContent))),i}var O=Array.prototype.reduce,T=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function N(e){if(!(this instanceof N))return new N(e);var t={rules:d,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(e,t){return t.isBlock?"\n\n":""},keepReplacement:function(e,t){return t.isBlock?"\n\n"+t.outerHTML+"\n\n":t.outerHTML},defaultReplacement:function(e,t){return t.isBlock?"\n\n"+e+"\n\n":e}};this.options=function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}return e}({},t,e),this.rules=new h(this.options)}function j(e){var t=this;return O.call(e.childNodes,(function(e,n){var r="";return 3===(n=new k(n,t.options)).nodeType?r=n.isCode?n.nodeValue:t.escape(n.nodeValue):1===n.nodeType&&(r=L.call(t,n)),M(e,r)}),"")}function I(e){var t=this;return this.rules.forEach((function(n){"function"==typeof n.append&&(e=M(e,n.append(t.options)))})),e.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function L(e){var t=this.rules.forNode(e),n=j.call(this,e),r=e.flankingWhitespace;return(r.leading||r.trailing)&&(n=n.trim()),r.leading+t.replacement(n,e,this.options)+r.trailing}function M(e,t){var n=function(e){for(var t=e.length;t>0&&"\n"===e[t-1];)t--;return e.substring(0,t)}(e),r=t.replace(/^\n*/,""),o=Math.max(e.length-n.length,t.length-r.length);return n+"\n\n".substring(0,o)+r}N.prototype={turndown:function(e){if(!function(e){return null!=e&&("string"==typeof e||e.nodeType&&(1===e.nodeType||9===e.nodeType||11===e.nodeType))}(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(""===e)return"";var t=j.call(this,new A(e,this.options));return I.call(this,t)},use:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else{if("function"!=typeof e)throw new TypeError("plugin must be a Function or an Array of Functions");e(this)}return this},addRule:function(e,t){return this.rules.add(e,t),this},keep:function(e){return this.rules.keep(e),this},remove:function(e){return this.rules.remove(e),this},escape:function(e){return T.reduce((function(e,t){return e.replace(t[0],t[1])}),e)}};var F=/highlight-(?:text|source)-([a-z0-9]+)/;function R(e){e.addRule("highlightedCodeBlock",{filter:function(e){var t=e.firstChild;return"DIV"===e.nodeName&&F.test(e.className)&&t&&"PRE"===t.nodeName},replacement:function(e,t,n){var r=((t.className||"").match(F)||[null,""])[1];return"\n\n"+n.fence+r+"\n"+t.firstChild.textContent+"\n"+n.fence+"\n\n"}})}function D(e){e.addRule("strikethrough",{filter:["del","s","strike"],replacement:function(e){return"~"+e+"~"}})}var P=Array.prototype.indexOf,U={};function $(e,t){var n=" ";return 0===P.call(t.parentNode.childNodes,t)&&(n="| "),n+(e=(e=e.replace(/\r\n/g,"\n").replace(/\n/g," ")).replace(/\|/g,"\\|"))+" |"}function z(e,t){var n=e.getAttribute("colspan")||1;return n<=1?"":(" "+t+" |").repeat(n-1)}function B(e){for(var t=e.parentNode;t;){if("TABLE"===t.nodeName)return!0;t=t.parentNode}return!1}function H(e){for(var t in e.keep((function(e){return"TABLE"===e.nodeName&&B(e)})),U)e.addRule(t,U[t])}function q(e){e.addRule("taskListItems",{filter:function(e){return"checkbox"===e.type&&"LI"===e.parentNode.nodeName},replacement:function(e,t){return(t.checked?"[x]":"[ ]")+" "}})}U.tableCell={filter:["th","td"],replacement:function(e,t){return $(e,t)+z(t,"")}},U.tableRow={filter:"tr",replacement:function(e,t){var n="",r={left:":--",right:"--:",center:":-:"};if(function(e){var t=e.parentNode,n=t;"THEAD"!==t.nodeName&&"TFOOT"!==t.nodeName&&"TBODY"!==t.nodeName||(n=t.parentNode);return"TABLE"===n.nodeName&&n.rows[0]===e}(t))for(var o=0;o<t.childNodes.length;o++){var i="---",a=(t.childNodes[o].getAttribute("align")||"").toLowerCase();a&&(i=r[a]||i),n+=$(i,t.childNodes[o])+z(t.childNodes[o],i)}return"\n"+e+(n?"\n"+n:"")}},U.table={filter:function(e){return"TABLE"===e.nodeName&&!B(e)},replacement:function(e){return"\n\n"+(e=e.replace("\n\n","\n"))+"\n\n"}},U.tableSection={filter:["thead","tbody","tfoot"],replacement:function(e){return e}},U.captionSection={filter:"caption",replacement:function(e,t){return"TABLE"===t.parentNode.nodeName&&t.parentNode.childNodes[0]===t?e:""}};function W(e){let t,n=e[0],r=1;for(;r<e.length;){const o=e[r],i=e[r+1];if(r+=2,("optionalAccess"===o||"optionalCall"===o)&&null==n)return;"access"===o||"optionalAccess"===o?(t=n,n=i(n)):"call"!==o&&"optionalCall"!==o||(n=i(((...e)=>n.call(t,...e))),t=void 0)}return n}logseq.useSettingsSchema([{key:"indentHeaders",title:"Whether to indent headers",type:"boolean",default:!0,description:""},{key:"newLineBlock",title:"Whether create a new block for new line",type:"boolean",default:!0,description:""},{key:"enablePasteMore",title:"Enable paste more",type:"boolean",default:!0,description:""}]).ready((async function(){logseq.provideModel({controlUsage:c});const e="ti-clipboard";logseq.App.registerUIItem("toolbar",{key:"paste-plugin-button",template:'\n    <a class="button" data-on-click="controlUsage" data-rect>\n      <i class="ti ti-clipboard"></i>\n    </a>\n  '});const t=(e,...t)=>String.raw(e,...t);let n=logseq.settings.enablePasteMore;const r="#6b7280",o="#ff0000";let i=n?r:o;logseq.provideStyle(t`
  .${e}:before {
    color: ${i};
  }
`);let a=parent.document.getElementById("main-content-container");const s=new N({headingStyle:"atx",codeBlockStyle:"fenced",hr:"---",bulletListMarker:""});async function l(e){const t=e.clipboardData.types;if(t.includes("Files")&&!t.includes("text/plain"))return void console.log("use logseq default action");const n=e.clipboardData.getData("text/html"),r="<meta charset='utf-8'><ul><placeholder>";if(""!==n&&(n.length<45||"\x3c!-- directives: [] --\x3e"!=n.slice(22,45))&&n.slice(0,r.length)!=r){e.preventDefault(),e.stopPropagation();const t=await logseq.Editor.getCurrentBlock();let r=s.turndown(n);if(r.length>6&&"**\n"===r.slice(0,3)&&"\n**"===r.slice(r.length-3)&&(r=r.slice(3,r.length-3)),t&&t.content.startsWith("#+")||!1===W([logseq,"access",e=>e.settings,"optionalAccess",e=>e.newLineBlock]))return void(await logseq.Editor.insertAtEditingCursor(r.trim()));const o=function(e,t){const n=e.split(/\n/).filter((e=>!/^\s*$/.test(e)));if(1===n.length)return[];let r=[],o=0;for(;o<n.length;){const e=n[o];if(e.trim().startsWith("```")){let t=[e];for(o++;o<n.length&&!n[o].trim().startsWith("```");)t.push("  "+n[o]),o++;o<n.length&&(t.push(n[o]),r.push(t.join("\n")),o++)}else if(e.trim().startsWith("|")){let t=[e];for(o++;o<n.length&&n[o].trim().startsWith("|");)t.push(n[o]),o++;r.push(t.join("\n"))}else r.push(e),o++}if(1===r.length)return[];const i=[],a=[];return r.forEach((e=>{const n=e.trimStart();let r;if(n.startsWith("#"))if(t){r=-6;for(let e=0;e<n.length&&"#"===n[e];e++)r++}else r=0;else r=e.length-n.length;const o={content:n,children:[]};if(!a.length)return i.push(o),void a.push({indent:r,block:o});let s=a[a.length-1];const l=r-s.indent;if(0===l)s.parent?s.parent.children.push(o):i.push(o),s.block=o;else if(l>0)s.block.children.push(o),a.push({indent:r,block:o,parent:s.block});else if(l<0){for(;s.indent>r;){if(a.pop(),0===a.length)return i.push(o),void a.push({indent:r,block:o});s=a[a.length-1]}s.indent===r?(s.parent?s.parent.children.push(o):i.push(o),s.block=o):(s.block.children.push(o),a.push({indent:r,block:o,parent:s.block}))}})),i}(r,W([logseq,"access",e=>e.settings,"optionalAccess",e=>e.indentHeaders])).map((e=>({...e,children:e.children.length?e.children:void 0})));if(0===o.length)return void(await logseq.Editor.insertAtEditingCursor(r.trim()));await logseq.Editor.insertBatchBlock(t.uuid,o,{sibling:!0})}}async function c(){n=!n,logseq.updateSettings({enablePasteMore:n}),n?(logseq.provideStyle(t`
      .${e}:before {
        color: ${r};
      }`),a.addEventListener("paste",l),logseq.UI.showMsg("Enable paste more plugin","success")):(logseq.provideStyle(t`
      .${e}:before {
        color: ${o};
      }`),a.removeEventListener("paste",l),logseq.UI.showMsg("Disable paste more plugin","success"))}s.addRule("pre",{filter:["pre"],replacement:e=>"```\n"+e.trim()+"\n```"}),function(e){e.use([R,D,H,q])}(s),s.remove("style"),s.escape=e=>e,n&&a.addEventListener("paste",l),logseq.beforeunload((async()=>{a.removeEventListener("paste",l)})),logseq.App.registerCommandPalette({key:"paste-keyboard-shortcut",label:"enable/disable paste more"},c)})).catch(console.error);
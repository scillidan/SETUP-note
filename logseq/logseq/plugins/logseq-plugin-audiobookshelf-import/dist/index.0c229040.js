var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},n={},r=e.parcelRequire2dcb;null==r&&((r=function(e){if(e in t)return t[e].exports;if(e in n){var r=n[e];delete n[e];var i={id:e,exports:{}};return t[e]=i,r.call(i.exports,i,i.exports),i.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){n[e]=t},e.parcelRequire2dcb=r),r.register("ei7xD",(function(t,n){var r;self,r=()=>(()=>{var r={227:(e,t,n)=>{var r=n(155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(447)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},447:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,o,a=null;function s(...e){if(!s.enabled)return;const r=s,i=Number(new Date),o=i-(n||i);r.diff=o,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";a++;const o=t.formatters[i];if("function"==typeof o){const t=e[a];n=o.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},856:function(e){e.exports=function(){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,n){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,n)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r(e,i,o){return r=n()?Reflect.construct:function(e,n,r){var i=[null];i.push.apply(i,n);var o=new(Function.bind.apply(e,i));return r&&t(o,r.prototype),o},r.apply(null,arguments)}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=Object.hasOwnProperty,s=Object.setPrototypeOf,l=Object.isFrozen,c=Object.getPrototypeOf,u=Object.getOwnPropertyDescriptor,d=Object.freeze,f=Object.seal,h=Object.create,p="undefined"!=typeof Reflect&&Reflect,g=p.apply,m=p.construct;g||(g=function(e,t,n){return e.apply(t,n)}),d||(d=function(e){return e}),f||(f=function(e){return e}),m||(m=function(e,t){return r(e,i(t))});var v=E(Array.prototype.forEach),y=E(Array.prototype.pop),b=E(Array.prototype.push),w=E(String.prototype.toLowerCase),_=E(String.prototype.match),C=E(String.prototype.replace),k=E(String.prototype.indexOf),x=E(String.prototype.trim),T=E(RegExp.prototype.test),S=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return m(e,n)}}(TypeError);function E(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return g(e,t,r)}}function A(e,t){s&&s(e,null);for(var n=t.length;n--;){var r=t[n];if("string"==typeof r){var i=w(r);i!==r&&(l(t)||(t[n]=i),r=i)}e[r]=!0}return e}function O(e){var t,n=h(null);for(t in e)g(a,e,[t])&&(n[t]=e[t]);return n}function M(e,t){for(;null!==e;){var n=u(e,t);if(n){if(n.get)return E(n.get);if("function"==typeof n.value)return E(n.value)}e=c(e)}return function(e){return console.warn("fallback value for",e),null}}var j=d(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),P=d(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),D=d(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),I=d(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),F=d(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),L=d(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),N=d(["#text"]),U=d(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),R=d(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),q=d(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),z=d(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),$=f(/\{\{[\w\W]*|[\w\W]*\}\}/gm),H=f(/<%[\w\W]*|[\w\W]*%>/gm),B=f(/^data-[\-\w.\u00B7-\uFFFF]/),W=f(/^aria-[\-\w]+$/),Y=f(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),G=f(/^(?:\w+script|data):/i),J=f(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Q=f(/^html$/i),Z=function(){return"undefined"==typeof window?null:window},V=function(t,n){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return t.createPolicy(o,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z(),r=function(e){return t(e)};if(r.version="2.3.8",r.removed=[],!n||!n.document||9!==n.document.nodeType)return r.isSupported=!1,r;var o=n.document,a=n.document,s=n.DocumentFragment,l=n.HTMLTemplateElement,c=n.Node,u=n.Element,f=n.NodeFilter,h=n.NamedNodeMap,p=void 0===h?n.NamedNodeMap||n.MozNamedAttrMap:h,g=n.HTMLFormElement,m=n.DOMParser,E=n.trustedTypes,X=u.prototype,K=M(X,"cloneNode"),ee=M(X,"nextSibling"),te=M(X,"childNodes"),ne=M(X,"parentNode");if("function"==typeof l){var re=a.createElement("template");re.content&&re.content.ownerDocument&&(a=re.content.ownerDocument)}var ie=V(E,o),oe=ie?ie.createHTML(""):"",ae=a,se=ae.implementation,le=ae.createNodeIterator,ce=ae.createDocumentFragment,ue=ae.getElementsByTagName,de=o.importNode,fe={};try{fe=O(a).documentMode?a.documentMode:{}}catch(e){}var he={};r.isSupported="function"==typeof ne&&se&&void 0!==se.createHTMLDocument&&9!==fe;var pe,ge,me=$,ve=H,ye=B,be=W,we=G,_e=J,Ce=Y,ke=null,xe=A({},[].concat(i(j),i(P),i(D),i(F),i(N))),Te=null,Se=A({},[].concat(i(U),i(R),i(q),i(z))),Ee=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ae=null,Oe=null,Me=!0,je=!0,Pe=!1,De=!1,Ie=!1,Fe=!1,Le=!1,Ne=!1,Ue=!1,Re=!1,qe=!0,ze=!0,$e=!1,He={},Be=null,We=A({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ye=null,Ge=A({},["audio","video","img","source","image","track"]),Je=null,Qe=A({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ze="http://www.w3.org/1998/Math/MathML",Ve="http://www.w3.org/2000/svg",Xe="http://www.w3.org/1999/xhtml",Ke=Xe,et=!1,tt=["application/xhtml+xml","text/html"],nt="text/html",rt=null,it=a.createElement("form"),ot=function(e){return e instanceof RegExp||e instanceof Function},at=function(t){rt&&rt===t||(t&&"object"===e(t)||(t={}),t=O(t),ke="ALLOWED_TAGS"in t?A({},t.ALLOWED_TAGS):xe,Te="ALLOWED_ATTR"in t?A({},t.ALLOWED_ATTR):Se,Je="ADD_URI_SAFE_ATTR"in t?A(O(Qe),t.ADD_URI_SAFE_ATTR):Qe,Ye="ADD_DATA_URI_TAGS"in t?A(O(Ge),t.ADD_DATA_URI_TAGS):Ge,Be="FORBID_CONTENTS"in t?A({},t.FORBID_CONTENTS):We,Ae="FORBID_TAGS"in t?A({},t.FORBID_TAGS):{},Oe="FORBID_ATTR"in t?A({},t.FORBID_ATTR):{},He="USE_PROFILES"in t&&t.USE_PROFILES,Me=!1!==t.ALLOW_ARIA_ATTR,je=!1!==t.ALLOW_DATA_ATTR,Pe=t.ALLOW_UNKNOWN_PROTOCOLS||!1,De=t.SAFE_FOR_TEMPLATES||!1,Ie=t.WHOLE_DOCUMENT||!1,Ne=t.RETURN_DOM||!1,Ue=t.RETURN_DOM_FRAGMENT||!1,Re=t.RETURN_TRUSTED_TYPE||!1,Le=t.FORCE_BODY||!1,qe=!1!==t.SANITIZE_DOM,ze=!1!==t.KEEP_CONTENT,$e=t.IN_PLACE||!1,Ce=t.ALLOWED_URI_REGEXP||Ce,Ke=t.NAMESPACE||Xe,t.CUSTOM_ELEMENT_HANDLING&&ot(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ee.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ot(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ee.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ee.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),pe=pe=-1===tt.indexOf(t.PARSER_MEDIA_TYPE)?nt:t.PARSER_MEDIA_TYPE,ge="application/xhtml+xml"===pe?function(e){return e}:w,De&&(je=!1),Ue&&(Ne=!0),He&&(ke=A({},i(N)),Te=[],!0===He.html&&(A(ke,j),A(Te,U)),!0===He.svg&&(A(ke,P),A(Te,R),A(Te,z)),!0===He.svgFilters&&(A(ke,D),A(Te,R),A(Te,z)),!0===He.mathMl&&(A(ke,F),A(Te,q),A(Te,z))),t.ADD_TAGS&&(ke===xe&&(ke=O(ke)),A(ke,t.ADD_TAGS)),t.ADD_ATTR&&(Te===Se&&(Te=O(Te)),A(Te,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&A(Je,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&(Be===We&&(Be=O(Be)),A(Be,t.FORBID_CONTENTS)),ze&&(ke["#text"]=!0),Ie&&A(ke,["html","head","body"]),ke.table&&(A(ke,["tbody"]),delete Ae.tbody),d&&d(t),rt=t)},st=A({},["mi","mo","mn","ms","mtext"]),lt=A({},["foreignobject","desc","title","annotation-xml"]),ct=A({},["title","style","font","a","script"]),ut=A({},P);A(ut,D),A(ut,I);var dt=A({},F);A(dt,L);var ft=function(e){var t=ne(e);t&&t.tagName||(t={namespaceURI:Xe,tagName:"template"});var n=w(e.tagName),r=w(t.tagName);return e.namespaceURI===Ve?t.namespaceURI===Xe?"svg"===n:t.namespaceURI===Ze?"svg"===n&&("annotation-xml"===r||st[r]):Boolean(ut[n]):e.namespaceURI===Ze?t.namespaceURI===Xe?"math"===n:t.namespaceURI===Ve?"math"===n&&lt[r]:Boolean(dt[n]):e.namespaceURI===Xe&&!(t.namespaceURI===Ve&&!lt[r])&&!(t.namespaceURI===Ze&&!st[r])&&!dt[n]&&(ct[n]||!ut[n])},ht=function(e){b(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=oe}catch(t){e.remove()}}},pt=function(e,t){try{b(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){b(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Te[e])if(Ne||Ue)try{ht(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},gt=function(e){var t,n;if(Le)e="<remove></remove>"+e;else{var r=_(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===pe&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=ie?ie.createHTML(e):e;if(Ke===Xe)try{t=(new m).parseFromString(i,pe)}catch(e){}if(!t||!t.documentElement){t=se.createDocument(Ke,"template",null);try{t.documentElement.innerHTML=et?"":i}catch(e){}}var o=t.body||t.documentElement;return e&&n&&o.insertBefore(a.createTextNode(n),o.childNodes[0]||null),Ke===Xe?ue.call(t,Ie?"html":"body")[0]:Ie?t.documentElement:o},mt=function(e){return le.call(e.ownerDocument||e,e,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT,null,!1)},vt=function(e){return e instanceof g&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof p)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)},yt=function(t){return"object"===e(c)?t instanceof c:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},bt=function(e,t,n){he[e]&&v(he[e],(function(e){e.call(r,t,n,rt)}))},wt=function(e){var t;if(bt("beforeSanitizeElements",e,null),vt(e))return ht(e),!0;if(T(/[\u0080-\uFFFF]/,e.nodeName))return ht(e),!0;var n=ge(e.nodeName);if(bt("uponSanitizeElement",e,{tagName:n,allowedTags:ke}),e.hasChildNodes()&&!yt(e.firstElementChild)&&(!yt(e.content)||!yt(e.content.firstElementChild))&&T(/<[/\w]/g,e.innerHTML)&&T(/<[/\w]/g,e.textContent))return ht(e),!0;if("select"===n&&T(/<template/i,e.innerHTML))return ht(e),!0;if(!ke[n]||Ae[n]){if(!Ae[n]&&Ct(n)){if(Ee.tagNameCheck instanceof RegExp&&T(Ee.tagNameCheck,n))return!1;if(Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(n))return!1}if(ze&&!Be[n]){var i=ne(e)||e.parentNode,o=te(e)||e.childNodes;if(o&&i)for(var a=o.length-1;a>=0;--a)i.insertBefore(K(o[a],!0),ee(e))}return ht(e),!0}return e instanceof u&&!ft(e)?(ht(e),!0):"noscript"!==n&&"noembed"!==n||!T(/<\/no(script|embed)/i,e.innerHTML)?(De&&3===e.nodeType&&(t=e.textContent,t=C(t,me," "),t=C(t,ve," "),e.textContent!==t&&(b(r.removed,{element:e.cloneNode()}),e.textContent=t)),bt("afterSanitizeElements",e,null),!1):(ht(e),!0)},_t=function(e,t,n){if(qe&&("id"===t||"name"===t)&&(n in a||n in it))return!1;if(je&&!Oe[t]&&T(ye,t));else if(Me&&T(be,t));else if(!Te[t]||Oe[t]){if(!(Ct(e)&&(Ee.tagNameCheck instanceof RegExp&&T(Ee.tagNameCheck,e)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(e))&&(Ee.attributeNameCheck instanceof RegExp&&T(Ee.attributeNameCheck,t)||Ee.attributeNameCheck instanceof Function&&Ee.attributeNameCheck(t))||"is"===t&&Ee.allowCustomizedBuiltInElements&&(Ee.tagNameCheck instanceof RegExp&&T(Ee.tagNameCheck,n)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(n))))return!1}else if(Je[t]);else if(T(Ce,C(n,_e,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==k(n,"data:")||!Ye[e])if(Pe&&!T(we,C(n,_e,"")));else if(n)return!1;return!0},Ct=function(e){return e.indexOf("-")>0},kt=function(e){var t,n,i,o;bt("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te};for(o=a.length;o--;){var l=t=a[o],c=l.name,u=l.namespaceURI;if(n="value"===c?t.value:x(t.value),i=ge(c),s.attrName=i,s.attrValue=n,s.keepAttr=!0,s.forceKeepAttr=void 0,bt("uponSanitizeAttribute",e,s),n=s.attrValue,!s.forceKeepAttr&&(pt(c,e),s.keepAttr))if(T(/\/>/i,n))pt(c,e);else{De&&(n=C(n,me," "),n=C(n,ve," "));var d=ge(e.nodeName);if(_t(d,i,n))try{u?e.setAttributeNS(u,c,n):e.setAttribute(c,n),y(r.removed)}catch(e){}}}bt("afterSanitizeAttributes",e,null)}},xt=function e(t){var n,r=mt(t);for(bt("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)bt("uponSanitizeShadowNode",n,null),wt(n)||(n.content instanceof s&&e(n.content),kt(n));bt("afterSanitizeShadowDOM",t,null)};return r.sanitize=function(t,i){var a,l,u,d,f;if((et=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!yt(t)){if("function"!=typeof t.toString)throw S("toString is not a function");if("string"!=typeof(t=t.toString()))throw S("dirty is not a string, aborting")}if(!r.isSupported){if("object"===e(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof t)return n.toStaticHTML(t);if(yt(t))return n.toStaticHTML(t.outerHTML)}return t}if(Fe||at(i),r.removed=[],"string"==typeof t&&($e=!1),$e){if(t.nodeName){var h=ge(t.nodeName);if(!ke[h]||Ae[h])throw S("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof c)1===(l=(a=gt("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===l.nodeName||"HTML"===l.nodeName?a=l:a.appendChild(l);else{if(!Ne&&!De&&!Ie&&-1===t.indexOf("<"))return ie&&Re?ie.createHTML(t):t;if(!(a=gt(t)))return Ne?null:Re?oe:""}a&&Le&&ht(a.firstChild);for(var p=mt($e?t:a);u=p.nextNode();)3===u.nodeType&&u===d||wt(u)||(u.content instanceof s&&xt(u.content),kt(u),d=u);if(d=null,$e)return t;if(Ne){if(Ue)for(f=ce.call(a.ownerDocument);a.firstChild;)f.appendChild(a.firstChild);else f=a;return Te.shadowroot&&(f=de.call(o,f,!0)),f}var g=Ie?a.outerHTML:a.innerHTML;return Ie&&ke["!doctype"]&&a.ownerDocument&&a.ownerDocument.doctype&&a.ownerDocument.doctype.name&&T(Q,a.ownerDocument.doctype.name)&&(g="<!DOCTYPE "+a.ownerDocument.doctype.name+">\n"+g),De&&(g=C(g,me," "),g=C(g,ve," ")),ie&&Re?ie.createHTML(g):g},r.setConfig=function(e){at(e),Fe=!0},r.clearConfig=function(){rt=null,Fe=!1},r.isValidAttribute=function(e,t,n){rt||at({});var r=ge(e),i=ge(t);return _t(r,i,n)},r.addHook=function(e,t){"function"==typeof t&&(he[e]=he[e]||[],b(he[e],t))},r.removeHook=function(e){if(he[e])return y(he[e])},r.removeHooks=function(e){he[e]&&(he[e]=[])},r.removeAllHooks=function(){he={}},r}()}()},729:e=>{var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var l,c,u=this._events[s],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,o),!0;case 6:return u.fn.call(u.context,t,r,i,o,a),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var f,h=u.length;for(c=0;c<h;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,r);break;case 4:u[c].fn.call(u[c].context,t,r,i);break;default:if(!l)for(f=1,l=new Array(d-1);f<d;f++)l[f-1]=arguments[f];u[c].fn.apply(u[c].context,l)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var l=0,c=[],u=s.length;l<u;l++)(s[l].fn!==t||i&&!s[l].once||r&&s[l].context!==r)&&c.push(s[l]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},717:e=>{"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},824:e=>{var t=1e3,n=60*t,r=60*n,i=24*r;function o(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,a){a=a||{};var s=typeof e;if("string"===s&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(o){var a=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return 6048e5*a;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===s&&isFinite(e))return a.long?function(e){var a=Math.abs(e);return a>=i?o(e,a,i,"day"):a>=r?o(e,a,r,"hour"):a>=n?o(e,a,n,"minute"):a>=t?o(e,a,t,"second"):e+" ms"}(e):function(e){var o=Math.abs(e);return o>=i?Math.round(e/i)+"d":o>=r?Math.round(e/r)+"h":o>=n?Math.round(e/n)+"m":o>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},520:(e,t,n)=>{var r=n(155),i="win32"===r.platform,o=n(539);function a(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];i&&"."!==i&&(".."===i?n.length&&".."!==n[n.length-1]?n.pop():t&&n.push(".."):n.push(i))}return n}function s(e){for(var t=e.length-1,n=0;n<=t&&!e[n];n++);for(var r=t;r>=0&&!e[r];r--);return 0===n&&r===t?e:n>r?[]:e.slice(n,r+1)}var l=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,c=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,u={};function d(e){var t=l.exec(e),n=(t[1]||"")+(t[2]||""),r=t[3]||"",i=c.exec(r);return[n,i[1],i[2],i[3]]}function f(e){var t=l.exec(e),n=t[1]||"",r=!!n&&":"!==n[1];return{device:n,isUnc:r,isAbsolute:r||!!t[2],tail:t[3]}}function h(e){return"\\\\"+e.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}u.resolve=function(){for(var e="",t="",n=!1,i=arguments.length-1;i>=-1;i--){var s;if(i>=0?s=arguments[i]:e?(s=r.env["="+e])&&s.substr(0,3).toLowerCase()===e.toLowerCase()+"\\"||(s=e+"\\"):s=r.cwd(),!o.isString(s))throw new TypeError("Arguments to path.resolve must be strings");if(s){var l=f(s),c=l.device,u=l.isUnc,d=l.isAbsolute,p=l.tail;if((!c||!e||c.toLowerCase()===e.toLowerCase())&&(e||(e=c),n||(t=p+"\\"+t,n=d),e&&n))break}}return u&&(e=h(e)),e+(n?"\\":"")+(t=a(t.split(/[\\\/]+/),!n).join("\\"))||"."},u.normalize=function(e){var t=f(e),n=t.device,r=t.isUnc,i=t.isAbsolute,o=t.tail,s=/[\\\/]$/.test(o);return(o=a(o.split(/[\\\/]+/),!i).join("\\"))||i||(o="."),o&&s&&(o+="\\"),r&&(n=h(n)),n+(i?"\\":"")+o},u.isAbsolute=function(e){return f(e).isAbsolute},u.join=function(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(!o.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&e.push(n)}var r=e.join("\\");return/^[\\\/]{2}[^\\\/]/.test(e[0])||(r=r.replace(/^[\\\/]{2,}/,"\\")),u.normalize(r)},u.relative=function(e,t){e=u.resolve(e),t=u.resolve(t);for(var n=e.toLowerCase(),r=t.toLowerCase(),i=s(t.split("\\")),o=s(n.split("\\")),a=s(r.split("\\")),l=Math.min(o.length,a.length),c=l,d=0;d<l;d++)if(o[d]!==a[d]){c=d;break}if(0==c)return t;var f=[];for(d=c;d<o.length;d++)f.push("..");return(f=f.concat(i.slice(c))).join("\\")},u._makeLong=function(e){if(!o.isString(e))return e;if(!e)return"";var t=u.resolve(e);return/^[a-zA-Z]\:\\/.test(t)?"\\\\?\\"+t:/^\\\\[^?.]/.test(t)?"\\\\?\\UNC\\"+t.substring(2):e},u.dirname=function(e){var t=d(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},u.basename=function(e,t){var n=d(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},u.extname=function(e){return d(e)[3]},u.format=function(e){if(!o.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!o.isString(t))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);var n=e.dir,r=e.base||"";return n?n[n.length-1]===u.sep?n+r:n+u.sep+r:r},u.parse=function(e){if(!o.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=d(e);if(!t||4!==t.length)throw new TypeError("Invalid path '"+e+"'");return{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},u.sep="\\",u.delimiter=";";var p=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,g={};function m(e){return p.exec(e).slice(1)}g.resolve=function(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var i=n>=0?arguments[n]:r.cwd();if(!o.isString(i))throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,t="/"===i[0])}return(t?"/":"")+(e=a(e.split("/"),!t).join("/"))||"."},g.normalize=function(e){var t=g.isAbsolute(e),n=e&&"/"===e[e.length-1];return(e=a(e.split("/"),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},g.isAbsolute=function(e){return"/"===e.charAt(0)},g.join=function(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];if(!o.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&(e+=e?"/"+n:n)}return g.normalize(e)},g.relative=function(e,t){e=g.resolve(e).substr(1),t=g.resolve(t).substr(1);for(var n=s(e.split("/")),r=s(t.split("/")),i=Math.min(n.length,r.length),o=i,a=0;a<i;a++)if(n[a]!==r[a]){o=a;break}var l=[];for(a=o;a<n.length;a++)l.push("..");return(l=l.concat(r.slice(o))).join("/")},g._makeLong=function(e){return e},g.dirname=function(e){var t=m(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},g.basename=function(e,t){var n=m(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},g.extname=function(e){return m(e)[3]},g.format=function(e){if(!o.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!o.isString(t))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);return(e.dir?e.dir+g.sep:"")+(e.base||"")},g.parse=function(e){if(!o.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=m(e);if(!t||4!==t.length)throw new TypeError("Invalid path '"+e+"'");return t[1]=t[1]||"",t[2]=t[2]||"",t[3]=t[3]||"",{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},g.sep="/",g.delimiter=":",e.exports=i?u:g,e.exports.posix=g,e.exports.win32=u},155:e=>{var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var s,l=[],c=!1,u=-1;function d(){c&&s&&(c=!1,s.length?l=s.concat(l):u=-1,l.length&&f())}function f(){if(!c){var e=a(d);c=!0;for(var t=l.length;t;){for(s=l,l=[];++u<t;)s&&s[u].run();u=-1,t=l.length}s=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new h(e,t)),1!==l.length||c||a(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},539:(e,t,n)=>{var r=n(155),i=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),l=r[n];n<o;l=r[++n])g(l)||!w(l)?a+=" "+l:a+=" "+s(l);return a},t.deprecate=function(e,i){if(y(n.g.process))return function(){return t.deprecate(e,i).apply(this,arguments)};if(!0===r.noDeprecation)return e;var o=!1;return function(){if(!o){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),o=!0}return e.apply(this,arguments)}};var o,a={};function s(e,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&t._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=l),u(r,e,r.depth)}function l(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function c(e,t){return e}function u(e,n,r){if(e.customInspect&&n&&k(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return v(i)||(i=u(e,i,r)),i}var o=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(v(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return m(t)?e.stylize(""+t,"number"):p(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}(e,n);if(o)return o;var a=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),C(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return d(n);if(0===a.length){if(k(n)){var l=n.name?": "+n.name:"";return e.stylize("[Function"+l+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return e.stylize(Date.prototype.toString.call(n),"date");if(C(n))return d(n)}var c,w="",x=!1,T=["{","}"];return h(n)&&(x=!0,T=["[","]"]),k(n)&&(w=" [Function"+(n.name?": "+n.name:"")+"]"),b(n)&&(w=" "+RegExp.prototype.toString.call(n)),_(n)&&(w=" "+Date.prototype.toUTCString.call(n)),C(n)&&(w=" "+d(n)),0!==a.length||x&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=x?function(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)A(t,String(a))?o.push(f(e,t,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(f(e,t,n,r,i,!0))})),o}(e,n,r,s,a):a.map((function(t){return f(e,n,r,s,t,x)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(c,w,T)):T[0]+w+T[1]}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,i,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),A(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(l.value)<0?(s=g(n)?u(e,l.value,null):u(e,l.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),y(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function h(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function g(e){return null===e}function m(e){return"number"==typeof e}function v(e){return"string"==typeof e}function y(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===x(e)}function w(e){return"object"==typeof e&&null!==e}function _(e){return w(e)&&"[object Date]"===x(e)}function C(e){return w(e)&&("[object Error]"===x(e)||e instanceof Error)}function k(e){return"function"==typeof e}function x(e){return Object.prototype.toString.call(e)}function T(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(y(o)&&(o=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(o)){var n=r.pid;a[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else a[e]=function(){};return a[e]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=h,t.isBoolean=p,t.isNull=g,t.isNullOrUndefined=function(e){return null==e},t.isNumber=m,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=b,t.isObject=w,t.isDate=_,t.isError=C,t.isFunction=k,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(384);var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(){var e=new Date,t=[T(e.getHours()),T(e.getMinutes()),T(e.getSeconds())].join(":");return[e.getDate(),S[e.getMonth()],t].join(" ")}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",E(),t.format.apply(t,arguments))},t.inherits=n(717),t._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}},i={};function o(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return r[e].call(n.exports,n,n.exports,o),n.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{o.r(a),o.d(a,{LSPluginUser:()=>wr,setupPluginUserInstance:()=>_r});var r=o(520);o(856);const i=function(e,t){return e===t||e!=e&&t!=t},s=function(e,t){for(var n=e.length;n--;)if(i(e[n][0],t))return n;return-1};var l=Array.prototype.splice;function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=function(){this.__data__=[],this.size=0},c.prototype.delete=function(e){var t=this.__data__,n=s(t,e);return!(n<0||(n==t.length-1?t.pop():l.call(t,n,1),--this.size,0))},c.prototype.get=function(e){var t=this.__data__,n=s(t,e);return n<0?void 0:t[n][1]},c.prototype.has=function(e){return s(this.__data__,e)>-1},c.prototype.set=function(e,t){var n=this.__data__,r=s(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};const u=c,d="object"==typeof e&&e&&e.Object===Object&&e;var f="object"==typeof self&&self&&self.Object===Object&&self;const h=d||f||Function("return this")(),p=h.Symbol;var g=Object.prototype,m=g.hasOwnProperty,v=g.toString,y=p?p.toStringTag:void 0,b=Object.prototype.toString,w=p?p.toStringTag:void 0;const _=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":w&&w in Object(e)?function(e){var t=m.call(e,y),n=e[y];try{e[y]=void 0;var r=!0}catch(e){}var i=v.call(e);return r&&(t?e[y]=n:delete e[y]),i}(e):function(e){return b.call(e)}(e)},C=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},k=function(e){if(!C(e))return!1;var t=_(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},x=h["__core-js_shared__"];var T,S=(T=/[^.]+$/.exec(x&&x.keys&&x.keys.IE_PROTO||""))?"Symbol(src)_1."+T:"",E=Function.prototype.toString;const A=function(e){if(null!=e){try{return E.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var O=/^\[object .+?Constructor\]$/,M=Function.prototype,j=Object.prototype,P=M.toString,D=j.hasOwnProperty,I=RegExp("^"+P.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const F=function(e){return!(!C(e)||function(e){return!!S&&S in e}(e))&&(k(e)?I:O).test(A(e))},L=function(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return F(n)?n:void 0},N=L(h,"Map"),U=L(Object,"create");var R=Object.prototype.hasOwnProperty,q=Object.prototype.hasOwnProperty;function z(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}z.prototype.clear=function(){this.__data__=U?U(null):{},this.size=0},z.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},z.prototype.get=function(e){var t=this.__data__;if(U){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return R.call(t,e)?t[e]:void 0},z.prototype.has=function(e){var t=this.__data__;return U?void 0!==t[e]:q.call(t,e)},z.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=U&&void 0===t?"__lodash_hash_undefined__":t,this};const $=z,H=function(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map};function B(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}B.prototype.clear=function(){this.size=0,this.__data__={hash:new $,map:new(N||u),string:new $}},B.prototype.delete=function(e){var t=H(this,e).delete(e);return this.size-=t?1:0,t},B.prototype.get=function(e){return H(this,e).get(e)},B.prototype.has=function(e){return H(this,e).has(e)},B.prototype.set=function(e,t){var n=H(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};const W=B;function Y(e){var t=this.__data__=new u(e);this.size=t.size}Y.prototype.clear=function(){this.__data__=new u,this.size=0},Y.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Y.prototype.get=function(e){return this.__data__.get(e)},Y.prototype.has=function(e){return this.__data__.has(e)},Y.prototype.set=function(e,t){var n=this.__data__;if(n instanceof u){var r=n.__data__;if(!N||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new W(r)}return n.set(e,t),this.size=n.size,this};const G=Y,J=function(){try{var e=L(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Q=function(e,t,n){"__proto__"==t&&J?J(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Z=function(e,t,n){(void 0!==n&&!i(e[t],n)||void 0===n&&!(t in e))&&Q(e,t,n)},V=function(e,t,n){for(var r=-1,i=Object(e),o=n(e),a=o.length;a--;){var s=o[++r];if(!1===t(i[s],s,i))break}return e};var X=n&&!n.nodeType&&n,K=X&&t&&!t.nodeType&&t,ee=K&&K.exports===X?h.Buffer:void 0,te=ee?ee.allocUnsafe:void 0;const ne=h.Uint8Array,re=function(e,t){var n=t?function(e){var t=new e.constructor(e.byteLength);return new ne(t).set(new ne(e)),t}(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var ie=Object.create;const oe=function(){function e(){}return function(t){if(!C(t))return{};if(ie)return ie(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),ae=function(e,t){return function(n){return e(t(n))}},se=ae(Object.getPrototypeOf,Object);var le=Object.prototype;const ce=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||le)},ue=function(e){return null!=e&&"object"==typeof e},de=function(e){return ue(e)&&"[object Arguments]"==_(e)};var fe=Object.prototype,he=fe.hasOwnProperty,pe=fe.propertyIsEnumerable;const ge=de(function(){return arguments}())?de:function(e){return ue(e)&&he.call(e,"callee")&&!pe.call(e,"callee")},me=Array.isArray,ve=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},ye=function(e){return null!=e&&ve(e.length)&&!k(e)};var be=n&&!n.nodeType&&n,we=be&&t&&!t.nodeType&&t,_e=we&&we.exports===be?h.Buffer:void 0;const Ce=(_e?_e.isBuffer:void 0)||function(){return!1};var ke=Function.prototype,xe=Object.prototype,Te=ke.toString,Se=xe.hasOwnProperty,Ee=Te.call(Object),Ae={};Ae["[object Float32Array]"]=Ae["[object Float64Array]"]=Ae["[object Int8Array]"]=Ae["[object Int16Array]"]=Ae["[object Int32Array]"]=Ae["[object Uint8Array]"]=Ae["[object Uint8ClampedArray]"]=Ae["[object Uint16Array]"]=Ae["[object Uint32Array]"]=!0,Ae["[object Arguments]"]=Ae["[object Array]"]=Ae["[object ArrayBuffer]"]=Ae["[object Boolean]"]=Ae["[object DataView]"]=Ae["[object Date]"]=Ae["[object Error]"]=Ae["[object Function]"]=Ae["[object Map]"]=Ae["[object Number]"]=Ae["[object Object]"]=Ae["[object RegExp]"]=Ae["[object Set]"]=Ae["[object String]"]=Ae["[object WeakMap]"]=!1;var Oe=n&&!n.nodeType&&n,Me=Oe&&t&&!t.nodeType&&t,je=Me&&Me.exports===Oe&&d.process,Pe=function(){try{return Me&&Me.require&&Me.require("util").types||je&&je.binding&&je.binding("util")}catch(e){}}(),De=Pe&&Pe.isTypedArray;const Ie=De?function(e){return function(t){return e(t)}}(De):function(e){return ue(e)&&ve(e.length)&&!!Ae[_(e)]},Fe=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]};var Le=Object.prototype.hasOwnProperty;const Ne=function(e,t,n){var r=e[t];Le.call(e,t)&&i(r,n)&&(void 0!==n||t in e)||Q(e,t,n)};var Ue=/^(?:0|[1-9]\d*)$/;const Re=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Ue.test(e))&&e>-1&&e%1==0&&e<t};var qe=Object.prototype.hasOwnProperty;const ze=function(e,t){var n=me(e),r=!n&&ge(e),i=!n&&!r&&Ce(e),o=!n&&!r&&!i&&Ie(e),a=n||r||i||o,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=s.length;for(var c in e)!t&&!qe.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Re(c,l))||s.push(c);return s};var $e=Object.prototype.hasOwnProperty;const He=function(e){if(!C(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=ce(e),n=[];for(var r in e)("constructor"!=r||!t&&$e.call(e,r))&&n.push(r);return n},Be=function(e){return ye(e)?ze(e,!0):He(e)},We=function(e){return function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],l=r?r(n[s],e[s],s,n,e):void 0;void 0===l&&(l=e[s]),i?Q(n,s,l):Ne(n,s,l)}return n}(e,Be(e))},Ye=function(e,t,n,r,i,o,a){var s=Fe(e,n),l=Fe(t,n),c=a.get(l);if(c)Z(e,n,c);else{var u=o?o(s,l,n+"",e,t,a):void 0,d=void 0===u;if(d){var f=me(l),h=!f&&Ce(l),p=!f&&!h&&Ie(l);u=l,f||h||p?me(s)?u=s:function(e){return ue(e)&&ye(e)}(s)?u=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}(s):h?(d=!1,u=function(e,t){if(t)return e.slice();var n=e.length,r=te?te(n):new e.constructor(n);return e.copy(r),r}(l,!0)):p?(d=!1,u=re(l,!0)):u=[]:function(e){if(!ue(e)||"[object Object]"!=_(e))return!1;var t=se(e);if(null===t)return!0;var n=Se.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Te.call(n)==Ee}(l)||ge(l)?(u=s,ge(s)?u=We(s):C(s)&&!k(s)||(u=function(e){return"function"!=typeof e.constructor||ce(e)?{}:oe(se(e))}(l))):d=!1}d&&(a.set(l,u),i(u,l,r,o,a),a.delete(l)),Z(e,n,u)}},Ge=function e(t,n,r,i,o){t!==n&&V(n,(function(a,s){if(o||(o=new G),C(a))Ye(t,n,s,r,e,i,o);else{var l=i?i(Fe(t,s),a,s+"",t,n,o):void 0;void 0===l&&(l=a),Z(t,s,l)}}),Be)},Je=function(e){return e},Qe=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)};var Ze=Math.max;const Ve=function(e){return function(){return e}},Xe=J?function(e,t){return J(e,"toString",{configurable:!0,enumerable:!1,value:Ve(t),writable:!0})}:Je;var Ke=Date.now;const et=function(e){var t=0,n=0;return function(){var r=Ke(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Xe),tt=function(e,t){return et(function(e,t,n){return t=Ze(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=Ze(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(a),Qe(e,this,s)}}(e,t,Je),e+"")},nt=function(e,t,n){if(!C(n))return!1;var r=typeof t;return!!("number"==r?ye(n)&&Re(t,n.length):"string"==r&&t in n)&&i(n[t],e)},rt=function(e){return tt((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&nt(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r)}return t}))}((function(e,t,n){Ge(e,t,n)}));var it=function(){return it=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},it.apply(this,arguments)};function ot(e){return e.toLowerCase()}Object.create,Object.create;var at=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],st=/[^A-Z0-9]+/gi;function lt(e,t,n){return t instanceof RegExp?e.replace(t,n):t.reduce((function(e,t){return e.replace(t,n)}),e)}var ct=o(729),ut=o.n(ct);function dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ft="win32"===navigator.platform.toLowerCase()?r.win32:r.posix,ht=function(e,t){return void 0===t&&(t={}),function(e,t){return void 0===t&&(t={}),function(e,t){void 0===t&&(t={});for(var n=t.splitRegexp,r=void 0===n?at:n,i=t.stripRegexp,o=void 0===i?st:i,a=t.transform,s=void 0===a?ot:a,l=t.delimiter,c=void 0===l?" ":l,u=lt(lt(e,r,"$1\0$2"),o,"\0"),d=0,f=u.length;"\0"===u.charAt(d);)d++;for(;"\0"===u.charAt(f-1);)f--;return u.slice(d,f).split("\0").map(s).join(c)}(e,it({delimiter:"."},t))}(e,it({delimiter:"_"},t))},pt=rt;class gt extends(ut()){constructor(e,t){super(),dt(this,"_tag",void 0),dt(this,"_opts",void 0),dt(this,"_logs",[]),this._tag=e,this._opts=t}write(e,t,n){var r;null!=t&&t.length&&!0===t[t.length-1]&&(n=!0,t.pop());const i=t.reduce(((e,t)=>(t&&t instanceof Error?e+=`${t.message} ${t.stack}`:e+=t.toString(),e)),`[${this._tag}][${(new Date).toLocaleTimeString()}] `);var o;this._logs.push([e,i]),(n||null!==(r=this._opts)&&void 0!==r&&r.console)&&(null===(o=console)||void 0===o||o["ERROR"===e?"error":"debug"](`${e}: ${i}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...e){this.write("INFO",e)}error(...e){this.write("ERROR",e)}warn(...e){this.write("WARN",e)}setTag(e){this._tag=e}toJSON(){return this._logs}}function mt(e,t){let n,r,i=!1;const o=t=>n=>{e&&clearTimeout(e),t(n),i=!0},a=new Promise(((i,a)=>{n=o(i),r=o(a),e&&(e=setTimeout((()=>r(new Error(`[deferred timeout] ${t}`))),e))}));return{created:Date.now(),setTag:e=>t=e,resolve:n,reject:r,promise:a,get settled(){return i}}}const vt=new Map;window.__injectedUIEffects=vt;var yt=o(227),bt=o.n(yt);function wt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const _t="application/x-postmate-v1+json";let Ct=0;const kt={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},xt=(e,t)=>!("string"==typeof t&&e.origin!==t||!e.data||"object"==typeof e.data&&!("postmate"in e.data)||e.data.type!==_t||!kt[e.data.postmate]);class Tt{constructor(e){wt(this,"parent",void 0),wt(this,"frame",void 0),wt(this,"child",void 0),wt(this,"events",{}),wt(this,"childOrigin",void 0),wt(this,"listener",void 0),this.parent=e.parent,this.frame=e.frame,this.child=e.child,this.childOrigin=e.childOrigin,this.listener=e=>{if(!xt(e,this.childOrigin))return!1;const{data:t,name:n}=((e||{}).data||{}).value||{};"emit"===e.data.postmate&&n in this.events&&this.events[n].forEach((e=>{e.call(this,t)}))},this.parent.addEventListener("message",this.listener,!1)}get(e,...t){return new Promise((n=>{const r=++Ct,i=e=>{e.data.uid===r&&"reply"===e.data.postmate&&(this.parent.removeEventListener("message",i,!1),n(e.data.value))};this.parent.addEventListener("message",i,!1),this.child.postMessage({postmate:"request",type:_t,property:e,args:t,uid:r},this.childOrigin)}))}call(e,t){this.child.postMessage({postmate:"call",type:_t,property:e,data:t},this.childOrigin)}on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class St{constructor(e){wt(this,"model",void 0),wt(this,"parent",void 0),wt(this,"parentOrigin",void 0),wt(this,"child",void 0),this.model=e.model,this.parent=e.parent,this.parentOrigin=e.parentOrigin,this.child=e.child,this.child.addEventListener("message",(e=>{if(!xt(e,this.parentOrigin))return;const{property:t,uid:n,data:r,args:i}=e.data;"call"!==e.data.postmate?((e,t,n)=>{const r="function"==typeof e[t]?e[t].apply(null,n):e[t];return Promise.resolve(r)})(this.model,t,i).then((r=>{e.source.postMessage({property:t,postmate:"reply",type:_t,uid:n,value:r},e.origin)})):t in this.model&&"function"==typeof this.model[t]&&this.model[t](r)}))}emit(e,t){this.parent.postMessage({postmate:"emit",type:_t,value:{name:e,data:t}},this.parentOrigin)}}class Et{constructor(e){wt(this,"container",void 0),wt(this,"parent",void 0),wt(this,"frame",void 0),wt(this,"child",void 0),wt(this,"childOrigin",void 0),wt(this,"url",void 0),wt(this,"model",void 0),this.container=e.container,this.url=e.url,this.parent=window,this.frame=document.createElement("iframe"),e.id&&(this.frame.id=e.id),e.name&&(this.frame.name=e.name),this.frame.classList.add.apply(this.frame.classList,e.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=e.model||{}}sendHandshake(e){const t=(e=>{const t=document.createElement("a");t.href=e;const n=t.protocol.length>4?t.protocol:window.location.protocol,r=t.host.length?"80"===t.port||"443"===t.port?t.hostname:t.host:window.location.host;return t.origin||`${n}//${r}`})(e=e||this.url);let n,r=0;return new Promise(((i,o)=>{const a=e=>!!xt(e,t)&&("handshake-reply"===e.data.postmate?(clearInterval(n),this.parent.removeEventListener("message",a,!1),this.childOrigin=e.origin,i(new Tt(this))):o("Failed handshake"));this.parent.addEventListener("message",a,!1);const s=()=>{r++,this.child.postMessage({postmate:"handshake",type:_t,model:this.model},t),5===r&&clearInterval(n)};this.frame.addEventListener("load",(()=>{s(),n=setInterval(s,500)})),this.frame.src=e}))}destroy(){this.frame.parentNode.removeChild(this.frame)}}wt(Et,"debug",!1),wt(Et,"Model",void 0);class At{constructor(e){wt(this,"child",void 0),wt(this,"model",void 0),wt(this,"parent",void 0),wt(this,"parentOrigin",void 0),this.child=window,this.model=e,this.parent=this.child.parent}sendHandshakeReply(){return new Promise(((e,t)=>{const n=r=>{if(r.data.postmate){if("handshake"===r.data.postmate){this.child.removeEventListener("message",n,!1),r.source.postMessage({postmate:"handshake-reply",type:_t},r.origin),this.parentOrigin=r.origin;const t=r.data.model;return t&&Object.keys(t).forEach((e=>{this.model[e]=t[e]})),e(new St(this))}return t("Handshake Reply Failed")}};this.child.addEventListener("message",n,!1)}))}}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const{importHTML:Mt,createSandboxContainer:jt}=window.QSandbox||{};function Pt(e,t){return e.startsWith("http")?fetch(e,t):(e=e.replace("file://",""),new Promise((async(t,n)=>{try{const n=await window.apis.doAction(["readFile",e]);t({text:()=>n})}catch(e){console.error(e),n(e)}})))}class Dt extends(ut()){constructor(e){super(),Ot(this,"_pluginLocal",void 0),Ot(this,"_frame",void 0),Ot(this,"_root",void 0),Ot(this,"_loaded",!1),Ot(this,"_unmountFns",[]),this._pluginLocal=e,e._dispose((()=>{this._unmount()}))}async load(){const{name:e,entry:t}=this._pluginLocal.options;if(this.loaded||!t)return;const{template:n,execScripts:r}=await Mt(t,{fetch:Pt});this._mount(n,document.body);const i=jt(e,{elementGetter:()=>{var e;return null===(e=this._root)||void 0===e?void 0:e.firstChild}}).instance.proxy;i.__shadow_mode__=!0,i.LSPluginLocal=this._pluginLocal,i.LSPluginShadow=this,i.LSPluginUser=i.logseq=new wr(this._pluginLocal.toJSON(),this._pluginLocal.caller);const o=await r(i,!0);this._unmountFns.push(o.unmount),this._loaded=!0}_mount(e,t){const n=this._frame=document.createElement("div");n.classList.add("lsp-shadow-sandbox"),n.id=this._pluginLocal.id,this._root=n.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${e}</div>`,t.appendChild(n),this.emit("mounted")}_unmount(){for(const e of this._unmountFns)e&&e.call(null)}destroy(){var e,t;null===(e=this.frame)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var e;return null===(e=this._root)||void 0===e?void 0:e.firstChild}get frame(){return this._frame}}function It(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ft=bt()("LSPlugin:caller"),Lt="#await#response#",Nt="#lspmsg#error#",Ut=e=>`#lspmsg#${e}`;class Rt extends(ut()){constructor(e){super(),It(this,"_pluginLocal",void 0),It(this,"_connected",!1),It(this,"_parent",void 0),It(this,"_child",void 0),It(this,"_shadow",void 0),It(this,"_status",void 0),It(this,"_userModel",{}),It(this,"_call",void 0),It(this,"_callUserModel",void 0),It(this,"_debugTag",""),this._pluginLocal=e,e&&(this._debugTag=e.debugTag)}async connectToChild(){if(this._connected)return;const{shadow:e}=this._pluginLocal;e?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(e={}){if(this._connected)return;const t=this,n=null!=this._pluginLocal;let r=0,i=0;const o=new Map,a=mt(6e4),s=this._extendUserModel({"#lspmsg#ready#":async e=>{s[Ut(null==e?void 0:e.pid)]=({type:e,payload:n})=>{Ft(`[host (_call) -> *user] ${this._debugTag}`,e,n),t.emit(e,n)},await a.resolve()},"#lspmsg#beforeunload#":async e=>{const n=mt(1e4);t.emit("beforeunload",Object.assign({actor:n},e)),await n.promise},"#lspmsg#settings#":async({type:e,payload:n})=>{t.emit("settings:changed",n)},"#lspmsg#":async({ns:e,type:n,payload:r})=>{Ft(`[host (async) -> *user] ${this._debugTag} ns=${e} type=${n}`,r),e&&e.startsWith("hook")?t.emit(`${e}:${n}`,r):t.emit(n,r)},"#lspmsg#reply#":({_sync:e,result:t})=>{if(Ft(`[sync host -> *user] #${e}`,t),o.has(e)){const n=o.get(e);n&&(null!=t&&t.hasOwnProperty(Nt)?n.reject(t[Nt]):n.resolve(t),o.delete(e))}},...e});var l;if(n)return await a.promise,JSON.parse(JSON.stringify(null===(l=this._pluginLocal)||void 0===l?void 0:l.toJSON()));const c=new At(s).sendHandshakeReply();return this._status="pending",await c.then((e=>{this._child=e,this._connected=!0,this._call=async(t,n={},r)=>{if(r){const e=++i;o.set(e,r),n._sync=e,r.setTag(`async call #${e}`),Ft(`async call #${e}`)}return e.emit(Ut(s.baseInfo.id),{type:t,payload:n}),null==r?void 0:r.promise},this._callUserModel=async(e,t)=>{try{s[e](t)}catch(t){Ft(`[model method] #${e} not existed`)}},r=setInterval((()=>{if(o.size>100)for(const[e,t]of o)t.settled&&o.delete(e)}),18e5)})).finally((()=>{this._status=void 0})),await a.promise,s.baseInfo}async call(e,t={}){var n;return null===(n=this._call)||void 0===n?void 0:n.call(this,e,t)}async callAsync(e,t={}){var n;const r=mt(1e4);return null===(n=this._call)||void 0===n?void 0:n.call(this,e,t,r)}async callUserModel(e,...t){var n;return null===(n=this._callUserModel)||void 0===n?void 0:n.apply(this,[e,...t])}async callUserModelAsync(e,...t){var n;return e=`${Lt}${e}`,null===(n=this._callUserModel)||void 0===n?void 0:n.apply(this,[e,...t])}async _setupIframeSandbox(){const e=this._pluginLocal,t=e.id,n=`${t}_lsp_main`,r=new URL(e.options.entry);r.searchParams.set("__v__",e.options.version);const i=document.querySelector(`#${n}`);i&&i.parentElement.removeChild(i);const o=document.createElement("div");o.classList.add("lsp-iframe-sandbox-container"),o.id=n,o.dataset.pid=t;try{var a;const e=null===(a=await this._pluginLocal._loadLayoutsData())||void 0===a?void 0:a.$$0;if(e){o.dataset.inited_layout="true";let{width:t,height:n,left:r,top:i,vw:a,vh:s}=e;r=Math.max(r,0),r="number"==typeof a?`${Math.min(100*r/a,99)}%`:`${r}px`,i=Math.max(i,45),i="number"==typeof s?`${Math.min(100*i/s,99)}%`:`${i}px`,Object.assign(o.style,{width:t+"px",height:n+"px",left:r,top:i})}}catch(e){console.error("[Restore Layout Error]",e)}document.body.appendChild(o);const s=new Et({id:t+"_iframe",container:o,url:r.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(e.toJSON()))}});let l,c=s.sendHandshake();return this._status="pending",new Promise(((t,n)=>{l=setTimeout((()=>{n(new Error("handshake Timeout")),s.destroy()}),4e3),c.then((n=>{this._parent=n,this._connected=!0,this.emit("connected"),n.on(Ut(e.id),(({type:e,payload:t})=>{var n,r;Ft("[user -> *host] ",e,t),null===(n=this._pluginLocal)||void 0===n||n.emit(e,t||{}),null===(r=this._pluginLocal)||void 0===r||r.caller.emit(e,t||{})})),this._call=async(...t)=>{await n.call(Ut(e.id),{type:t[0],payload:Object.assign(t[1]||{},{$$pid:e.id})})},this._callUserModel=async(e,...t)=>{if(e.startsWith(Lt))return await n.get(e.replace(Lt,""),...t);n.call(e,null==t?void 0:t[0])},t(null)})).catch((e=>{n(e)})).finally((()=>{clearTimeout(l)}))})).catch((e=>{throw Ft("[iframe sandbox] error",e),e})).finally((()=>{this._status=void 0}))}async _setupShadowSandbox(){const e=this._pluginLocal,t=this._shadow=new Dt(e);try{this._status="pending",await t.load(),this._connected=!0,this.emit("connected"),this._call=async(t,n={},r)=>{var i;return r&&(n.actor=r),null===(i=this._pluginLocal)||void 0===i||i.emit(t,Object.assign(n,{$$pid:e.id})),null==r?void 0:r.promise},this._callUserModel=async(...e)=>{var t;let n=e[0];null!==(t=n)&&void 0!==t&&t.startsWith(Lt)&&(n=n.replace(Lt,""));const r=e[1]||{},i=this._userModel[n];"function"==typeof i&&await i.call(null,r)}}catch(e){throw Ft("[shadow sandbox] error",e),e}finally{this._status=void 0}}_extendUserModel(e){return Object.assign(this._userModel,e)}_getSandboxIframeContainer(){var e;return null===(e=this._parent)||void 0===e?void 0:e.frame.parentNode}_getSandboxShadowContainer(){var e;return null===(e=this._shadow)||void 0===e?void 0:e.frame.parentNode}_getSandboxIframeRoot(){var e;return null===(e=this._parent)||void 0===e?void 0:e.frame}_getSandboxShadowRoot(){var e;return null===(e=this._shadow)||void 0===e?void 0:e.frame}set debugTag(e){this._debugTag=e}async destroy(){var e;let t=null;this._parent&&(t=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(t=this._getSandboxShadowContainer(),this._shadow.destroy()),null===(e=t)||void 0===e||e.parentNode.removeChild(t)}}function qt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class zt{constructor(e,t){qt(this,"ctx",void 0),qt(this,"opts",void 0),this.ctx=e,this.opts=t}get ctxId(){return this.ctx.baseInfo.id}setItem(e,t){var n;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,e,t,null===(n=this.opts)||void 0===n?void 0:n.assets]})}getItem(e){var t;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,e,null===(t=this.opts)||void 0===t?void 0:t.assets]})}removeItem(e){var t;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,e,null===(t=this.opts)||void 0===t?void 0:t.assets]})}allKeys(){var e;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,null===(e=this.opts)||void 0===e?void 0:e.assets]})}clear(){var e;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,null===(e=this.opts)||void 0===e?void 0:e.assets]})}hasItem(e){var t;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,e,null===(t=this.opts)||void 0===t?void 0:t.assets]})}}class $t{constructor(e){var t;t=void 0,"ctx"in this?Object.defineProperty(this,"ctx",{value:t,enumerable:!0,configurable:!0,writable:!0}):this.ctx=t,this.ctx=e}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(e,...t){var n,r;const i=this.ensureHostScope();return e=null===(n=ht(e))||void 0===n?void 0:n.toLowerCase(),null===(r=i.logseq.api["exper_"+e])||void 0===r?void 0:r.apply(i,t)}async loadScripts(...e){(e=e.map((e=>null!=e&&e.startsWith("http")?e:this.ctx.resolveResourceFullUrl(e)))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...e)}registerFencedCodeRenderer(e,t){return this.ensureHostScope().logseq.api.exper_register_fenced_code_renderer(this.ctx.baseInfo.id,e,t)}registerExtensionsEnhancer(e,t){const n=this.ensureHostScope();return"katex"===e&&n.katex&&t(n.katex).catch(console.error),n.logseq.api.exper_register_extensions_enhancer(this.ctx.baseInfo.id,e,t)}ensureHostScope(){if(window===top)throw new Error("Can not access host scope!");return top}}function Ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Bt=e=>`task_callback_${e}`;class Wt{constructor(e,t,n={}){Ht(this,"_client",void 0),Ht(this,"_requestId",void 0),Ht(this,"_requestOptions",void 0),Ht(this,"_promise",void 0),Ht(this,"_aborted",!1),this._client=e,this._requestId=t,this._requestOptions=n,this._promise=new Promise(((e,t)=>{if(!this._requestId)return t(null);this._client.once(Bt(this._requestId),(n=>{n&&n instanceof Error?t(n):e(n)}))}));const{success:r,fail:i,final:o}=this._requestOptions;this._promise.then((e=>{null==r||r(e)})).catch((e=>{null==i||i(e)})).finally((()=>{null==o||o()}))}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class Yt extends ct.EventEmitter{constructor(e){super(),Ht(this,"_ctx",void 0),this._ctx=e,this.ctx.caller.on("#lsp#request#callback",(e=>{const t=null==e?void 0:e.requestId;t&&this.emit(Bt(t),null==e?void 0:e.payload)}))}static createRequestTask(e,t,n){return new Wt(e,t,n)}async _request(e){const t=this.ctx.baseInfo.id,{success:n,fail:r,final:i,...o}=e,a=this.ctx.Experiments.invokeExperMethod("request",t,o),s=Yt.createRequestTask(this.ctx.Request,a,e);return o.abortable?s:s.promise}get ctx(){return this._ctx}}const Gt=ae(Object.keys,Object);var Jt=Object.prototype.hasOwnProperty;const Qt=function(e){return ye(e)?ze(e):function(e){if(!ce(e))return Gt(e);var t=[];for(var n in Object(e))Jt.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)};function Zt(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new W;++t<n;)this.add(e[t])}Zt.prototype.add=Zt.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Zt.prototype.has=function(e){return this.__data__.has(e)};const Vt=Zt,Xt=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},Kt=function(e,t){return e.has(t)},en=function(e,t,n,r,i,o){var a=1&n,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var d=-1,f=!0,h=2&n?new Vt:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var p=e[d],g=t[d];if(r)var m=a?r(g,p,d,t,e,o):r(p,g,d,e,t,o);if(void 0!==m){if(m)continue;f=!1;break}if(h){if(!Xt(t,(function(e,t){if(!Kt(h,t)&&(p===e||i(p,e,n,r,o)))return h.push(t)}))){f=!1;break}}else if(p!==g&&!i(p,g,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f},tn=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n},nn=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n};var rn=p?p.prototype:void 0,on=rn?rn.valueOf:void 0;const an=function(e,t,n,r,o,a,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new ne(e),new ne(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var l=tn;case"[object Set]":var c=1&r;if(l||(l=nn),e.size!=t.size&&!c)return!1;var u=s.get(e);if(u)return u==t;r|=2,s.set(e,t);var d=en(l(e),l(t),r,o,a,s);return s.delete(e),d;case"[object Symbol]":if(on)return on.call(e)==on.call(t)}return!1};var sn=Object.prototype.propertyIsEnumerable,ln=Object.getOwnPropertySymbols;const cn=ln?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}(ln(e),(function(t){return sn.call(e,t)})))}:function(){return[]},un=function(e){return function(e,t,n){var r=t(e);return me(e)?r:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(r,n(e))}(e,Qt,cn)};var dn=Object.prototype.hasOwnProperty;const fn=L(h,"DataView"),hn=L(h,"Promise"),pn=L(h,"Set"),gn=L(h,"WeakMap");var mn="[object Map]",vn="[object Promise]",yn="[object Set]",bn="[object WeakMap]",wn="[object DataView]",_n=A(fn),Cn=A(N),kn=A(hn),xn=A(pn),Tn=A(gn),Sn=_;(fn&&Sn(new fn(new ArrayBuffer(1)))!=wn||N&&Sn(new N)!=mn||hn&&Sn(hn.resolve())!=vn||pn&&Sn(new pn)!=yn||gn&&Sn(new gn)!=bn)&&(Sn=function(e){var t=_(e),n="[object Object]"==t?e.constructor:void 0,r=n?A(n):"";if(r)switch(r){case _n:return wn;case Cn:return mn;case kn:return vn;case xn:return yn;case Tn:return bn}return t});const En=Sn;var An="[object Arguments]",On="[object Array]",Mn="[object Object]",jn=Object.prototype.hasOwnProperty;const Pn=function(e,t,n,r,i,o){var a=me(e),s=me(t),l=a?On:En(e),c=s?On:En(t),u=(l=l==An?Mn:l)==Mn,d=(c=c==An?Mn:c)==Mn,f=l==c;if(f&&Ce(e)){if(!Ce(t))return!1;a=!0,u=!1}if(f&&!u)return o||(o=new G),a||Ie(e)?en(e,t,n,r,i,o):an(e,t,l,n,r,i,o);if(!(1&n)){var h=u&&jn.call(e,"__wrapped__"),p=d&&jn.call(t,"__wrapped__");if(h||p){var g=h?e.value():e,m=p?t.value():t;return o||(o=new G),i(g,m,n,r,o)}}return!!f&&(o||(o=new G),function(e,t,n,r,i,o){var a=1&n,s=un(e),l=s.length;if(l!=un(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:dn.call(t,u)))return!1}var d=o.get(e),f=o.get(t);if(d&&f)return d==t&&f==e;var h=!0;o.set(e,t),o.set(t,e);for(var p=a;++c<l;){var g=e[u=s[c]],m=t[u];if(r)var v=a?r(m,g,u,t,e,o):r(g,m,u,e,t,o);if(!(void 0===v?g===m||i(g,m,n,r,o):v)){h=!1;break}p||(p="constructor"==u)}if(h&&!p){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(h=!1)}return o.delete(e),o.delete(t),h}(e,t,n,r,i,o))},Dn=function e(t,n,r,i,o){return t===n||(null==t||null==n||!ue(t)&&!ue(n)?t!=t&&n!=n:Pn(t,n,r,i,e,o))},In=function(e){return e==e&&!C(e)},Fn=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}},Ln=function(e){var t=function(e){for(var t=Qt(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,In(i)]}return t}(e);return 1==t.length&&t[0][2]?Fn(t[0][0],t[0][1]):function(n){return n===e||function(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=Object(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=n[i])[0],c=e[l],u=s[1];if(a&&s[2]){if(void 0===c&&!(l in e))return!1}else{var d=new G;if(r)var f=r(c,u,l,e,t,d);if(!(void 0===f?Dn(u,c,3,r,d):f))return!1}}return!0}(n,e,t)}},Nn=function(e){return"symbol"==typeof e||ue(e)&&"[object Symbol]"==_(e)};var Un=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Rn=/^\w*$/;const qn=function(e,t){if(me(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Nn(e))||Rn.test(e)||!Un.test(e)||null!=t&&e in Object(t)};function zn(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(zn.Cache||W),n}zn.Cache=W;const $n=zn;var Hn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Bn=/\\(\\)?/g;const Wn=function(e){var t=$n((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Hn,(function(e,n,r,i){t.push(r?i.replace(Bn,"$1"):n||e)})),t}),(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}();var Yn=p?p.prototype:void 0,Gn=Yn?Yn.toString:void 0;const Jn=function e(t){if("string"==typeof t)return t;if(me(t))return function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}(t,e)+"";if(Nn(t))return Gn?Gn.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n},Qn=function(e,t){return me(e)?e:qn(e,t)?[e]:Wn(function(e){return null==e?"":Jn(e)}(e))},Zn=function(e){if("string"==typeof e||Nn(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},Vn=function(e,t){for(var n=0,r=(t=Qn(t,e)).length;null!=e&&n<r;)e=e[Zn(t[n++])];return n&&n==r?e:void 0},Xn=function(e,t){return null!=e&&t in Object(e)},Kn=function(e,t){return null!=e&&function(e,t,n){for(var r=-1,i=(t=Qn(t,e)).length,o=!1;++r<i;){var a=Zn(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&ve(i)&&Re(a,i)&&(me(e)||ge(e))}(e,t,Xn)},er=function(e,t){return qn(e)&&In(t)?Fn(Zn(e),t):function(n){var r=function(e,t,n){var r=null==e?void 0:Vn(e,t);return void 0===r?n:r}(n,e);return void 0===r&&r===t?Kn(n,e):Dn(t,r,3)}},tr=function(e){return qn(e)?function(e){return function(t){return null==t?void 0:t[e]}}(Zn(e)):function(e){return function(t){return Vn(t,e)}}(e)},nr=function(e,t){var n={};return t=function(e){return"function"==typeof e?e:null==e?Je:"object"==typeof e?me(e)?er(e[0],e[1]):Ln(e):tr(e)}(t),function(e,t){e&&V(e,t,Qt)}(e,(function(e,r,i){Q(n,t(e,r,i),e)})),n};function rr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ir{constructor(e,t){rr(this,"ctx",void 0),rr(this,"serviceHooks",void 0),this.ctx=e,this.serviceHooks=t,e._execCallableAPI("register-search-service",e.baseInfo.id,t.name,t.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:e=>(me(null==e?void 0:e.blocks)&&(e.blocks=e.blocks.map((e=>e&&nr(e,((e,t)=>`block/${t}`))))),e)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach((([n,r])=>{const i=(e=>`service:search:${e}:${t.name}`)(n);e.caller.on(i,(async n=>{if(k(null==t?void 0:t[r.f])){let o=null;try{o=await t[r.f].apply(t,(r.args||[]).map((e=>{if(n){if(!0===e)return n;if(n.hasOwnProperty(e)){const t=n[e];return delete n[e],t}}}))),r.transformOutput&&(o=r.transformOutput(o))}catch(e){console.error("[SearchService] ",e),o=e}finally{r.reply&&e.caller.call(`${i}:reply`,o)}}}))}))}}function or(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ar=Symbol.for("proxy-continue"),sr=bt()("LSPlugin:user"),lr=new gt("",{console:!0});function cr(e,t,n){var r;if("function"!=typeof n)return!1;const{key:i,label:o,desc:a,palette:s,keybinding:l,extras:c}=t,u=`SimpleCommandHook${i}${++pr}`;this.Editor["on"+u](n),null===(r=this.caller)||void 0===r||r.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:i,label:o,type:e,desc:a,keybinding:l,extras:c},["editor/hook",u]],s]})}function ur(e){var t;return!("string"!=typeof(t=e)||36!==t.length||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(t))||(lr.error(`#${e} is not a valid UUID string.`),!1)}let dr=null,fr=new Map;const hr={async getInfo(e){return dr||(dr=await this._execCallableAPIAsync("get-app-info")),"string"==typeof e?dr[e]:dr},registerCommand:cr,registerSearchService(e){if(fr.has(e.name))throw new Error(`SearchService: #${e.name} has registered!`);fr.set(e.name,new ir(this,e))},registerCommandPalette(e,t){const{key:n,label:r,keybinding:i}=e;return cr.call(this,"$palette$",{key:n,label:r,palette:!0,keybinding:i},t)},registerCommandShortcut(e,t){const{binding:n}=e,r="$shortcut$",i=r+ht(n);return cr.call(this,r,{key:i,palette:!1,keybinding:e},t)},registerUIItem(e,t){var n;const r=this.baseInfo.id;null===(n=this.caller)||void 0===n||n.call("api:call",{method:"register-plugin-ui-item",args:[r,e,t]})},registerPageMenuItem(e,t){if("function"!=typeof t)return!1;const n=e+"_"+this.baseInfo.id,r=e;cr.call(this,"page-menu-item",{key:n,label:r},t)},onBlockRendererSlotted(e,t){if(!ur(e))return;const n=this.baseInfo.id,r=`hook:editor:${ht(`slot:${e}`)}`;return this.caller.on(r,t),this.App._installPluginHook(n,r),()=>{this.caller.off(r,t),this.App._uninstallPluginHook(n,r)}},invokeExternalPlugin(e,...t){var n;if(!(e=null===(n=e)||void 0===n?void 0:n.trim()))return;let[r,i]=e.split(".");if(!["models","commands"].includes(null==i?void 0:i.toLowerCase()))throw new Error("Type only support '.models' or '.commands' currently.");const o=e.replace(`${r}.${i}.`,"");if(!r||!i||!o)throw new Error(`Illegal type of #${e} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",r,i.toLowerCase(),o,t)},setFullScreen(e){const t=(...e)=>this._callWin("setFullScreen",...e);"toggle"===e?this._callWin("isFullScreen").then((e=>{e?t():t(!0)})):e?t(!0):t()}};let pr=0;const gr={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(e,t){var n;sr("Register slash command #",this.baseInfo.id,e,t),"function"==typeof t&&(t=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",t]]),t=t.map((e=>{const[t,...n]=e;if("editor/hook"===t){let r=n[0],i=()=>{var e;null===(e=this.caller)||void 0===e||e.callUserModel(r)};"function"==typeof r&&(i=r);const o=`SlashCommandHook${t}${++pr}`;e[1]=o,this.Editor["on"+o](i)}return e})),null===(n=this.caller)||void 0===n||n.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[e,t]]})},registerBlockContextMenuItem(e,t){if("function"!=typeof t)return!1;const n=e+"_"+this.baseInfo.id;cr.call(this,"block-context-menu-item",{key:n,label:e},t)},registerHighlightContextMenuItem(e,t,n){if("function"!=typeof t)return!1;const r=e+"_"+this.baseInfo.id;cr.call(this,"highlight-context-menu-item",{key:r,label:e,extras:n},t)},scrollToBlockInPage(e,t,n){const r="block-content-"+t;null!=n&&n.replaceState?this.App.replaceState("page",{name:e},{anchor:r}):this.App.pushState("page",{name:e},{anchor:r})}},mr={onBlockChanged(e,t){if(!ur(e))return;const n=this.baseInfo.id,r=`hook:db:${ht(`block:${e}`)}`,i=({block:n,txData:r,txMeta:i})=>{n.uuid===e&&t(n,r,i)};return this.caller.on(r,i),this.App._installPluginHook(n,r),()=>{this.caller.off(r,i),this.App._uninstallPluginHook(n,r)}},datascriptQuery(e,...t){return t.pop(),null!=t&&t.some((e=>"function"==typeof e))?this.Experiments.ensureHostScope().logseq.api.datascript_query(e,...t):this._execCallableAPIAsync("datascript_query",e,...t)}},vr={},yr={},br={makeSandboxStorage(){return new zt(this,{assets:!0})}};class wr extends(ut()){constructor(e,t){super(),or(this,"_baseInfo",void 0),or(this,"_caller",void 0),or(this,"_version","0.0.14"),or(this,"_debugTag",""),or(this,"_settingsSchema",void 0),or(this,"_connected",!1),or(this,"_ui",new Map),or(this,"_mFileStorage",void 0),or(this,"_mRequest",void 0),or(this,"_mExperiments",void 0),or(this,"_beforeunloadCallback",void 0),this._baseInfo=e,this._caller=t,t.on("sys:ui:visible",(e=>{null!=e&&e.toggle&&this.toggleMainUI()})),t.on("settings:changed",(e=>{const t=Object.assign({},this.settings),n=Object.assign(this._baseInfo.settings,e);this.emit("settings:changed",{...n},t)})),t.on("beforeunload",(async e=>{const{actor:n,...r}=e,i=this._beforeunloadCallback;try{i&&await i(r),null==n||n.resolve(null)}catch(e){console.debug(`${t.debugTag} [beforeunload] `,e),null==n||n.reject(e)}}))}async ready(e,t){if(!this._connected)try{var n;"function"==typeof e&&(t=e,e={});let r=await this._caller.connectToParent(e);this._connected=!0,r=pt(this._baseInfo,r),null!==(n=r)&&void 0!==n&&n.id&&(this._debugTag=this._caller.debugTag=`#${r.id} [${r.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(r.settings=function(e,t){const n=(t||[]).reduce(((e,t)=>("default"in t&&(e[t.key]=t.default),e)),{});return Object.assign(n,e)}(r.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(e){console.warn(e)}t&&t.call(this,r)}catch(e){console.error(`${this._debugTag} [Ready Error]`,e)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(e){"function"==typeof e&&(this._beforeunloadCallback=e)}provideModel(e){return this.caller._extendUserModel(e),this}provideTheme(e){return this.caller.call("provider:theme",e),this}provideStyle(e){return this.caller.call("provider:style",e),this}provideUI(e){return this.caller.call("provider:ui",e),this}useSettingsSchema(e){return this.connected&&this.caller.call("settings:schema",{schema:e,isSync:!0}),this._settingsSchema=e,this}updateSettings(e){this.caller.call("settings:update",e)}onSettingsChanged(e){const t="settings:changed";return this.on(t,e),()=>this.off(t,e)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(e){this.caller.call("main-ui:attrs",e)}setMainUIInlineStyle(e){this.caller.call("main-ui:style",e)}hideMainUI(e){const t={key:0,visible:!1,cursor:null==e?void 0:e.restoreEditingCursor};this.caller.call("main-ui:visible",t),this.emit("ui:visible:changed",t),this._ui.set(t.key,t)}showMainUI(e){const t={key:0,visible:!0,autoFocus:null==e?void 0:e.autoFocus};this.caller.call("main-ui:visible",t),this.emit("ui:visible:changed",t),this._ui.set(t.key,t)}toggleMainUI(){const e=this._ui.get(0);e&&e.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){const e=this._ui.get(0);return Boolean(e&&e.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){var e,t;return this&&((null===(e=this.baseInfo)||void 0===e?void 0:e.effect)||!(null!==(t=this.baseInfo)&&void 0!==t&&t.iir))}get logger(){return lr}get settings(){var e;return null===(e=this.baseInfo)||void 0===e?void 0:e.settings}get caller(){return this._caller}resolveResourceFullUrl(e){if(this.ensureConnected(),e)return e=e.replace(/^[.\\/]+/,""),function(e,...t){try{const n=new URL(e);if(!n.origin)throw new Error(null);const r=ft.join(e.substr(n.origin.length),...t);return n.origin+r}catch(n){return ft.join(e,...t)}}(this._baseInfo.lsr,e)}_makeUserProxy(e,t){const n=this,r=this.caller;return new Proxy(e,{get(e,i,o){const a=e[i];return function(...e){if(a){const r=a.apply(n,e.concat(t));if(r!==ar)return r}if(t){const o=i.toString().match(/^(once|off|on)/i);if(null!=o){const i=o[0].toLowerCase(),a=o.input.slice(i.length),s="off"===i,l=n.baseInfo.id,c=`hook:${t}:${ht(a)}`,u=e[0];r[i](c,u);const d=()=>{r.off(c,u),r.listenerCount(c)||n.App._uninstallPluginHook(l,c)};return s?void d():(n.App._installPluginHook(l,c),d)}}let o=i;return["git","ui","assets"].includes(t)&&(o=t+"_"+o),r.callAsync("api:call",{tag:t,method:o,args:e})}}})}_execCallableAPIAsync(e,...t){return this._caller.callAsync("api:call",{method:e,args:t})}_execCallableAPI(e,...t){this._caller.call("api:call",{method:e,args:t})}_callWin(...e){return this._execCallableAPIAsync("_callMainWin",...e)}get App(){return this._makeUserProxy(hr,"app")}get Editor(){return this._makeUserProxy(gr,"editor")}get DB(){return this._makeUserProxy(mr,"db")}get Git(){return this._makeUserProxy(vr,"git")}get UI(){return this._makeUserProxy(yr,"ui")}get Assets(){return this._makeUserProxy(br,"assets")}get FileStorage(){let e=this._mFileStorage;return e||(e=this._mFileStorage=new zt(this)),e}get Request(){let e=this._mRequest;return e||(e=this._mRequest=new Yt(this)),e}get Experiments(){let e=this._mExperiments;return e||(e=this._mExperiments=new $t(this)),e}}function _r(e,t){return new wr(e,t)}if(null==window.__LSP__HOST__){const e=new Rt(null);window.logseq=_r({},e)}})(),a})(),t.exports=r()})),r("ei7xD");const i=[{key:"generalSettingsHeading",title:"⚙️ General Settings",description:"",type:"heading",default:null},{key:"serverUrl",type:"string",default:logseq.settings?.["server url"],title:"Audiobookshelf Server URL",description:"Example: https://audiobookshelf.example.com"},{key:"serverToken",type:"string",default:logseq.settings?.["server token"],title:"API Token",description:"Audiobookshelf uses a users API token as a Bearer token for requests. You can find your API token by logging into the Audiobookshelf web app as an admin, go to the config → users page, and click on your account."},{key:"libraryNameList",type:"string",default:"",title:"Library names",description:"Enter comma separated library names to import. Default empty will import all. If you have 2 libraries named Audiobooks and Podcasts you can select them with following match 'Audiobooks,Podcasts'"},{key:"importProgressFilters",type:"enum",default:["finished"],title:"Import progress filters (Default: )",enumChoices:["finished","in-progress"],enumPicker:"checkbox",description:"Select item filters to import."},{key:"singlePageSettingsHeading",title:"📄 Single Page Mode Settings",description:"",type:"heading",default:null},{key:"singlePageModeEnabled",type:"boolean",default:!0,title:"Single Page Mode",description:"Imports Audiobookshelf items to a single page"},{key:"pageName",type:"string",default:"Audiobookshelf Import",title:"Enter the page name ",description:"Page name to import Audiobookshelf items."},{key:"singlePageItemTemplate",type:"string",inputAs:"textarea",title:"Fill out template",description:"Enter the template to use for both new and updated items. Single Page items are never updated. To update items remove item ID from Audiobooskelf Import block located at the bottom of import page.",default:"### books/{{{title}}}\ncollapsed:: false\nsubtitle:: {{subtitle}}\nprogress:: {{{progress}}}\nisFinished:: {{{isFinished}}}\nduration:: {{{duration}}}\ncurrentTime:: {{{currentTime}}}\n{{!_______________________________}}\n{{#authors.length}}\nauthors:: {{#authors}}[[{{{name}}}]]{{/authors}}\n{{/authors.length}}\n{{!_______________________________}}\n{{#narrators.length}}\nnarrators:: {{#narrators}}[[{{{.}}}]]{{/narrators}}\n{{/narrators.length}}\n{{!_______________________________}}\n{{#genres.length}}\ngenres:: {{#genres}}[[{{{.}}}]]{{/genres}}\n{{/genres.length}}\n{{!_______________________________}}\nsource:: [Open in Audiobookshelf]({{{audiobookshelfUrl}}})\nasin:: {{{asin}}}\nisbn:: {{{isbn}}}\n{{!_______________________________}}\n{{#tags.length}}\ntags:: {{#tags}}[[{{{.}}}]] {{/tags}}\n{{/tags.length}}\n{{!_______________________________}}\n{{#startedDate}}\nstartedDate:: [[{{{startedDateParsed}}}]]\n{{/startedDate}}\n{{!_______________________________}}\n{{#finishedDate}}\nfinishedDate:: [[{{{finishedDateParsed}}}]]\n{{/finishedDate}}"},{key:"multiPageSettingsHeading",title:"📖 Multi Page Mode Settings",description:"",type:"heading",default:null},{key:"createPages",type:"boolean",default:!1,title:"Create pages",description:"Enables page creation for each Audiobookshelf item. Page title prefix and postfix can be configured to customize page titles."},{key:"updatePages",type:"boolean",default:!1,title:"Update pages",description:"If enabled it will update first block of existing pages. Warning: existing data in first block of the page will be lost."},{key:"pageTitlePrefix",type:"string",default:"{{{mediaType}}}/",title:"Page title prefix",description:"Prefix to add to item title. Allowed variables: {{{mediaType}}} - Audiobookshelf item type (book or podcast). This can be used to add namespace (hardcoded) eg. 'books/' or use variable to dynamically assign namespace '{{{mediaType}}}/'.\nWarning: Changing values on pages already created will create new pages and old pages will need to be deleted manually."},{key:"pageTitlePostfix",type:"string",default:"",title:"Page title postfix",description:"Postfix to add to item title. This can be used to add additional data to ensure uniquess eg. ' (Audiobookshelf)' \nWarning: Changing values on pages already created will create new pages and old pages will need to be deleted manually."},{key:"multiPageItemTemplate",type:"string",inputAs:"textarea",title:"Fill out template",description:"Enter the template to use for both new and updated items. Setting audiobookshelfUpdateEnabled to false property may be intentional to act as granular one time import functionality.",default:"### books/{{{title}}}\ncollapsed:: false\nsubtitle:: {{subtitle}}\nprogress:: {{{progress}}}\nisFinished:: {{{isFinished}}}\nduration:: {{{duration}}}\ncurrentTime:: {{{currentTime}}}\n{{!===== Authors =====}}\n{{#authors.length}}\nauthors:: {{#authors}}[[{{{name}}}]]{{/authors}}\n{{/authors.length}}\n{{!===== Narrators =====}}\n{{#narrators.length}}\nnarrators:: {{#narrators}}[[{{{.}}}]]{{/narrators}}\n{{/narrators.length}}\n{{!===== Genres =====}}\n{{#genres.length}}\ngenres:: {{#genres}}[[{{{.}}}]]{{/genres}}\n{{/genres.length}}\n{{!===== Series =====}}\n{{#series}}\nseries:: {{#series}}[[{{{name}}}]]{{/series}}\n{{/series}}\nsource:: [Open in Audiobookshelf]({{{audiobookshelfUrl}}})\nasin:: {{{asin}}}\nisbn:: {{{isbn}}}\n{{!===== Tags =====}}\n{{#tags.length}}\ntags:: {{#tags}}[[{{{.}}}]] {{/tags}}\n{{/tags.length}}\n{{!===== Started Date =====}}\n{{#startedDate}}\nstartedDate:: [[{{{startedDateParsed}}}]]\n{{/startedDate}}\n{{!===== Finished Date =====}}\n{{#finishedDate}}\nfinishedDate:: [[{{{finishedDateParsed}}}]]\n{{/finishedDate}}\n\n{{{description}}}"},{key:"podcastSettingsHeading",title:"🎙️ Podcasts Settings",description:"",type:"heading",default:null},{key:"singlePagePodcastItemTemplate",type:"string",inputAs:"textarea",title:"Single Page Podcast Episode Template ",description:"Enter the template to use for new podcast items.",default:"### podcasts/{{{title}}}/{{{episodeTitle}}}\ncollapsed:: false\nsubtitle:: {{subtitle}}\nprogress:: {{{progress}}}\nisFinished:: {{{isFinished}}}\nduration:: {{{duration}}}\ncurrentTime:: {{{currentTime}}}\nauthor:: [[{{{author}}}]]\n{{!===== Genres =====}}\n{{#genres.length}}\ngenres:: {{#genres}}[[{{{.}}}]]{{/genres}}\n{{/genres.length}}\nsource:: [Open in Audiobookshelf]({{{audiobookshelfUrl}}})\n{{!===== Tags =====}}\n{{#tags.length}}\ntags:: {{#tags}}[[{{{.}}}]] {{/tags}}\n{{/tags.length}}\n{{!===== Started Date =====}}\n{{#startedDate}}\nstartedDate:: [[{{{startedDateParsed}}}]]\n{{/startedDate}}\n{{!===== Finished Date =====}}\n{{#finishedDate}}\nfinishedDate:: [[{{{finishedDateParsed}}}]]\n{{/finishedDate}}\n\n{{{description}}}"},{key:"advancedSettingsHeading",title:"🛠️ Advanced Settings",description:"",type:"heading",default:null},{key:"debug",type:"enum",default:[],title:"Enable debugging? (Default: None)",enumChoices:["index","utils"],enumPicker:"checkbox",description:"Select the files to enable debugging for."}];function o(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e){return o(1,arguments),e instanceof Date||"object"===a(e)&&"[object Date]"===Object.prototype.toString.call(e)}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e){o(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===l(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}function u(e){if(o(1,arguments),!s(e)&&"number"!=typeof e)return!1;var t=c(e);return!isNaN(Number(t))}function d(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function f(e,t){o(2,arguments);var n=c(e).getTime(),r=d(t);return new Date(n+r)}function h(e,t){o(2,arguments);var n=d(t);return f(e,-n)}var p=864e5;function g(e){o(1,arguments);var t=c(e),n=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var r=t.getTime(),i=n-r;return Math.floor(i/p)+1}function m(e){o(1,arguments);var t=1,n=c(e),r=n.getUTCDay(),i=(r<t?7:0)+r-t;return n.setUTCDate(n.getUTCDate()-i),n.setUTCHours(0,0,0,0),n}function v(e){o(1,arguments);var t=c(e),n=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(n+1,0,4),r.setUTCHours(0,0,0,0);var i=m(r),a=new Date(0);a.setUTCFullYear(n,0,4),a.setUTCHours(0,0,0,0);var s=m(a);return t.getTime()>=i.getTime()?n+1:t.getTime()>=s.getTime()?n:n-1}function y(e){o(1,arguments);var t=v(e),n=new Date(0);n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0);var r=m(n);return r}var b=6048e5;function w(e){o(1,arguments);var t=c(e),n=m(t).getTime()-y(t).getTime();return Math.round(n/b)+1}var _={};function C(){return _}function k(e,t){var n,r,i,a,s,l,u,f;o(1,arguments);var h=C(),p=d(null!==(n=null!==(r=null!==(i=null!==(a=null==t?void 0:t.weekStartsOn)&&void 0!==a?a:null==t||null===(s=t.locale)||void 0===s||null===(l=s.options)||void 0===l?void 0:l.weekStartsOn)&&void 0!==i?i:h.weekStartsOn)&&void 0!==r?r:null===(u=h.locale)||void 0===u||null===(f=u.options)||void 0===f?void 0:f.weekStartsOn)&&void 0!==n?n:0);if(!(p>=0&&p<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=c(e),m=g.getUTCDay(),v=(m<p?7:0)+m-p;return g.setUTCDate(g.getUTCDate()-v),g.setUTCHours(0,0,0,0),g}function x(e,t){var n,r,i,a,s,l,u,f;o(1,arguments);var h=c(e),p=h.getUTCFullYear(),g=C(),m=d(null!==(n=null!==(r=null!==(i=null!==(a=null==t?void 0:t.firstWeekContainsDate)&&void 0!==a?a:null==t||null===(s=t.locale)||void 0===s||null===(l=s.options)||void 0===l?void 0:l.firstWeekContainsDate)&&void 0!==i?i:g.firstWeekContainsDate)&&void 0!==r?r:null===(u=g.locale)||void 0===u||null===(f=u.options)||void 0===f?void 0:f.firstWeekContainsDate)&&void 0!==n?n:1);if(!(m>=1&&m<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setUTCFullYear(p+1,0,m),v.setUTCHours(0,0,0,0);var y=k(v,t),b=new Date(0);b.setUTCFullYear(p,0,m),b.setUTCHours(0,0,0,0);var w=k(b,t);return h.getTime()>=y.getTime()?p+1:h.getTime()>=w.getTime()?p:p-1}function T(e,t){var n,r,i,a,s,l,c,u;o(1,arguments);var f=C(),h=d(null!==(n=null!==(r=null!==(i=null!==(a=null==t?void 0:t.firstWeekContainsDate)&&void 0!==a?a:null==t||null===(s=t.locale)||void 0===s||null===(l=s.options)||void 0===l?void 0:l.firstWeekContainsDate)&&void 0!==i?i:f.firstWeekContainsDate)&&void 0!==r?r:null===(c=f.locale)||void 0===c||null===(u=c.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==n?n:1),p=x(e,t),g=new Date(0);g.setUTCFullYear(p,0,h),g.setUTCHours(0,0,0,0);var m=k(g,t);return m}var S=6048e5;function E(e,t){o(1,arguments);var n=c(e),r=k(n,t).getTime()-T(n,t).getTime();return Math.round(r/S)+1}function A(e,t){for(var n=e<0?"-":"",r=Math.abs(e).toString();r.length<t;)r="0"+r;return n+r}var O={y:function(e,t){var n=e.getUTCFullYear(),r=n>0?n:1-n;return A("yy"===t?r%100:r,t.length)},M:function(e,t){var n=e.getUTCMonth();return"M"===t?String(n+1):A(n+1,2)},d:function(e,t){return A(e.getUTCDate(),t.length)},a:function(e,t){var n=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:function(e,t){return A(e.getUTCHours()%12||12,t.length)},H:function(e,t){return A(e.getUTCHours(),t.length)},m:function(e,t){return A(e.getUTCMinutes(),t.length)},s:function(e,t){return A(e.getUTCSeconds(),t.length)},S:function(e,t){var n=t.length,r=e.getUTCMilliseconds();return A(Math.floor(r*Math.pow(10,n-3)),t.length)}},M="midnight",j="noon",P="morning",D="afternoon",I="evening",F="night";function L(e,t){var n=e>0?"-":"+",r=Math.abs(e),i=Math.floor(r/60),o=r%60;if(0===o)return n+String(i);var a=t||"";return n+String(i)+a+A(o,2)}function N(e,t){return e%60==0?(e>0?"-":"+")+A(Math.abs(e)/60,2):U(e,t)}function U(e,t){var n=t||"",r=e>0?"-":"+",i=Math.abs(e);return r+A(Math.floor(i/60),2)+n+A(i%60,2)}var R={G:function(e,t,n){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){var r=e.getUTCFullYear(),i=r>0?r:1-r;return n.ordinalNumber(i,{unit:"year"})}return O.y(e,t)},Y:function(e,t,n,r){var i=x(e,r),o=i>0?i:1-i;return"YY"===t?A(o%100,2):"Yo"===t?n.ordinalNumber(o,{unit:"year"}):A(o,t.length)},R:function(e,t){return A(v(e),t.length)},u:function(e,t){return A(e.getUTCFullYear(),t.length)},Q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return A(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return A(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){var r=e.getUTCMonth();switch(t){case"M":case"MM":return O.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return A(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){var i=E(e,r);return"wo"===t?n.ordinalNumber(i,{unit:"week"}):A(i,t.length)},I:function(e,t,n){var r=w(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):A(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):O.d(e,t)},D:function(e,t,n){var r=g(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):A(r,t.length)},E:function(e,t,n){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){var i=e.getUTCDay(),o=(i-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return A(o,2);case"eo":return n.ordinalNumber(o,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){var i=e.getUTCDay(),o=(i-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return A(o,t.length);case"co":return n.ordinalNumber(o,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,n){var r=e.getUTCDay(),i=0===r?7:r;switch(t){case"i":return String(i);case"ii":return A(i,t.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){var r,i=e.getUTCHours();switch(r=12===i?j:0===i?M:i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){var r,i=e.getUTCHours();switch(r=i>=17?I:i>=12?D:i>=4?P:F,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){var r=e.getUTCHours()%12;return 0===r&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return O.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):O.H(e,t)},K:function(e,t,n){var r=e.getUTCHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):A(r,t.length)},k:function(e,t,n){var r=e.getUTCHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):A(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):O.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):O.s(e,t)},S:function(e,t){return O.S(e,t)},X:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();if(0===i)return"Z";switch(t){case"X":return N(i);case"XXXX":case"XX":return U(i);default:return U(i,":")}},x:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"x":return N(i);case"xxxx":case"xx":return U(i);default:return U(i,":")}},O:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+L(i,":");default:return"GMT"+U(i,":")}},z:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+L(i,":");default:return"GMT"+U(i,":")}},t:function(e,t,n,r){var i=r._originalDate||e;return A(Math.floor(i.getTime()/1e3),t.length)},T:function(e,t,n,r){return A((r._originalDate||e).getTime(),t.length)}},q=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},z=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},$={p:z,P:function(e,t){var n,r=e.match(/(P+)(p+)?/)||[],i=r[1],o=r[2];if(!o)return q(e,t);switch(i){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",q(i,t)).replace("{{time}}",z(o,t))}};function H(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}var B=["D","DD"],W=["YY","YYYY"];function Y(e){return-1!==B.indexOf(e)}function G(e){return-1!==W.indexOf(e)}function J(e,t,n){if("YYYY"===e)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var Q={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Z=function(e,t,n){var r,i=Q[e];return r="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",t.toString()),null!=n&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function V(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.width?String(t.width):e.defaultWidth,r=e.formats[n]||e.formats[e.defaultWidth];return r}}var X={date:V({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:V({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:V({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},K={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function ee(e){return function(t,n){var r;if("formatting"===(null!=n&&n.context?String(n.context):"standalone")&&e.formattingValues){var i=e.defaultFormattingWidth||e.defaultWidth,o=null!=n&&n.width?String(n.width):i;r=e.formattingValues[o]||e.formattingValues[i]}else{var a=e.defaultWidth,s=null!=n&&n.width?String(n.width):e.defaultWidth;r=e.values[s]||e.values[a]}return r[e.argumentCallback?e.argumentCallback(t):t]}}function te(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.width,i=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=t.match(i);if(!o)return null;var a,s=o[0],l=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?re(l,(function(e){return e.test(s)})):ne(l,(function(e){return e.test(s)}));a=e.valueCallback?e.valueCallback(c):c,a=n.valueCallback?n.valueCallback(a):a;var u=t.slice(s.length);return{value:a,rest:u}}}function ne(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n}function re(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n}var ie,oe={code:"en-US",formatDistance:Z,formatLong:X,formatRelative:function(e,t,n,r){return K[e]},localize:{ordinalNumber:function(e,t){var n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:ee({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:ee({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:ee({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:ee({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:ee({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(ie={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.match(ie.matchPattern);if(!n)return null;var r=n[0],i=e.match(ie.parsePattern);if(!i)return null;var o=ie.valueCallback?ie.valueCallback(i[0]):i[0];o=t.valueCallback?t.valueCallback(o):o;var a=e.slice(r.length);return{value:o,rest:a}}),era:te({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:te({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:te({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:te({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:te({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},ae=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,se=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,le=/^'([^]*?)'?$/,ce=/''/g,ue=/[a-zA-Z]/;function de(e,t,n){var r,i,a,s,l,f,p,g,m,v,y,b,w,_,k,x,T,S;o(2,arguments);var E=String(t),A=C(),O=null!==(r=null!==(i=null==n?void 0:n.locale)&&void 0!==i?i:A.locale)&&void 0!==r?r:oe,M=d(null!==(a=null!==(s=null!==(l=null!==(f=null==n?void 0:n.firstWeekContainsDate)&&void 0!==f?f:null==n||null===(p=n.locale)||void 0===p||null===(g=p.options)||void 0===g?void 0:g.firstWeekContainsDate)&&void 0!==l?l:A.firstWeekContainsDate)&&void 0!==s?s:null===(m=A.locale)||void 0===m||null===(v=m.options)||void 0===v?void 0:v.firstWeekContainsDate)&&void 0!==a?a:1);if(!(M>=1&&M<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var j=d(null!==(y=null!==(b=null!==(w=null!==(_=null==n?void 0:n.weekStartsOn)&&void 0!==_?_:null==n||null===(k=n.locale)||void 0===k||null===(x=k.options)||void 0===x?void 0:x.weekStartsOn)&&void 0!==w?w:A.weekStartsOn)&&void 0!==b?b:null===(T=A.locale)||void 0===T||null===(S=T.options)||void 0===S?void 0:S.weekStartsOn)&&void 0!==y?y:0);if(!(j>=0&&j<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!O.localize)throw new RangeError("locale must contain localize property");if(!O.formatLong)throw new RangeError("locale must contain formatLong property");var P=c(e);if(!u(P))throw new RangeError("Invalid time value");var D=H(P),I=h(P,D),F={firstWeekContainsDate:M,weekStartsOn:j,locale:O,_originalDate:P},L=E.match(se).map((function(e){var t=e[0];return"p"===t||"P"===t?(0,$[t])(e,O.formatLong):e})).join("").match(ae).map((function(r){if("''"===r)return"'";var i=r[0];if("'"===i)return fe(r);var o=R[i];if(o)return null!=n&&n.useAdditionalWeekYearTokens||!G(r)||J(r,t,String(e)),null!=n&&n.useAdditionalDayOfYearTokens||!Y(r)||J(r,t,String(e)),o(I,r,O.localize,F);if(i.match(ue))throw new RangeError("Format string contains an unescaped latin alphabet character `"+i+"`");return r})).join("");return L}function fe(e){var t=e.match(le);return t?t[1].replace(ce,"'"):e}var he={};he=function(){
/*!
   * mustache.js - Logic-less {{mustache}} templates with JavaScript
   * http://github.com/janl/mustache.js
   */
var e=Object.prototype.toString,t=Array.isArray||function(t){return"[object Array]"===e.call(t)};function n(e){return"function"==typeof e}function r(e){return t(e)?"array":typeof e}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(e,t){return null!=e&&"object"==typeof e&&t in e}function a(e,t){return null!=e&&"object"!=typeof e&&e.hasOwnProperty&&e.hasOwnProperty(t)}var s=RegExp.prototype.test;function l(e,t){return s.call(e,t)}var c=/\S/;function u(e){return!l(c,e)}var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function f(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return d[e]}))}var h=/\s*/,p=/\s+/,g=/\s*=/,m=/\s*\}/,v=/#|\^|\/|>|\{|&|=|!/;function y(e,n){if(!e)return[];var r,o,a,s=!1,l=[],c=[],d=[],f=!1,y=!1,C="",k=0;function T(){if(f&&!y)for(;d.length;)delete c[d.pop()];else d=[];f=!1,y=!1}function S(e){if("string"==typeof e&&(e=e.split(p,2)),!t(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(i(e[0])+"\\s*"),o=new RegExp("\\s*"+i(e[1])),a=new RegExp("\\s*"+i("}"+e[1]))}S(n||x.tags);for(var E,A,O,M,j,P,D=new _(e);!D.eos();){if(E=D.pos,O=D.scanUntil(r))for(var I=0,F=O.length;I<F;++I)u(M=O.charAt(I))?(d.push(c.length),C+=M):(y=!0,s=!0,C+=" "),c.push(["text",M,E,E+1]),E+=1,"\n"===M&&(T(),C="",k=0,s=!1);if(!D.scan(r))break;if(f=!0,A=D.scan(v)||"name",D.scan(h),"="===A?(O=D.scanUntil(g),D.scan(g),D.scanUntil(o)):"{"===A?(O=D.scanUntil(a),D.scan(m),D.scanUntil(o),A="&"):O=D.scanUntil(o),!D.scan(o))throw new Error("Unclosed tag at "+D.pos);if(j=">"==A?[A,O,E,D.pos,C,k,s]:[A,O,E,D.pos],k++,c.push(j),"#"===A||"^"===A)l.push(j);else if("/"===A){if(!(P=l.pop()))throw new Error('Unopened section "'+O+'" at '+E);if(P[1]!==O)throw new Error('Unclosed section "'+P[1]+'" at '+E)}else"name"===A||"{"===A||"&"===A?y=!0:"="===A&&S(O)}if(T(),P=l.pop())throw new Error('Unclosed section "'+P[1]+'" at '+D.pos);return w(b(c))}function b(e){for(var t,n,r=[],i=0,o=e.length;i<o;++i)(t=e[i])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}function w(e){for(var t,n=[],r=n,i=[],o=0,a=e.length;o<a;++o)switch((t=e[o])[0]){case"#":case"^":r.push(t),i.push(t),r=t[4]=[];break;case"/":i.pop()[5]=t[2],r=i.length>0?i[i.length-1][4]:n;break;default:r.push(t)}return n}function _(e){this.string=e,this.tail=e,this.pos=0}function C(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function k(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}_.prototype.eos=function(){return""===this.tail},_.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},_.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},C.prototype.push=function(e){return new C(e,this)},C.prototype.lookup=function(e){var t,r=this.cache;if(r.hasOwnProperty(e))t=r[e];else{for(var i,s,l,c=this,u=!1;c;){if(e.indexOf(".")>0)for(i=c.view,s=e.split("."),l=0;null!=i&&l<s.length;)l===s.length-1&&(u=o(i,s[l])||a(i,s[l])),i=i[s[l++]];else i=c.view[e],u=o(c.view,e);if(u){t=i;break}c=c.parent}r[e]=t}return n(t)&&(t=t.call(this.view)),t},k.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},k.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||x.tags).join(":"),i=void 0!==n,o=i?n.get(r):void 0;return null==o&&(o=y(e,t),i&&n.set(r,o)),o},k.prototype.render=function(e,t,n,r){var i=this.getConfigTags(r),o=this.parse(e,i),a=t instanceof C?t:new C(t,void 0);return this.renderTokens(o,a,n,e,r)},k.prototype.renderTokens=function(e,t,n,r,i){for(var o,a,s,l="",c=0,u=e.length;c<u;++c)s=void 0,"#"===(a=(o=e[c])[0])?s=this.renderSection(o,t,n,r,i):"^"===a?s=this.renderInverted(o,t,n,r,i):">"===a?s=this.renderPartial(o,t,n,i):"&"===a?s=this.unescapedValue(o,t):"name"===a?s=this.escapedValue(o,t,i):"text"===a&&(s=this.rawValue(o)),void 0!==s&&(l+=s);return l},k.prototype.renderSection=function(e,r,i,o,a){var s=this,l="",c=r.lookup(e[1]);function u(e){return s.render(e,r,i,a)}if(c){if(t(c))for(var d=0,f=c.length;d<f;++d)l+=this.renderTokens(e[4],r.push(c[d]),i,o,a);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)l+=this.renderTokens(e[4],r.push(c),i,o,a);else if(n(c)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");null!=(c=c.call(r.view,o.slice(e[3],e[5]),u))&&(l+=c)}else l+=this.renderTokens(e[4],r,i,o,a);return l}},k.prototype.renderInverted=function(e,n,r,i,o){var a=n.lookup(e[1]);if(!a||t(a)&&0===a.length)return this.renderTokens(e[4],n,r,i,o)},k.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),i=e.split("\n"),o=0;o<i.length;o++)i[o].length&&(o>0||!n)&&(i[o]=r+i[o]);return i.join("\n")},k.prototype.renderPartial=function(e,t,r,i){if(r){var o=this.getConfigTags(i),a=n(r)?r(e[1]):r[e[1]];if(null!=a){var s=e[6],l=e[5],c=e[4],u=a;0==l&&c&&(u=this.indentPartial(a,c,s));var d=this.parse(u,o);return this.renderTokens(d,t,r,u,i)}}},k.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},k.prototype.escapedValue=function(e,t,n){var r=this.getConfigEscape(n)||x.escape,i=t.lookup(e[1]);if(null!=i)return"number"==typeof i&&r===x.escape?String(i):r(i)},k.prototype.rawValue=function(e){return e[1]},k.prototype.getConfigTags=function(e){return t(e)?e:e&&"object"==typeof e?e.tags:void 0},k.prototype.getConfigEscape=function(e){return e&&"object"==typeof e&&!t(e)?e.escape:void 0};var x={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){T.templateCache=e},get templateCache(){return T.templateCache}},T=new k;return x.clearCache=function(){return T.clearCache()},x.parse=function(e,t){return T.parse(e,t)},x.render=function(e,t,n,i){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+r(e)+'" was given as the first argument for mustache#render(template, view, partials)');return T.render(e,t,n,i)},x.escape=f,x.Scanner=_,x.Context=C,x.Writer=k,x}();const pe=e=>({Authorization:"Bearer "+e,Accept:"application/json","Content-Type":"application/json"}),ge=async(e,t)=>{const n=await fetch(e+"/api/authorize",{method:"post",headers:pe(t)});return(await n.json()).user},me=async(e,t,n)=>{for(let r of e.mediaProgress){if(r.libraryItemId==t&&null==n)return r;if(r.libraryItemId==t&&null!=n&&r.episodeId==n)return r}return new we},ve=async(e,t,n=10,r=0,i,o)=>{const a=e+"/api/libraries/"+i+"/items?limit="+n+"&page="+r+"&filter="+o,s=await fetch(a,{headers:pe(t)}),l=await s.json();return[l.results,l.total]},ye=async(e,t,n=10,r=0,i)=>{const o=e+"/api/libraries/"+i+"/items?limit="+n+"&page="+r,a=await fetch(o,{headers:pe(t)}),s=await a.json();return[s.results,s.total]},be=async(e,t,n)=>{const r=await fetch(e+"/api/libraries/",{headers:pe(t)}),i=await r.json();return n.length>0?(_e("utils","filtered libraries because length is "+n.length),i.libraries.filter((e=>n.includes(e.name)))):i.libraries};class we{id="";libraryItemId="";episodeId="";duration=0;progress=0;currentTime=0;isFinished=!1;hideFromContinueListening=!1;lastUpdate=0;startedAt=0;finishedAt=null}function _e(e,t){logseq.settings.hasOwnProperty("debug")&&logseq.settings.debug.includes(e)&&console.info(e+"> "+t)}function Ce(e){var t=Math.floor(e/86400);e-=86400*t;var n=Math.floor(e/3600);e-=3600*n;var r=Math.floor(e/60);return(0<t?t+"d ":"")+n+"h "+r+"m "+(e-=60*r).toFixed()+"s"}function ke(e){logseq.UI.showMsg(e)}function xe(e,t,n,r,i,o,a,s){let l="";const c=i.startedAt>0?de(new Date(i.startedAt),n):"",u=i.finishedAt?de(new Date(i.finishedAt),n):"";return"book"==r&&o&&(_e("utils",o.media.metadata.title+" started "+c),l=(0,he.render)(e,{audiobookshelfUrl:`${t}/item/${o.id}`,asin:o.media.metadata.asin,authors:o.media.metadata.authors,description:o.media.metadata.description,duration:Ce(i.duration),currentTime:Ce(i.currentTime),isFinished:i.isFinished,explicit:o.media.metadata.explicit,genres:o.media.metadata.genres,isbn:o.media.metadata.isbn,startedDate:i.startedAt,startedDateParsed:c,finishedDate:i.finishedAt,finishedDateParsed:u,language:o.media.metadata.language,narrators:o.media.metadata.narrators,progress:(100*i.progress).toFixed(1==i.progress?0:2)+"%",publishedDate:o.media.metadata.publishedDate,publishedYear:o.media.metadata.publishedYear,publisher:o.media.metadata.publisher,series:o.media.metadata.series,subtitle:o.media.metadata.subtitle,tags:o.media.tags,title:o.media.metadata.title})),"podcast"==r&&a&&(_e("utils",a.media.metadata.title+" started "+c),l=(0,he.render)(e,{audiobookshelfUrl:`${t}/item/${a.id}`,author:a.media.metadata.author,description:a.media.metadata.description,duration:Ce(i.duration),currentTime:Ce(i.currentTime),isFinished:i.isFinished,explicit:a.media.metadata.explicit,genres:a.media.metadata.genres,startedDate:i.startedAt,startedDateParsed:c,finishedDate:i.finishedAt,finishedDateParsed:u,language:a.media.metadata.language,progress:(100*i.progress).toFixed(1==i.progress?0:2)+"%",releaseDate:a.media.metadata.releaseDate,tags:a.media.tags,title:a.media.metadata.title,index:s?.index,season:s?.season,episode:s?.episode,episodeType:s?.episodeType,episodeTitle:s?.title,episodeSubtitle:s?.subtitle,episodeDescription:s?.description,episdoePubDate:s?.pubDate,episodePublishedAt:s?.publishedAt,episodeAddedAt:s?.addedAt,episodeUpdatedAt:s?.updatedAt})),l}let Te=!1,Se="logseq-plugin-audiobookshelf-import";async function Ee(e,t,n){const r=await logseq.Editor.createPage(e,n,{createFirstBlock:!1,redirect:!1});await new Promise((e=>setTimeout(e,500)));const i=await logseq.Editor.getPageBlocksTree(r.name);if(null!==i&&0===i.length){await logseq.Editor.insertBlock(r.originalName,t[0].content,{before:!1,isPageBlock:!0,sibling:!1});return ke("Created page: "+e),!0}if(null!==i&&1===i.length){const n=i[0];return await logseq.Editor.updateBlock(n.uuid,n.content+"\n"+t[0].content),ke("Updated page: "+e),!0}return logseq.UI.showMsg(`Error creating "${e}", page not created`,"warning"),!1}async function Ae(e,t){const n=await logseq.Editor.getPageBlocksTree(e.originalName);if(await new Promise((e=>setTimeout(e,500))),0===n.length){await logseq.Editor.insertBlock(e.originalName,t[0].content,{before:!1,isPageBlock:!0})}else{if(!(n.length>0))return logseq.UI.showMsg(`Error updating "${e.originalName}", page not loaded`,"error"),!1;{const r=n[0],i=await logseq.Editor.getBlockProperty(r.uuid,"audiobookshelfupdateenabled");if(i||null===i){const n=await logseq.Editor.getBlock(r.uuid);n?.content!==t[0].content.trim()?(n&&_e("index",n.content.toString()),_e("index",t[0].content.toString()),await logseq.Editor.updateBlock(r.uuid,t[0].content),ke("Updated page: "+e.originalName)):_e("index","Blocks are identical")}else _e("index","Update block not met")}}return!0}const Oe=async(e=!1)=>{if(Te)return;const{serverUrl:t,serverToken:n,libraryNameList:r,importProgressFilters:i,singlePageModeEnabled:o,singlePageItemTemplate:a,multiPageItemTemplate:s,singlePagePodcastItemTemplate:l,createPages:c,updatePages:u,pageTitlePrefix:d,pageTitlePostfix:f,pageName:h,debug:p}=logseq.settings,g=(await logseq.App.getUserConfigs()).preferredDateFormat;if(!n||!t)return void await logseq.App.showMsg("Missing Audiobookshelf URL or api token","warning");const m="💫 Fetching books ...",v="Audiobookshelf Import";Te=!0;let y=null,b=null;try{if(!e&&ke(m),o){!e&&logseq.App.pushState("page",{name:h}),await((e=100)=>new Promise((t=>setTimeout(t,e))))(300);let t=await logseq.Editor.getPage(h);if(t||(t=await logseq.Editor.createPage(h)),!t)throw new Error("Failed to create page");const n=await logseq.Editor.getPageBlocksTree(h);if(y=n.length>0?n[0]:null,b=n.length>1?n[1]:null,y?await logseq.Editor.updateBlock(y.uuid,m):y=await logseq.Editor.appendBlockInPage(h,m),b?await logseq.Editor.updateBlock(b.uuid,v):b=await logseq.Editor.appendBlockInPage(h,v),!y)throw new Error("Audiobookshelf Single Page Mode import block error");if(!b)throw new Error("Audiobookshelf Single Page Mode state block error");await logseq.Editor.setBlockCollapsed(b.uuid,!0)}let p=[],w=[],_=[],C=[],k=await ge(t,n);for(let e of i)_e("fetchAudiobookshelf","Setting filter name "+e),w.push("progress"+"."+encodeURIComponent(btoa(e)));let x=[],T=[],S=r.replace(/^[,\s]+|[,\s]+$/g,"");S=r.replace(/\s*,\s*/g,",");let E=S.split(",").filter((e=>String(e).trim()));p=await be(t,n,E);for(let e of p){if("book"==e.mediaType)for(let r of w)for(let i=0,l=0,p=0;i<=p;i++){[_,l]=await ve(t,n,i,25,e.id,r),p=Math.ceil(l/25);for(const e of _){const n=await me(k,e.id),r=xe(a,t,g,"book",n,e),i=xe(s,t,g,"book",n,e);if(o&&b){0==(await logseq.DB.datascriptQuery(`[:find (pull ?b [*])\n                    :where\n                      [?b :block/page ?p]\n                      [?p :block/original-name "${h}"]\n                      [?b :block/parent ?parent]\n                      [?parent :block/uuid ?u]\n                      [(str ?u) ?s]\n                      [(= ?s "${b.uuid}")]\n                      [?b :block/content ?c]\n                      [(clojure.string/includes? ?c "${e.id}")]]`)).flat().length&&(x.unshift({content:r}),T.unshift({content:e.id+"."+e.media.metadata.title}))}const l=d+e.media.metadata.title+f,p=(0,he.render)(l,{mediaType:e.mediaType});if(1==c){const e=await logseq.Editor.getPage(p),t={content:i};if(null!==e&&u)_e("index","Updating page "+p),Ae(e,[t]);else{_e("index","Creating page "+p);await Ee(p,[t])?console.info("Creating "+p+" completed"):console.info("Error creating page "+p)}}}}if("podcast"==e.mediaType)for(let r=0,a=0,s=0;r<=s;r++){[C,a]=await ye(t,n,r,25,e.id),s=Math.ceil(a/25);for(const e of C){console.log(e);for(const n of e.media.episodes){const r=await me(k,e.media.libraryItemId,n.id);if(1==r.isFinished&&i.includes("finished")||0==r.isFinished&&r.progress>0&&i.includes("in-progress")){const i=xe(l,t,g,"podcast",r,void 0,e,n);if(_e("index",i),o&&b){0==(await logseq.DB.datascriptQuery(`[:find (pull ?b [*])\n                      :where\n                        [?b :block/page ?p]\n                        [?p :block/original-name "${h}"]\n                        [?b :block/parent ?parent]\n                        [?parent :block/uuid ?u]\n                        [(str ?u) ?s]\n                        [(= ?s "${b.uuid}")]\n                        [?b :block/content ?c]\n                        [(clojure.string/includes? ?c "${n.id}")]]`)).flat().length&&(x.unshift({content:i}),T.unshift({content:n.id+"."+e.media.metadata.title+"."+n.title}))}}}}}}o&&y&&b&&(T.length>0&&(await logseq.Editor.insertBatchBlock(b.uuid,T,{before:!0,sibling:!1}),await logseq.Editor.setBlockCollapsed(b.uuid,!0)),x.length>0&&await logseq.Editor.insertBatchBlock(y.uuid,x,{before:!0,sibling:!1}))}finally{Te=!1,y&&await logseq.Editor.updateBlock(y.uuid,"## 📚 Books"),ke("Audiobookshelf Import complete")}};logseq.ready((async e=>{logseq.useSettingsSchema(i),logseq.App.registerUIItem("toolbar",{key:Se,template:'<div data-on-click="loadAudiobookshelf" class="button">\n    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="26px" height="26px" viewBox="0 0 32 32" version="1.1">\n    <g id="surface1">\n    <path style=" fill-rule:evenodd;clip-rule=evenodd;fill:currentColor;" d="M 26.035156 14.871094 C 25.910156 14.765625 25.714844 14.613281 25.449219 14.429688 L 25.449219 12.378906 C 25.449219 7.148438 21.214844 2.910156 15.988281 2.910156 C 10.761719 2.910156 6.527344 7.148438 6.527344 12.378906 L 6.527344 14.429688 C 6.261719 14.613281 6.066406 14.765625 5.941406 14.871094 C 5.835938 14.957031 5.773438 15.089844 5.773438 15.230469 L 5.773438 17.6875 C 5.773438 17.828125 5.835938 17.960938 5.941406 18.050781 C 6.234375 18.296875 6.902344 18.804688 7.945312 19.328125 L 7.945312 19.566406 C 7.945312 20.210938 8.359375 20.730469 8.875 20.730469 C 9.386719 20.730469 9.800781 20.210938 9.800781 19.566406 L 9.800781 13.671875 C 9.800781 13.027344 9.386719 12.503906 8.875 12.503906 C 8.382812 12.503906 7.980469 12.984375 7.945312 13.589844 L 7.945312 12.375 C 7.945312 7.929688 11.542969 4.328125 15.984375 4.328125 C 20.429688 4.332031 24.027344 7.933594 24.027344 12.378906 L 24.027344 13.59375 C 23.992188 12.988281 23.59375 12.507812 23.101562 12.507812 C 22.589844 12.507812 22.175781 13.03125 22.175781 13.675781 L 22.175781 19.570312 C 22.175781 20.214844 22.589844 20.734375 23.101562 20.734375 C 23.613281 20.734375 24.027344 20.210938 24.027344 19.570312 L 24.027344 19.332031 C 25.070312 18.808594 25.742188 18.296875 26.03125 18.054688 C 26.140625 17.964844 26.203125 17.832031 26.203125 17.691406 L 26.203125 15.230469 C 26.203125 15.089844 26.140625 14.957031 26.035156 14.871094 Z M 26.035156 14.871094 "/>\n    <path style=" fill-rule:evenodd;clip-rule=evenodd;fill:currentColor;" d="M 12.6875 25.117188 C 13.308594 25.117188 13.808594 24.613281 13.808594 23.996094 L 13.808594 11.4375 C 13.808594 10.820312 13.308594 10.316406 12.6875 10.316406 L 11.53125 10.316406 C 10.914062 10.316406 10.410156 10.820312 10.410156 11.4375 L 10.410156 23.996094 C 10.410156 24.613281 10.914062 25.117188 11.53125 25.117188 Z M 10.832031 13.328125 L 13.386719 13.328125 L 13.386719 13.597656 L 10.832031 13.597656 Z M 10.832031 13.328125 "/>\n    <path style=" fill-rule:evenodd;clip-rule=evenodd;fill:currentColor;" d="M 16.566406 25.117188 C 17.183594 25.117188 17.6875 24.613281 17.6875 23.996094 L 17.6875 11.4375 C 17.6875 10.820312 17.183594 10.316406 16.566406 10.316406 L 15.410156 10.316406 C 14.789062 10.316406 14.289062 10.820312 14.289062 11.4375 L 14.289062 23.996094 C 14.289062 24.613281 14.789062 25.117188 15.410156 25.117188 Z M 14.710938 13.328125 L 17.265625 13.328125 L 17.265625 13.597656 L 14.710938 13.597656 Z M 14.710938 13.328125 "/>\n    <path style=" fill-rule:evenodd;clip-rule=evenodd;fill:currentColor;" d="M 20.445312 25.117188 C 21.0625 25.117188 21.566406 24.613281 21.566406 23.996094 L 21.566406 11.4375 C 21.566406 10.820312 21.0625 10.316406 20.445312 10.316406 L 19.289062 10.316406 C 18.667969 10.316406 18.167969 10.820312 18.167969 11.4375 L 18.167969 23.996094 C 18.167969 24.613281 18.667969 25.117188 19.289062 25.117188 Z M 18.589844 13.328125 L 21.144531 13.328125 L 21.144531 13.597656 L 18.589844 13.597656 Z M 18.589844 13.328125 "/>\n    <path style=" fill-rule:evenodd;clip-rule=evenodd;fill:currentColor;" d="M 8.476562 25.507812 L 23.5 25.507812 C 23.964844 25.507812 24.34375 25.882812 24.34375 26.351562 C 24.34375 26.816406 23.964844 27.195312 23.5 27.195312 L 8.476562 27.195312 C 8.007812 27.195312 7.632812 26.816406 7.632812 26.351562 C 7.632812 25.882812 8.007812 25.507812 8.476562 25.507812 Z M 8.476562 25.507812 "/>\n    </g>\n    </svg>\n    </div>'}),logseq.provideModel({async loadAudiobookshelf(){await Oe()}}),console.info(`#${Se}: loaded`)})).catch(console.error);